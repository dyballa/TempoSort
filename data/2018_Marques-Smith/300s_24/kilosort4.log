2025-05-26 10:01:34,904 kilosort.run_kilosort INFO     Kilosort version 4.0.25
2025-05-26 10:01:34,904 kilosort.run_kilosort INFO     Python version 3.9.21
2025-05-26 10:01:34,905 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-26 10:01:34,905 kilosort.run_kilosort INFO     System information:
2025-05-26 10:01:34,905 kilosort.run_kilosort INFO     Linux-4.18.0-477.74.1.el8_8.x86_64-x86_64-with-glibc2.28 x86_64
2025-05-26 10:01:34,905 kilosort.run_kilosort INFO     x86_64
2025-05-26 10:01:35,046 kilosort.run_kilosort INFO     Using GPU for PyTorch computations. Specify `device` to change this.
2025-05-26 10:01:35,087 kilosort.run_kilosort INFO     Using CUDA device: NVIDIA A100-PCIE-40GB 39.50GB
2025-05-26 10:01:35,087 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-26 10:01:35,088 kilosort.run_kilosort INFO     Sorting /home/lss72/palmer_scratch/spike_sort/c24/c24_npx_raw.bin
2025-05-26 10:01:35,088 kilosort.run_kilosort INFO     Interpreting binary file as default dtype='int16'. If data was saved in a different format, specify `data_dtype`.
2025-05-26 10:01:35,089 kilosort.run_kilosort DEBUG    Initial ops:

ops = {
    'n_chan_bin': 384,
    'fs': 30000,
    'batch_size': 60000,
    'nblocks': 1,
    'Th_universal': 9,
    'Th_learned': 8,
    'tmin': 0,
    'tmax': 300,
    'nt': 61,
    'shift': None,
    'scale': None,
    'artifact_threshold': inf,
    'nskip': 25,
    'whitening_range': 32,
    'highpass_cutoff': 300,
    'binning_depth': 5,
    'sig_interp': 20,
    'drift_smoothing': [0.5, 0.5, 0.5],
    'nt0min': 20,
    'dmin': None,
    'dminx': 32,
    'min_template_size': 10,
    'template_sizes': 5,
    'nearest_chans': 10,
    'nearest_templates': 100,
    'max_channel_distance': 32,
    'max_peels': 100,
    'templates_from_data': True,
    'n_templates': 6,
    'n_pcs': 6,
    'Th_single_ch': 6,
    'acg_threshold': 0.2,
    'ccg_threshold': 0.25,
    'cluster_downsampling': 20,
    'x_centers': None,
    'duplicate_spike_ms': 0.25,
    'position_limit': 100,
    'data_dir': PosixPath('/home/lss72/palmer_scratch/spike_sort/c24'),
    'probe_path': 'neuropixPhase3A_kilosortChanMap.mat',
    'filename': PosixPath('/home/lss72/palmer_scratch/spike_sort/c24/c24_npx_raw.bin'),
    'data_dtype': 'int16',
    'do_CAR': True,
    'invert_sign': False,
    'NTbuff': 60122,
    'Nchan': 374,
    'duplicate_spike_bins': 7,
    'torch_device': 'cuda',
    'save_preprocessed_copy': False
}

2025-05-26 10:01:35,099 kilosort.run_kilosort DEBUG    Probe dictionary:

probe = {
    'xc': np.array([43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11.,
       59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11.,
       59., 27., 43., 11., 59., 27., 43., 11., 59., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11.,
       59., 27., 43., 11., 59., 27., 11., 59., 27., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11.,
       59., 27., 43., 11., 59., 43., 11., 59., 27., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11.,
       59., 27., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11.,
       59., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 11., 59.,
       27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 43., 11., 59.,
       27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 11., 59., 27., 43., 11., 59.,
       27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 43., 11., 59., 27.], dtype=np.float32),
    'yc': np.array([  20.,   20.,   40.,   40.,   60.,   60.,   80.,   80.,  100.,
        100.,  120.,  120.,  140.,  140.,  160.,  160.,  180.,  180.,
        200.,  200.,  220.,  220.,  240.,  240.,  260.,  260.,  280.,
        280.,  300.,  300.,  320.,  320.,  340.,  340.,  360.,  360.,
        380.,  400.,  400.,  420.,  420.,  440.,  440.,  460.,  460.,
        480.,  480.,  500.,  500.,  520.,  520.,  540.,  540.,  560.,
        560.,  580.,  580.,  600.,  600.,  620.,  620.,  640.,  640.,
        660.,  660.,  680.,  680.,  700.,  700.,  720.,  720.,  740.,
        740.,  760.,  780.,  780.,  800.,  800.,  820.,  820.,  840.,
        840.,  860.,  860.,  880.,  880.,  900.,  900.,  920.,  920.,
        940.,  940.,  960.,  960.,  980.,  980., 1000., 1000., 1020.,
       1020., 1040., 1040., 1060., 1060., 1080., 1080., 1100., 1100.,
       1120., 1120., 1140., 1160., 1160., 1180., 1180., 1200., 1200.,
       1220., 1220., 1240., 1240., 1260., 1260., 1280., 1280., 1300.,
       1300., 1320., 1320., 1340., 1340., 1360., 1360., 1380., 1380.,
       1400., 1400., 1420., 1420., 1440., 1440., 1460., 1460., 1480.,
       1480., 1500., 1500., 1520., 1540., 1540., 1560., 1560., 1580.,
       1580., 1600., 1600., 1620., 1620., 1640., 1640., 1660., 1660.,
       1680., 1680., 1700., 1700., 1720., 1720., 1740., 1740., 1760.,
       1760., 1780., 1780., 1800., 1800., 1820., 1820., 1840., 1840.,
       1860., 1860., 1880., 1880., 1900., 1920., 1920., 1940., 1940.,
       1960., 1960., 1980., 1980., 2000., 2000., 2020., 2020., 2040.,
       2040., 2060., 2060., 2080., 2080., 2100., 2100., 2120., 2120.,
       2140., 2140., 2160., 2160., 2180., 2180., 2200., 2200., 2220.,
       2220., 2240., 2240., 2260., 2260., 2280., 2300., 2300., 2320.,
       2320., 2340., 2340., 2360., 2360., 2380., 2380., 2400., 2400.,
       2420., 2420., 2440., 2440., 2460., 2460., 2480., 2480., 2500.,
       2500., 2520., 2520., 2540., 2540., 2560., 2560., 2580., 2580.,
       2600., 2600., 2620., 2620., 2640., 2640., 2660., 2680., 2680.,
       2700., 2700., 2720., 2720., 2740., 2740., 2760., 2760., 2780.,
       2780., 2800., 2800., 2820., 2820., 2840., 2840., 2860., 2860.,
       2880., 2880., 2900., 2900., 2920., 2920., 2940., 2940., 2960.,
       2960., 2980., 2980., 3000., 3000., 3020., 3020., 3040., 3060.,
       3060., 3080., 3080., 3100., 3100., 3120., 3120., 3140., 3140.,
       3160., 3160., 3180., 3180., 3200., 3200., 3220., 3220., 3240.,
       3240., 3260., 3260., 3280., 3280., 3300., 3300., 3320., 3320.,
       3340., 3340., 3360., 3360., 3380., 3380., 3400., 3400., 3420.,
       3440., 3440., 3460., 3460., 3480., 3480., 3500., 3500., 3520.,
       3520., 3540., 3540., 3560., 3560., 3580., 3580., 3600., 3600.,
       3620., 3620., 3640., 3640., 3660., 3660., 3680., 3680., 3700.,
       3700., 3720., 3720., 3740., 3740., 3760., 3760., 3780., 3780.,
       3800., 3820., 3820., 3840., 3840.], dtype=np.float32),
    'kcoords': np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
      dtype=np.float32),
    'chanMap': np.array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,
        13,  14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,
        26,  27,  28,  29,  30,  31,  32,  33,  34,  35,  37,  38,  39,
        40,  41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,
        53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,  65,
        66,  67,  68,  69,  70,  71,  72,  73,  74,  76,  77,  78,  79,
        80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,  92,
        93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103, 104, 105,
       106, 107, 108, 109, 110, 111, 113, 114, 115, 116, 117, 118, 119,
       120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132,
       133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145,
       146, 147, 148, 149, 150, 152, 153, 154, 155, 156, 157, 158, 159,
       160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172,
       173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185,
       186, 187, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199,
       200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212,
       213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225,
       226, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239,
       240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252,
       253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 265, 266,
       267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279,
       280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292,
       293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 304, 305, 306,
       307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319,
       320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332,
       333, 334, 335, 336, 337, 338, 339, 341, 342, 343, 344, 345, 346,
       347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359,
       360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372,
       373, 374, 375, 376, 377, 378, 380, 381, 382, 383], dtype=np.int32),
    'n_chan': 384
}

2025-05-26 10:01:35,099 kilosort.run_kilosort INFO      
2025-05-26 10:01:35,100 kilosort.run_kilosort INFO     Computing preprocessing variables.
2025-05-26 10:01:35,100 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-26 10:01:35,371 kilosort.run_kilosort INFO     N samples: 9000000
2025-05-26 10:01:35,372 kilosort.run_kilosort INFO     N seconds: 300.0
2025-05-26 10:01:35,372 kilosort.run_kilosort INFO     N batches: 150
2025-05-26 10:01:36,648 kilosort.run_kilosort INFO     Preprocessing filters computed in  1.55s; total  1.56s
2025-05-26 10:01:36,649 kilosort.run_kilosort DEBUG    hp_filter shape: torch.Size([30122])
2025-05-26 10:01:36,649 kilosort.run_kilosort DEBUG    whiten_mat shape: torch.Size([374, 374])
2025-05-26 10:01:36,649 kilosort.run_kilosort INFO      
2025-05-26 10:01:36,649 kilosort.run_kilosort INFO     Resource usage after preprocessing
2025-05-26 10:01:36,650 kilosort.run_kilosort INFO     ********************************************************
2025-05-26 10:01:36,650 kilosort.run_kilosort INFO     CPU usage:     0.40 %
2025-05-26 10:01:36,651 kilosort.run_kilosort INFO     Memory:        2.90 %     |     21.86   /   754.60 GB
2025-05-26 10:01:36,651 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-26 10:01:36,652 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:01:36,652 kilosort.run_kilosort INFO     GPU memory:    5.38 %     |      2.12   /    39.50 GB
2025-05-26 10:01:36,653 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-26 10:01:36,653 kilosort.run_kilosort INFO     Max alloc:     3.23 %     |      1.28   /    39.50 GB
2025-05-26 10:01:36,653 kilosort.run_kilosort INFO     ********************************************************
2025-05-26 10:01:36,671 kilosort.run_kilosort INFO      
2025-05-26 10:01:36,671 kilosort.run_kilosort INFO     Computing drift correction.
2025-05-26 10:01:36,671 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-26 10:01:36,672 kilosort.spikedetect INFO     Re-computing universal templates from data.
2025-05-26 10:01:37,365 kilosort.spikedetect INFO     Number of universal templates: 1532
2025-05-26 10:01:37,488 kilosort.spikedetect INFO     Detecting spikes...
2025-05-26 10:01:37,490 kilosort.spikedetect DEBUG     
2025-05-26 10:01:37,490 kilosort.spikedetect DEBUG    Batch 0
2025-05-26 10:01:37,490 kilosort.spikedetect DEBUG    ********************************************************
2025-05-26 10:01:37,491 kilosort.spikedetect DEBUG    CPU usage:     7.10 %
2025-05-26 10:01:37,491 kilosort.spikedetect DEBUG    Memory:        2.92 %     |     22.02   /   754.60 GB
2025-05-26 10:01:37,491 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-26 10:01:37,491 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:01:37,491 kilosort.spikedetect DEBUG    GPU memory:    5.38 %     |      2.12   /    39.50 GB
2025-05-26 10:01:37,491 kilosort.spikedetect DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:01:37,491 kilosort.spikedetect DEBUG    Max alloc:     3.23 %     |      1.28   /    39.50 GB
2025-05-26 10:01:37,491 kilosort.spikedetect DEBUG    ********************************************************
2025-05-26 10:02:23,898 kilosort.spikedetect DEBUG     
2025-05-26 10:02:23,898 kilosort.spikedetect DEBUG    Batch 149
2025-05-26 10:02:23,898 kilosort.spikedetect DEBUG    ********************************************************
2025-05-26 10:02:23,898 kilosort.spikedetect DEBUG    CPU usage:     2.90 %
2025-05-26 10:02:23,898 kilosort.spikedetect DEBUG    Memory:        2.94 %     |     22.20   /   754.60 GB
2025-05-26 10:02:23,898 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-26 10:02:23,898 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:02:23,899 kilosort.spikedetect DEBUG    GPU memory:   14.31 %     |      5.65   /    39.50 GB
2025-05-26 10:02:23,899 kilosort.spikedetect DEBUG    Allocated:     0.24 %     |      0.10   /    39.50 GB
2025-05-26 10:02:23,899 kilosort.spikedetect DEBUG    Max alloc:     8.30 %     |      3.28   /    39.50 GB
2025-05-26 10:02:23,899 kilosort.spikedetect DEBUG    ********************************************************
2025-05-26 10:02:24,240 kilosort.run_kilosort INFO     drift computed in  47.57s; total  49.15s
2025-05-26 10:02:24,241 kilosort.run_kilosort DEBUG    st shape: (150850, 6)
2025-05-26 10:02:24,241 kilosort.run_kilosort DEBUG    yblk shape: (1,)
2025-05-26 10:02:24,241 kilosort.run_kilosort DEBUG    dshift shape: (150, 1)
2025-05-26 10:02:24,241 kilosort.run_kilosort DEBUG    iKxx shape: torch.Size([374, 374])
2025-05-26 10:02:24,245 kilosort.run_kilosort INFO      
2025-05-26 10:02:24,246 kilosort.run_kilosort INFO     Resource usage after drift correction
2025-05-26 10:02:24,246 kilosort.run_kilosort INFO     ********************************************************
2025-05-26 10:02:24,247 kilosort.run_kilosort INFO     CPU usage:     4.20 %
2025-05-26 10:02:24,247 kilosort.run_kilosort INFO     Memory:        2.94 %     |     22.19   /   754.60 GB
2025-05-26 10:02:24,247 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-26 10:02:24,248 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:02:24,248 kilosort.run_kilosort INFO     GPU memory:   14.31 %     |      5.65   /    39.50 GB
2025-05-26 10:02:24,249 kilosort.run_kilosort INFO     Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:02:24,249 kilosort.run_kilosort INFO     Max alloc:     8.30 %     |      3.28   /    39.50 GB
2025-05-26 10:02:24,250 kilosort.run_kilosort INFO     ********************************************************
2025-05-26 10:02:24,250 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  11150 KiB |   3358 MiB |  12961 GiB |  12961 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  11150 KiB |   3358 MiB |  12961 GiB |  12961 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  11149 KiB |   3357 MiB |  12958 GiB |  12958 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5222 MiB |   5222 MiB |   5222 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38001 KiB |   1749 MiB |   6263 GiB |   6263 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       9    |      37    |  110557    |  110548    |
|---------------------------------------------------------------------------|
| Active allocs         |       9    |      37    |  110557    |  110548    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      16    |      16    |      16    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      23    |   41245    |   41238    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-26 10:02:24,319 kilosort.run_kilosort DEBUG    First batch min, max: (-24.927671, 11.033756)
2025-05-26 10:02:24,319 kilosort.run_kilosort INFO      
2025-05-26 10:02:24,320 kilosort.run_kilosort INFO     Extracting spikes using templates
2025-05-26 10:02:24,320 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-26 10:02:24,320 kilosort.spikedetect INFO     Re-computing universal templates from data.
2025-05-26 10:02:24,690 kilosort.spikedetect INFO     Number of universal templates: 1532
2025-05-26 10:02:24,792 kilosort.spikedetect INFO     Detecting spikes...
2025-05-26 10:02:24,793 kilosort.spikedetect DEBUG     
2025-05-26 10:02:24,793 kilosort.spikedetect DEBUG    Batch 0
2025-05-26 10:02:24,793 kilosort.spikedetect DEBUG    ********************************************************
2025-05-26 10:02:24,794 kilosort.spikedetect DEBUG    CPU usage:     9.70 %
2025-05-26 10:02:24,794 kilosort.spikedetect DEBUG    Memory:        2.96 %     |     22.31   /   754.60 GB
2025-05-26 10:02:24,794 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-26 10:02:24,794 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:02:24,794 kilosort.spikedetect DEBUG    GPU memory:   14.31 %     |      5.65   /    39.50 GB
2025-05-26 10:02:24,794 kilosort.spikedetect DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:02:24,794 kilosort.spikedetect DEBUG    Max alloc:     8.30 %     |      3.28   /    39.50 GB
2025-05-26 10:02:24,794 kilosort.spikedetect DEBUG    ********************************************************
2025-05-26 10:03:07,476 kilosort.spikedetect DEBUG     
2025-05-26 10:03:07,476 kilosort.spikedetect DEBUG    Batch 149
2025-05-26 10:03:07,476 kilosort.spikedetect DEBUG    ********************************************************
2025-05-26 10:03:07,476 kilosort.spikedetect DEBUG    CPU usage:     2.80 %
2025-05-26 10:03:07,476 kilosort.spikedetect DEBUG    Memory:        2.96 %     |     22.36   /   754.60 GB
2025-05-26 10:03:07,476 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-26 10:03:07,476 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:07,477 kilosort.spikedetect DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:07,477 kilosort.spikedetect DEBUG    Allocated:     0.25 %     |      0.10   /    39.50 GB
2025-05-26 10:03:07,477 kilosort.spikedetect DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:07,477 kilosort.spikedetect DEBUG    ********************************************************
2025-05-26 10:03:07,477 kilosort.run_kilosort INFO     148096 spikes extracted in  43.16s; total  92.39s
2025-05-26 10:03:07,478 kilosort.run_kilosort DEBUG    st0 shape: (148096, 6)
2025-05-26 10:03:07,478 kilosort.run_kilosort DEBUG    tF shape: torch.Size([148096, 10, 6])
2025-05-26 10:03:07,478 kilosort.run_kilosort INFO      
2025-05-26 10:03:07,478 kilosort.run_kilosort INFO     First clustering
2025-05-26 10:03:07,478 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-26 10:03:07,506 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:07,506 kilosort.clustering_qr DEBUG    Cluster center: 0 of 96
2025-05-26 10:03:07,506 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:07,506 kilosort.clustering_qr DEBUG    CPU usage:    15.90 %
2025-05-26 10:03:07,506 kilosort.clustering_qr DEBUG    Memory:        2.96 %     |     22.33   /   754.60 GB
2025-05-26 10:03:07,506 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:07,506 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:07,506 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:07,506 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:07,507 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:07,507 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:07,564 kilosort.clustering_qr DEBUG    Center 0 | nsp: 184 | ntemp: 16
2025-05-26 10:03:07,567 kilosort.clustering_qr DEBUG    Center 1 | nsp: 1072 | ntemp: 16
2025-05-26 10:03:08,170 kilosort.clustering_qr DEBUG    Center 2 | nsp: 885 | ntemp: 16
2025-05-26 10:03:08,173 kilosort.clustering_qr DEBUG    Center 3 | nsp: 1049 | ntemp: 16
2025-05-26 10:03:08,428 kilosort.clustering_qr DEBUG    Center 4 | nsp: 2231 | ntemp: 16
2025-05-26 10:03:08,686 kilosort.clustering_qr DEBUG    Center 5 | nsp: 464 | ntemp: 16
2025-05-26 10:03:08,689 kilosort.clustering_qr DEBUG    Center 6 | nsp: 683 | ntemp: 16
2025-05-26 10:03:08,693 kilosort.clustering_qr DEBUG    Center 7 | nsp: 2749 | ntemp: 16
2025-05-26 10:03:09,043 kilosort.clustering_qr DEBUG    Center 8 | nsp: 466 | ntemp: 16
2025-05-26 10:03:09,046 kilosort.clustering_qr DEBUG    Center 9 | nsp: 756 | ntemp: 16
2025-05-26 10:03:09,046 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:09,046 kilosort.clustering_qr DEBUG    Cluster center: 10 of 96
2025-05-26 10:03:09,046 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:09,046 kilosort.clustering_qr DEBUG    CPU usage:    10.10 %
2025-05-26 10:03:09,047 kilosort.clustering_qr DEBUG    Memory:        2.99 %     |     22.55   /   754.60 GB
2025-05-26 10:03:09,047 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:09,047 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:09,047 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:09,047 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:09,047 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:09,047 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:09,050 kilosort.clustering_qr DEBUG    Center 10 | nsp: 2138 | ntemp: 16
2025-05-26 10:03:09,408 kilosort.clustering_qr DEBUG    Center 11 | nsp: 266 | ntemp: 16
2025-05-26 10:03:09,412 kilosort.clustering_qr DEBUG    Center 12 | nsp: 1899 | ntemp: 16
2025-05-26 10:03:09,770 kilosort.clustering_qr DEBUG    Center 13 | nsp: 1861 | ntemp: 16
2025-05-26 10:03:10,125 kilosort.clustering_qr DEBUG    Center 14 | nsp: 227 | ntemp: 16
2025-05-26 10:03:10,128 kilosort.clustering_qr DEBUG    Center 15 | nsp: 88 | ntemp: 16
2025-05-26 10:03:10,131 kilosort.clustering_qr DEBUG    Center 16 | nsp: 139 | ntemp: 16
2025-05-26 10:03:10,133 kilosort.clustering_qr DEBUG    Center 17 | nsp: 130 | ntemp: 16
2025-05-26 10:03:10,136 kilosort.clustering_qr DEBUG    Center 18 | nsp: 180 | ntemp: 16
2025-05-26 10:03:10,139 kilosort.clustering_qr DEBUG    Center 19 | nsp: 129 | ntemp: 16
2025-05-26 10:03:10,139 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:10,139 kilosort.clustering_qr DEBUG    Cluster center: 20 of 96
2025-05-26 10:03:10,139 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:10,140 kilosort.clustering_qr DEBUG    CPU usage:    11.20 %
2025-05-26 10:03:10,140 kilosort.clustering_qr DEBUG    Memory:        2.99 %     |     22.55   /   754.60 GB
2025-05-26 10:03:10,140 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:10,140 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:10,140 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:10,140 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:10,140 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:10,140 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:10,143 kilosort.clustering_qr DEBUG    Center 20 | nsp: 61 | ntemp: 16
2025-05-26 10:03:10,145 kilosort.clustering_qr DEBUG    Center 21 | nsp: 87 | ntemp: 16
2025-05-26 10:03:10,148 kilosort.clustering_qr DEBUG    Center 22 | nsp: 168 | ntemp: 16
2025-05-26 10:03:10,151 kilosort.clustering_qr DEBUG    Center 23 | nsp: 150 | ntemp: 16
2025-05-26 10:03:10,154 kilosort.clustering_qr DEBUG    Center 24 | nsp: 206 | ntemp: 16
2025-05-26 10:03:10,156 kilosort.clustering_qr DEBUG    Center 25 | nsp: 112 | ntemp: 16
2025-05-26 10:03:10,159 kilosort.clustering_qr DEBUG    Center 26 | nsp: 82 | ntemp: 16
2025-05-26 10:03:10,162 kilosort.clustering_qr DEBUG    Center 27 | nsp: 289 | ntemp: 16
2025-05-26 10:03:10,165 kilosort.clustering_qr DEBUG    Center 28 | nsp: 192 | ntemp: 16
2025-05-26 10:03:10,168 kilosort.clustering_qr DEBUG    Center 29 | nsp: 253 | ntemp: 16
2025-05-26 10:03:10,168 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:10,168 kilosort.clustering_qr DEBUG    Cluster center: 30 of 96
2025-05-26 10:03:10,168 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:10,168 kilosort.clustering_qr DEBUG    CPU usage:    27.90 %
2025-05-26 10:03:10,169 kilosort.clustering_qr DEBUG    Memory:        2.99 %     |     22.55   /   754.60 GB
2025-05-26 10:03:10,169 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:10,169 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:10,169 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:10,169 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:10,169 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:10,169 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:10,172 kilosort.clustering_qr DEBUG    Center 30 | nsp: 769 | ntemp: 16
2025-05-26 10:03:10,175 kilosort.clustering_qr DEBUG    Center 31 | nsp: 1398 | ntemp: 16
2025-05-26 10:03:10,532 kilosort.clustering_qr DEBUG    Center 32 | nsp: 4076 | ntemp: 16
2025-05-26 10:03:10,889 kilosort.clustering_qr DEBUG    Center 33 | nsp: 2390 | ntemp: 16
2025-05-26 10:03:11,243 kilosort.clustering_qr DEBUG    Center 34 | nsp: 1164 | ntemp: 16
2025-05-26 10:03:11,594 kilosort.clustering_qr DEBUG    Center 35 | nsp: 2131 | ntemp: 16
2025-05-26 10:03:11,844 kilosort.clustering_qr DEBUG    Center 36 | nsp: 1712 | ntemp: 16
2025-05-26 10:03:12,094 kilosort.clustering_qr DEBUG    Center 37 | nsp: 1701 | ntemp: 16
2025-05-26 10:03:12,454 kilosort.clustering_qr DEBUG    Center 38 | nsp: 4304 | ntemp: 16
2025-05-26 10:03:12,724 kilosort.clustering_qr DEBUG    Center 39 | nsp: 2061 | ntemp: 16
2025-05-26 10:03:13,078 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:13,078 kilosort.clustering_qr DEBUG    Cluster center: 40 of 96
2025-05-26 10:03:13,078 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:13,078 kilosort.clustering_qr DEBUG    CPU usage:     9.90 %
2025-05-26 10:03:13,079 kilosort.clustering_qr DEBUG    Memory:        2.99 %     |     22.55   /   754.60 GB
2025-05-26 10:03:13,079 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:13,079 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:13,079 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:13,079 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:13,079 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:13,079 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:13,082 kilosort.clustering_qr DEBUG    Center 40 | nsp: 1231 | ntemp: 16
2025-05-26 10:03:13,436 kilosort.clustering_qr DEBUG    Center 41 | nsp: 2999 | ntemp: 16
2025-05-26 10:03:13,698 kilosort.clustering_qr DEBUG    Center 42 | nsp: 1924 | ntemp: 16
2025-05-26 10:03:13,958 kilosort.clustering_qr DEBUG    Center 43 | nsp: 1555 | ntemp: 16
2025-05-26 10:03:14,308 kilosort.clustering_qr DEBUG    Center 44 | nsp: 2742 | ntemp: 16
2025-05-26 10:03:14,570 kilosort.clustering_qr DEBUG    Center 45 | nsp: 2730 | ntemp: 16
2025-05-26 10:03:14,925 kilosort.clustering_qr DEBUG    Center 46 | nsp: 3077 | ntemp: 16
2025-05-26 10:03:15,283 kilosort.clustering_qr DEBUG    Center 47 | nsp: 3105 | ntemp: 16
2025-05-26 10:03:15,638 kilosort.clustering_qr DEBUG    Center 48 | nsp: 2287 | ntemp: 16
2025-05-26 10:03:15,994 kilosort.clustering_qr DEBUG    Center 49 | nsp: 2666 | ntemp: 16
2025-05-26 10:03:16,355 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:16,355 kilosort.clustering_qr DEBUG    Cluster center: 50 of 96
2025-05-26 10:03:16,355 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:16,355 kilosort.clustering_qr DEBUG    CPU usage:    11.40 %
2025-05-26 10:03:16,356 kilosort.clustering_qr DEBUG    Memory:        2.99 %     |     22.55   /   754.60 GB
2025-05-26 10:03:16,356 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:16,356 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:16,356 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:16,356 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:16,356 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:16,356 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:16,360 kilosort.clustering_qr DEBUG    Center 50 | nsp: 4548 | ntemp: 16
2025-05-26 10:03:16,630 kilosort.clustering_qr DEBUG    Center 51 | nsp: 1669 | ntemp: 16
2025-05-26 10:03:16,983 kilosort.clustering_qr DEBUG    Center 52 | nsp: 3642 | ntemp: 16
2025-05-26 10:03:17,339 kilosort.clustering_qr DEBUG    Center 53 | nsp: 1805 | ntemp: 16
2025-05-26 10:03:17,601 kilosort.clustering_qr DEBUG    Center 54 | nsp: 4563 | ntemp: 16
2025-05-26 10:03:17,968 kilosort.clustering_qr DEBUG    Center 55 | nsp: 4922 | ntemp: 16
2025-05-26 10:03:18,244 kilosort.clustering_qr DEBUG    Center 56 | nsp: 4786 | ntemp: 16
2025-05-26 10:03:18,603 kilosort.clustering_qr DEBUG    Center 57 | nsp: 2674 | ntemp: 16
2025-05-26 10:03:18,968 kilosort.clustering_qr DEBUG    Center 58 | nsp: 3681 | ntemp: 16
2025-05-26 10:03:19,330 kilosort.clustering_qr DEBUG    Center 59 | nsp: 5576 | ntemp: 16
2025-05-26 10:03:19,698 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:19,698 kilosort.clustering_qr DEBUG    Cluster center: 60 of 96
2025-05-26 10:03:19,699 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:19,699 kilosort.clustering_qr DEBUG    CPU usage:    11.90 %
2025-05-26 10:03:19,699 kilosort.clustering_qr DEBUG    Memory:        2.99 %     |     22.55   /   754.60 GB
2025-05-26 10:03:19,699 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:19,699 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:19,699 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:19,699 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:19,699 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:19,699 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:19,703 kilosort.clustering_qr DEBUG    Center 60 | nsp: 5170 | ntemp: 16
2025-05-26 10:03:20,071 kilosort.clustering_qr DEBUG    Center 61 | nsp: 4288 | ntemp: 16
2025-05-26 10:03:20,444 kilosort.clustering_qr DEBUG    Center 62 | nsp: 2761 | ntemp: 16
2025-05-26 10:03:20,800 kilosort.clustering_qr DEBUG    Center 63 | nsp: 4661 | ntemp: 16
2025-05-26 10:03:21,162 kilosort.clustering_qr DEBUG    Center 64 | nsp: 2882 | ntemp: 16
2025-05-26 10:03:21,524 kilosort.clustering_qr DEBUG    Center 65 | nsp: 3484 | ntemp: 16
2025-05-26 10:03:21,788 kilosort.clustering_qr DEBUG    Center 66 | nsp: 2147 | ntemp: 16
2025-05-26 10:03:22,141 kilosort.clustering_qr DEBUG    Center 67 | nsp: 1357 | ntemp: 16
2025-05-26 10:03:22,404 kilosort.clustering_qr DEBUG    Center 68 | nsp: 1488 | ntemp: 16
2025-05-26 10:03:22,654 kilosort.clustering_qr DEBUG    Center 69 | nsp: 1668 | ntemp: 16
2025-05-26 10:03:22,999 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:22,999 kilosort.clustering_qr DEBUG    Cluster center: 70 of 96
2025-05-26 10:03:22,999 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:23,000 kilosort.clustering_qr DEBUG    CPU usage:    10.70 %
2025-05-26 10:03:23,000 kilosort.clustering_qr DEBUG    Memory:        2.99 %     |     22.55   /   754.60 GB
2025-05-26 10:03:23,000 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:23,000 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:23,000 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:23,000 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:23,000 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:23,000 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:23,017 kilosort.clustering_qr DEBUG    Center 70 | nsp: 984 | ntemp: 16
2025-05-26 10:03:23,020 kilosort.clustering_qr DEBUG    Center 71 | nsp: 1250 | ntemp: 16
2025-05-26 10:03:23,265 kilosort.clustering_qr DEBUG    Center 72 | nsp: 843 | ntemp: 16
2025-05-26 10:03:23,268 kilosort.clustering_qr DEBUG    Center 73 | nsp: 487 | ntemp: 16
2025-05-26 10:03:23,271 kilosort.clustering_qr DEBUG    Center 74 | nsp: 662 | ntemp: 16
2025-05-26 10:03:23,274 kilosort.clustering_qr DEBUG    Center 75 | nsp: 564 | ntemp: 16
2025-05-26 10:03:23,277 kilosort.clustering_qr DEBUG    Center 76 | nsp: 314 | ntemp: 16
2025-05-26 10:03:23,280 kilosort.clustering_qr DEBUG    Center 77 | nsp: 709 | ntemp: 16
2025-05-26 10:03:23,283 kilosort.clustering_qr DEBUG    Center 78 | nsp: 428 | ntemp: 16
2025-05-26 10:03:23,286 kilosort.clustering_qr DEBUG    Center 79 | nsp: 106 | ntemp: 16
2025-05-26 10:03:23,286 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:23,286 kilosort.clustering_qr DEBUG    Cluster center: 80 of 96
2025-05-26 10:03:23,286 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:23,286 kilosort.clustering_qr DEBUG    CPU usage:     6.90 %
2025-05-26 10:03:23,286 kilosort.clustering_qr DEBUG    Memory:        2.99 %     |     22.55   /   754.60 GB
2025-05-26 10:03:23,287 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:23,287 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:23,287 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:23,287 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:23,287 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:23,287 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:23,290 kilosort.clustering_qr DEBUG    Center 80 | nsp: 139 | ntemp: 16
2025-05-26 10:03:23,292 kilosort.clustering_qr DEBUG    Center 81 | nsp: 134 | ntemp: 16
2025-05-26 10:03:23,295 kilosort.clustering_qr DEBUG    Center 82 | nsp: 83 | ntemp: 16
2025-05-26 10:03:23,298 kilosort.clustering_qr DEBUG    Center 83 | nsp: 171 | ntemp: 16
2025-05-26 10:03:23,301 kilosort.clustering_qr DEBUG    Center 84 | nsp: 164 | ntemp: 16
2025-05-26 10:03:23,303 kilosort.clustering_qr DEBUG    Center 85 | nsp: 64 | ntemp: 16
2025-05-26 10:03:23,306 kilosort.clustering_qr DEBUG    Center 86 | nsp: 143 | ntemp: 16
2025-05-26 10:03:23,309 kilosort.clustering_qr DEBUG    Center 87 | nsp: 143 | ntemp: 16
2025-05-26 10:03:23,312 kilosort.clustering_qr DEBUG    Center 88 | nsp: 98 | ntemp: 16
2025-05-26 10:03:23,314 kilosort.clustering_qr DEBUG    Center 89 | nsp: 129 | ntemp: 16
2025-05-26 10:03:23,315 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:23,315 kilosort.clustering_qr DEBUG    Cluster center: 90 of 96
2025-05-26 10:03:23,315 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:23,315 kilosort.clustering_qr DEBUG    CPU usage:    27.50 %
2025-05-26 10:03:23,315 kilosort.clustering_qr DEBUG    Memory:        2.99 %     |     22.55   /   754.60 GB
2025-05-26 10:03:23,315 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:23,315 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:23,315 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:23,315 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:23,316 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:23,316 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:23,318 kilosort.clustering_qr DEBUG    Center 90 | nsp: 27 | ntemp: 16
2025-05-26 10:03:23,320 kilosort.clustering_qr DEBUG    Center 91 | nsp: 78 | ntemp: 16
2025-05-26 10:03:23,324 kilosort.clustering_qr DEBUG    Center 92 | nsp: 686 | ntemp: 16
2025-05-26 10:03:23,327 kilosort.clustering_qr DEBUG    Center 93 | nsp: 1582 | ntemp: 16
2025-05-26 10:03:23,574 kilosort.clustering_qr DEBUG    Center 94 | nsp: 3171 | ntemp: 16
2025-05-26 10:03:23,821 kilosort.clustering_qr DEBUG    Center 95 | nsp: 1947 | ntemp: 12
2025-05-26 10:03:24,220 kilosort.run_kilosort INFO     231 clusters found, in  16.74s; total  109.13s
2025-05-26 10:03:24,220 kilosort.run_kilosort DEBUG    clu shape: (148096,)
2025-05-26 10:03:24,221 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([231, 374, 6])
2025-05-26 10:03:24,221 kilosort.run_kilosort INFO      
2025-05-26 10:03:24,221 kilosort.run_kilosort INFO     Extracting spikes using cluster waveforms
2025-05-26 10:03:24,221 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-26 10:03:24,246 kilosort.template_matching DEBUG     
2025-05-26 10:03:24,246 kilosort.template_matching DEBUG    Batch 0
2025-05-26 10:03:24,246 kilosort.template_matching DEBUG    ********************************************************
2025-05-26 10:03:24,247 kilosort.template_matching DEBUG    CPU usage:     4.40 %
2025-05-26 10:03:24,247 kilosort.template_matching DEBUG    Memory:        3.02 %     |     22.78   /   754.60 GB
2025-05-26 10:03:24,247 kilosort.template_matching DEBUG    ------------------------------------------------------
2025-05-26 10:03:24,247 kilosort.template_matching DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:24,247 kilosort.template_matching DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:24,247 kilosort.template_matching DEBUG    Allocated:     0.09 %     |      0.04   /    39.50 GB
2025-05-26 10:03:24,247 kilosort.template_matching DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:24,247 kilosort.template_matching DEBUG    ********************************************************
2025-05-26 10:03:36,268 kilosort.template_matching DEBUG     
2025-05-26 10:03:36,269 kilosort.template_matching DEBUG    Batch 100
2025-05-26 10:03:36,269 kilosort.template_matching DEBUG    ********************************************************
2025-05-26 10:03:36,269 kilosort.template_matching DEBUG    CPU usage:     3.70 %
2025-05-26 10:03:36,269 kilosort.template_matching DEBUG    Memory:        3.02 %     |     22.79   /   754.60 GB
2025-05-26 10:03:36,269 kilosort.template_matching DEBUG    ------------------------------------------------------
2025-05-26 10:03:36,269 kilosort.template_matching DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:36,269 kilosort.template_matching DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:36,269 kilosort.template_matching DEBUG    Allocated:     0.52 %     |      0.20   /    39.50 GB
2025-05-26 10:03:36,269 kilosort.template_matching DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:36,269 kilosort.template_matching DEBUG    ********************************************************
2025-05-26 10:03:41,037 kilosort.template_matching DEBUG     
2025-05-26 10:03:41,037 kilosort.template_matching DEBUG    Batch 149
2025-05-26 10:03:41,037 kilosort.template_matching DEBUG    ********************************************************
2025-05-26 10:03:41,037 kilosort.template_matching DEBUG    CPU usage:     4.00 %
2025-05-26 10:03:41,037 kilosort.template_matching DEBUG    Memory:        3.02 %     |     22.79   /   754.60 GB
2025-05-26 10:03:41,038 kilosort.template_matching DEBUG    ------------------------------------------------------
2025-05-26 10:03:41,038 kilosort.template_matching DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:41,038 kilosort.template_matching DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:41,038 kilosort.template_matching DEBUG    Allocated:     0.52 %     |      0.20   /    39.50 GB
2025-05-26 10:03:41,038 kilosort.template_matching DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:41,038 kilosort.template_matching DEBUG    ********************************************************
2025-05-26 10:03:41,064 kilosort.run_kilosort INFO     389687 spikes extracted in  16.84s; total  125.98s
2025-05-26 10:03:41,066 kilosort.run_kilosort DEBUG    st shape: (389687, 3)
2025-05-26 10:03:41,066 kilosort.run_kilosort DEBUG    tF shape: torch.Size([389687, 10, 6])
2025-05-26 10:03:41,066 kilosort.run_kilosort DEBUG    iCC shape: torch.Size([10, 374])
2025-05-26 10:03:41,066 kilosort.run_kilosort DEBUG    iU shape: torch.Size([224])
2025-05-26 10:03:41,066 kilosort.run_kilosort INFO      
2025-05-26 10:03:41,066 kilosort.run_kilosort INFO     Resource usage after spike detection
2025-05-26 10:03:41,067 kilosort.run_kilosort INFO     ********************************************************
2025-05-26 10:03:41,067 kilosort.run_kilosort INFO     CPU usage:    12.10 %
2025-05-26 10:03:41,068 kilosort.run_kilosort INFO     Memory:        3.00 %     |     22.62   /   754.60 GB
2025-05-26 10:03:41,068 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-26 10:03:41,068 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:41,069 kilosort.run_kilosort INFO     GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:41,070 kilosort.run_kilosort INFO     Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:41,070 kilosort.run_kilosort INFO     Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:41,071 kilosort.run_kilosort INFO     ********************************************************
2025-05-26 10:03:41,072 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  13149 KiB |   3361 MiB |  28173 GiB |  28173 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  13149 KiB |   3361 MiB |  28173 GiB |  28173 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  13147 KiB |   3359 MiB |  28162 GiB |  28162 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5226 MiB |   5226 MiB |   5226 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  36002 KiB |   1749 MiB |  15184 GiB |  15184 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      13    |      45    |    1216 K  |    1216 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      13    |      45    |    1216 K  |    1216 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |      18    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      11    |      24    |  491935    |  491924    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-26 10:03:41,072 kilosort.run_kilosort INFO      
2025-05-26 10:03:41,072 kilosort.run_kilosort INFO     Final clustering
2025-05-26 10:03:41,073 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-26 10:03:41,084 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:41,084 kilosort.clustering_qr DEBUG    Cluster center: 0 of 96
2025-05-26 10:03:41,084 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:41,084 kilosort.clustering_qr DEBUG    CPU usage:     8.50 %
2025-05-26 10:03:41,084 kilosort.clustering_qr DEBUG    Memory:        3.00 %     |     22.61   /   754.60 GB
2025-05-26 10:03:41,084 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:41,084 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:41,084 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:41,084 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:41,085 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:41,085 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:41,086 kilosort.clustering_qr DEBUG    Center 0 | nsp: 1126 | ntemp: 1
2025-05-26 10:03:43,799 kilosort.clustering_qr DEBUG    Center 1 | nsp: 1639 | ntemp: 1
2025-05-26 10:03:44,051 kilosort.clustering_qr DEBUG    Center 2 | nsp: 1120 | ntemp: 1
2025-05-26 10:03:44,298 kilosort.clustering_qr DEBUG    Center 3 | nsp: 2247 | ntemp: 2
2025-05-26 10:03:44,549 kilosort.clustering_qr DEBUG    Center 4 | nsp: 15855 | ntemp: 5
2025-05-26 10:03:44,865 kilosort.clustering_qr DEBUG    Center 5 | nsp: 225 | ntemp: 1
2025-05-26 10:03:44,866 kilosort.clustering_qr DEBUG    Center 6 | nsp: 2189 | ntemp: 1
2025-05-26 10:03:45,112 kilosort.clustering_qr DEBUG    Center 7 | nsp: 4109 | ntemp: 2
2025-05-26 10:03:45,360 kilosort.clustering_qr DEBUG    Center 8 | nsp: 0 | ntemp: 0
2025-05-26 10:03:45,362 kilosort.clustering_qr DEBUG    Center 9 | nsp: 1905 | ntemp: 1
2025-05-26 10:03:45,605 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:45,605 kilosort.clustering_qr DEBUG    Cluster center: 10 of 96
2025-05-26 10:03:45,605 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:45,605 kilosort.clustering_qr DEBUG    CPU usage:     3.30 %
2025-05-26 10:03:45,605 kilosort.clustering_qr DEBUG    Memory:        3.00 %     |     22.65   /   754.60 GB
2025-05-26 10:03:45,605 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:45,606 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:45,606 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:45,606 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:45,606 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:45,606 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:45,607 kilosort.clustering_qr DEBUG    Center 10 | nsp: 2919 | ntemp: 1
2025-05-26 10:03:45,853 kilosort.clustering_qr DEBUG    Center 11 | nsp: 489 | ntemp: 1
2025-05-26 10:03:45,855 kilosort.clustering_qr DEBUG    Center 12 | nsp: 4615 | ntemp: 2
2025-05-26 10:03:46,109 kilosort.clustering_qr DEBUG    Center 13 | nsp: 2023 | ntemp: 2
2025-05-26 10:03:46,352 kilosort.clustering_qr DEBUG    Center 14 | nsp: 0 | ntemp: 0
2025-05-26 10:03:46,352 kilosort.clustering_qr DEBUG    Center 15 | nsp: 418 | ntemp: 1
2025-05-26 10:03:46,353 kilosort.clustering_qr DEBUG    Center 16 | nsp: 0 | ntemp: 0
2025-05-26 10:03:46,354 kilosort.clustering_qr DEBUG    Center 17 | nsp: 5239 | ntemp: 1
2025-05-26 10:03:46,609 kilosort.clustering_qr DEBUG    Center 18 | nsp: 4267 | ntemp: 2
2025-05-26 10:03:46,861 kilosort.clustering_qr DEBUG    Center 19 | nsp: 6422 | ntemp: 1
2025-05-26 10:03:47,116 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:47,116 kilosort.clustering_qr DEBUG    Cluster center: 20 of 96
2025-05-26 10:03:47,116 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:47,116 kilosort.clustering_qr DEBUG    CPU usage:     3.80 %
2025-05-26 10:03:47,116 kilosort.clustering_qr DEBUG    Memory:        3.00 %     |     22.65   /   754.60 GB
2025-05-26 10:03:47,116 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:47,116 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:47,116 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:47,117 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:47,117 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:47,117 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:47,117 kilosort.clustering_qr DEBUG    Center 20 | nsp: 0 | ntemp: 0
2025-05-26 10:03:47,118 kilosort.clustering_qr DEBUG    Center 21 | nsp: 1620 | ntemp: 2
2025-05-26 10:03:47,361 kilosort.clustering_qr DEBUG    Center 22 | nsp: 4266 | ntemp: 1
2025-05-26 10:03:47,610 kilosort.clustering_qr DEBUG    Center 23 | nsp: 0 | ntemp: 0
2025-05-26 10:03:47,611 kilosort.clustering_qr DEBUG    Center 24 | nsp: 887 | ntemp: 2
2025-05-26 10:03:47,612 kilosort.clustering_qr DEBUG    Center 25 | nsp: 3382 | ntemp: 1
2025-05-26 10:03:47,858 kilosort.clustering_qr DEBUG    Center 26 | nsp: 7 | ntemp: 1
2025-05-26 10:03:47,859 kilosort.clustering_qr DEBUG    Center 27 | nsp: 421 | ntemp: 1
2025-05-26 10:03:47,861 kilosort.clustering_qr DEBUG    Center 28 | nsp: 2253 | ntemp: 1
2025-05-26 10:03:48,106 kilosort.clustering_qr DEBUG    Center 29 | nsp: 0 | ntemp: 0
2025-05-26 10:03:48,106 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:48,106 kilosort.clustering_qr DEBUG    Cluster center: 30 of 96
2025-05-26 10:03:48,106 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:48,106 kilosort.clustering_qr DEBUG    CPU usage:     3.80 %
2025-05-26 10:03:48,106 kilosort.clustering_qr DEBUG    Memory:        3.00 %     |     22.65   /   754.60 GB
2025-05-26 10:03:48,106 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:48,106 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:48,106 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:48,106 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:48,107 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:48,107 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:48,107 kilosort.clustering_qr DEBUG    Center 30 | nsp: 29 | ntemp: 1
2025-05-26 10:03:48,110 kilosort.clustering_qr DEBUG    Center 31 | nsp: 3943 | ntemp: 5
2025-05-26 10:03:48,466 kilosort.clustering_qr DEBUG    Center 32 | nsp: 4446 | ntemp: 3
2025-05-26 10:03:48,835 kilosort.clustering_qr DEBUG    Center 33 | nsp: 4276 | ntemp: 3
2025-05-26 10:03:49,193 kilosort.clustering_qr DEBUG    Center 34 | nsp: 3517 | ntemp: 3
2025-05-26 10:03:49,443 kilosort.clustering_qr DEBUG    Center 35 | nsp: 1624 | ntemp: 1
2025-05-26 10:03:49,691 kilosort.clustering_qr DEBUG    Center 36 | nsp: 6747 | ntemp: 3
2025-05-26 10:03:50,056 kilosort.clustering_qr DEBUG    Center 37 | nsp: 2904 | ntemp: 3
2025-05-26 10:03:50,304 kilosort.clustering_qr DEBUG    Center 38 | nsp: 7057 | ntemp: 5
2025-05-26 10:03:50,567 kilosort.clustering_qr DEBUG    Center 39 | nsp: 3125 | ntemp: 4
2025-05-26 10:03:50,815 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:50,815 kilosort.clustering_qr DEBUG    Cluster center: 40 of 96
2025-05-26 10:03:50,815 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:50,816 kilosort.clustering_qr DEBUG    CPU usage:     7.40 %
2025-05-26 10:03:50,816 kilosort.clustering_qr DEBUG    Memory:        3.00 %     |     22.65   /   754.60 GB
2025-05-26 10:03:50,816 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:50,816 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:50,816 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:50,816 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:50,816 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:50,816 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:50,818 kilosort.clustering_qr DEBUG    Center 40 | nsp: 2786 | ntemp: 3
2025-05-26 10:03:51,173 kilosort.clustering_qr DEBUG    Center 41 | nsp: 5789 | ntemp: 4
2025-05-26 10:03:51,535 kilosort.clustering_qr DEBUG    Center 42 | nsp: 4790 | ntemp: 4
2025-05-26 10:03:51,914 kilosort.clustering_qr DEBUG    Center 43 | nsp: 3545 | ntemp: 3
2025-05-26 10:03:52,266 kilosort.clustering_qr DEBUG    Center 44 | nsp: 5539 | ntemp: 6
2025-05-26 10:03:52,622 kilosort.clustering_qr DEBUG    Center 45 | nsp: 5804 | ntemp: 4
2025-05-26 10:03:52,979 kilosort.clustering_qr DEBUG    Center 46 | nsp: 6224 | ntemp: 5
2025-05-26 10:03:53,345 kilosort.clustering_qr DEBUG    Center 47 | nsp: 4400 | ntemp: 4
2025-05-26 10:03:53,595 kilosort.clustering_qr DEBUG    Center 48 | nsp: 8544 | ntemp: 4
2025-05-26 10:03:53,967 kilosort.clustering_qr DEBUG    Center 49 | nsp: 3938 | ntemp: 2
2025-05-26 10:03:54,259 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:54,260 kilosort.clustering_qr DEBUG    Cluster center: 50 of 96
2025-05-26 10:03:54,260 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:54,260 kilosort.clustering_qr DEBUG    CPU usage:    10.00 %
2025-05-26 10:03:54,260 kilosort.clustering_qr DEBUG    Memory:        3.00 %     |     22.65   /   754.60 GB
2025-05-26 10:03:54,260 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:54,260 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:54,260 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:54,260 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:54,260 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:54,260 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:54,320 kilosort.clustering_qr DEBUG    Center 50 | nsp: 8674 | ntemp: 5
2025-05-26 10:03:54,691 kilosort.clustering_qr DEBUG    Center 51 | nsp: 4385 | ntemp: 4
2025-05-26 10:03:55,053 kilosort.clustering_qr DEBUG    Center 52 | nsp: 5995 | ntemp: 4
2025-05-26 10:03:55,309 kilosort.clustering_qr DEBUG    Center 53 | nsp: 5745 | ntemp: 5
2025-05-26 10:03:55,665 kilosort.clustering_qr DEBUG    Center 54 | nsp: 4933 | ntemp: 3
2025-05-26 10:03:56,037 kilosort.clustering_qr DEBUG    Center 55 | nsp: 14912 | ntemp: 8
2025-05-26 10:03:56,363 kilosort.clustering_qr DEBUG    Center 56 | nsp: 10477 | ntemp: 5
2025-05-26 10:03:56,750 kilosort.clustering_qr DEBUG    Center 57 | nsp: 9858 | ntemp: 6
2025-05-26 10:03:57,136 kilosort.clustering_qr DEBUG    Center 58 | nsp: 4562 | ntemp: 3
2025-05-26 10:03:57,390 kilosort.clustering_qr DEBUG    Center 59 | nsp: 16992 | ntemp: 8
2025-05-26 10:03:57,789 kilosort.clustering_qr DEBUG     
2025-05-26 10:03:57,789 kilosort.clustering_qr DEBUG    Cluster center: 60 of 96
2025-05-26 10:03:57,789 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:57,789 kilosort.clustering_qr DEBUG    CPU usage:    10.40 %
2025-05-26 10:03:57,789 kilosort.clustering_qr DEBUG    Memory:        3.00 %     |     22.66   /   754.60 GB
2025-05-26 10:03:57,789 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:03:57,789 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:03:57,790 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:03:57,790 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:03:57,790 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:03:57,790 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:03:57,793 kilosort.clustering_qr DEBUG    Center 60 | nsp: 10310 | ntemp: 5
2025-05-26 10:03:58,171 kilosort.clustering_qr DEBUG    Center 61 | nsp: 9712 | ntemp: 4
2025-05-26 10:03:58,542 kilosort.clustering_qr DEBUG    Center 62 | nsp: 12231 | ntemp: 4
2025-05-26 10:03:58,921 kilosort.clustering_qr DEBUG    Center 63 | nsp: 13079 | ntemp: 4
2025-05-26 10:03:59,315 kilosort.clustering_qr DEBUG    Center 64 | nsp: 13833 | ntemp: 4
2025-05-26 10:03:59,612 kilosort.clustering_qr DEBUG    Center 65 | nsp: 11579 | ntemp: 4
2025-05-26 10:04:00,065 kilosort.clustering_qr DEBUG    Center 66 | nsp: 8185 | ntemp: 4
2025-05-26 10:04:00,438 kilosort.clustering_qr DEBUG    Center 67 | nsp: 6863 | ntemp: 5
2025-05-26 10:04:00,808 kilosort.clustering_qr DEBUG    Center 68 | nsp: 6059 | ntemp: 2
2025-05-26 10:04:01,069 kilosort.clustering_qr DEBUG    Center 69 | nsp: 5252 | ntemp: 2
2025-05-26 10:04:01,374 kilosort.clustering_qr DEBUG     
2025-05-26 10:04:01,374 kilosort.clustering_qr DEBUG    Cluster center: 70 of 96
2025-05-26 10:04:01,374 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:04:01,374 kilosort.clustering_qr DEBUG    CPU usage:    10.20 %
2025-05-26 10:04:01,374 kilosort.clustering_qr DEBUG    Memory:        3.00 %     |     22.66   /   754.60 GB
2025-05-26 10:04:01,374 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:04:01,374 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:04:01,374 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:04:01,374 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:04:01,375 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:04:01,375 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:04:01,433 kilosort.clustering_qr DEBUG    Center 70 | nsp: 2231 | ntemp: 1
2025-05-26 10:04:01,681 kilosort.clustering_qr DEBUG    Center 71 | nsp: 7143 | ntemp: 2
2025-05-26 10:04:02,047 kilosort.clustering_qr DEBUG    Center 72 | nsp: 268 | ntemp: 1
2025-05-26 10:04:02,049 kilosort.clustering_qr DEBUG    Center 73 | nsp: 1142 | ntemp: 1
2025-05-26 10:04:02,386 kilosort.clustering_qr DEBUG    Center 74 | nsp: 775 | ntemp: 1
2025-05-26 10:04:02,400 kilosort.clustering_qr DEBUG    Center 75 | nsp: 1300 | ntemp: 1
2025-05-26 10:04:02,642 kilosort.clustering_qr DEBUG    Center 76 | nsp: 564 | ntemp: 1
2025-05-26 10:04:02,644 kilosort.clustering_qr DEBUG    Center 77 | nsp: 2968 | ntemp: 1
2025-05-26 10:04:02,889 kilosort.clustering_qr DEBUG    Center 78 | nsp: 1798 | ntemp: 1
2025-05-26 10:04:03,131 kilosort.clustering_qr DEBUG    Center 79 | nsp: 0 | ntemp: 0
2025-05-26 10:04:03,132 kilosort.clustering_qr DEBUG     
2025-05-26 10:04:03,132 kilosort.clustering_qr DEBUG    Cluster center: 80 of 96
2025-05-26 10:04:03,132 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:04:03,132 kilosort.clustering_qr DEBUG    CPU usage:     7.30 %
2025-05-26 10:04:03,132 kilosort.clustering_qr DEBUG    Memory:        3.00 %     |     22.66   /   754.60 GB
2025-05-26 10:04:03,132 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:04:03,132 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:04:03,132 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:04:03,132 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:04:03,132 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:04:03,132 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:04:03,134 kilosort.clustering_qr DEBUG    Center 80 | nsp: 1258 | ntemp: 2
2025-05-26 10:04:03,374 kilosort.clustering_qr DEBUG    Center 81 | nsp: 724 | ntemp: 1
2025-05-26 10:04:03,375 kilosort.clustering_qr DEBUG    Center 82 | nsp: 336 | ntemp: 1
2025-05-26 10:04:03,376 kilosort.clustering_qr DEBUG    Center 83 | nsp: 884 | ntemp: 1
2025-05-26 10:04:03,378 kilosort.clustering_qr DEBUG    Center 84 | nsp: 1384 | ntemp: 1
2025-05-26 10:04:03,618 kilosort.clustering_qr DEBUG    Center 85 | nsp: 0 | ntemp: 0
2025-05-26 10:04:03,620 kilosort.clustering_qr DEBUG    Center 86 | nsp: 983 | ntemp: 2
2025-05-26 10:04:03,621 kilosort.clustering_qr DEBUG    Center 87 | nsp: 1194 | ntemp: 2
2025-05-26 10:04:03,861 kilosort.clustering_qr DEBUG    Center 88 | nsp: 0 | ntemp: 0
2025-05-26 10:04:03,862 kilosort.clustering_qr DEBUG    Center 89 | nsp: 1417 | ntemp: 1
2025-05-26 10:04:04,103 kilosort.clustering_qr DEBUG     
2025-05-26 10:04:04,103 kilosort.clustering_qr DEBUG    Cluster center: 90 of 96
2025-05-26 10:04:04,103 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:04:04,103 kilosort.clustering_qr DEBUG    CPU usage:     3.70 %
2025-05-26 10:04:04,103 kilosort.clustering_qr DEBUG    Memory:        3.00 %     |     22.66   /   754.60 GB
2025-05-26 10:04:04,103 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-26 10:04:04,104 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:04:04,104 kilosort.clustering_qr DEBUG    GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:04:04,104 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:04:04,104 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:04:04,104 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-26 10:04:04,105 kilosort.clustering_qr DEBUG    Center 90 | nsp: 103 | ntemp: 1
2025-05-26 10:04:04,106 kilosort.clustering_qr DEBUG    Center 91 | nsp: 295 | ntemp: 1
2025-05-26 10:04:04,106 kilosort.clustering_qr DEBUG    Center 92 | nsp: 0 | ntemp: 0
2025-05-26 10:04:04,108 kilosort.clustering_qr DEBUG    Center 93 | nsp: 5995 | ntemp: 3
2025-05-26 10:04:04,363 kilosort.clustering_qr DEBUG    Center 94 | nsp: 7721 | ntemp: 2
2025-05-26 10:04:04,621 kilosort.clustering_qr DEBUG    Center 95 | nsp: 6898 | ntemp: 2
2025-05-26 10:04:04,877 kilosort.run_kilosort INFO     218 clusters found, in  23.80s; total  149.79s
2025-05-26 10:04:04,877 kilosort.run_kilosort DEBUG    clu shape: (389687,)
2025-05-26 10:04:04,878 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([218, 374, 6])
2025-05-26 10:04:04,878 kilosort.run_kilosort INFO      
2025-05-26 10:04:04,878 kilosort.run_kilosort INFO     Merging clusters
2025-05-26 10:04:04,878 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-26 10:04:05,169 kilosort.run_kilosort INFO     200 units found, in  0.29s; total  150.08s
2025-05-26 10:04:05,170 kilosort.run_kilosort DEBUG    clu shape: (389687,)
2025-05-26 10:04:05,170 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([200, 374, 6])
2025-05-26 10:04:05,510 kilosort.run_kilosort INFO      
2025-05-26 10:04:05,510 kilosort.run_kilosort INFO     Resource usage after clustering
2025-05-26 10:04:05,511 kilosort.run_kilosort INFO     ********************************************************
2025-05-26 10:04:05,511 kilosort.run_kilosort INFO     CPU usage:     3.60 %
2025-05-26 10:04:05,512 kilosort.run_kilosort INFO     Memory:        3.00 %     |     22.65   /   754.60 GB
2025-05-26 10:04:05,512 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-26 10:04:05,513 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:04:05,513 kilosort.run_kilosort INFO     GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:04:05,514 kilosort.run_kilosort INFO     Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:04:05,514 kilosort.run_kilosort INFO     Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:04:05,514 kilosort.run_kilosort INFO     ********************************************************
2025-05-26 10:04:05,515 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  11186 KiB |   3361 MiB |  28612 GiB |  28612 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  11186 KiB |   3361 MiB |  28612 GiB |  28612 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  11183 KiB |   3359 MiB |  28600 GiB |  28600 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5226 MiB |   5226 MiB |   5226 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37966 KiB |   1749 MiB |  15705 GiB |  15705 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      12    |      45    |    2097 K  |    2097 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      12    |      45    |    2097 K  |    2097 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |      18    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      24    |     884 K  |     884 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-26 10:04:05,515 kilosort.run_kilosort INFO      
2025-05-26 10:04:05,516 kilosort.run_kilosort INFO     Saving to phy and computing refractory periods
2025-05-26 10:04:05,516 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-26 10:04:07,268 kilosort.run_kilosort INFO     65 units found with good refractory periods
2025-05-26 10:04:07,269 kilosort.run_kilosort INFO     Total runtime: 152.18s = 00:02:32 h:m:s
2025-05-26 10:04:07,282 kilosort.run_kilosort INFO     Sorting output saved in: /home/lss72/palmer_scratch/spike_sort/c24/kilosort4.
2025-05-26 10:04:07,282 kilosort.run_kilosort INFO      
2025-05-26 10:04:07,283 kilosort.run_kilosort INFO     Resource usage after saving
2025-05-26 10:04:07,283 kilosort.run_kilosort INFO     ********************************************************
2025-05-26 10:04:07,284 kilosort.run_kilosort INFO     CPU usage:     9.40 %
2025-05-26 10:04:07,284 kilosort.run_kilosort INFO     Memory:        3.01 %     |     22.70   /   754.60 GB
2025-05-26 10:04:07,284 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-26 10:04:07,285 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-26 10:04:07,285 kilosort.run_kilosort INFO     GPU memory:   14.32 %     |      5.66   /    39.50 GB
2025-05-26 10:04:07,286 kilosort.run_kilosort INFO     Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-26 10:04:07,286 kilosort.run_kilosort INFO     Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-26 10:04:07,287 kilosort.run_kilosort INFO     ********************************************************
2025-05-26 10:04:07,287 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  11186 KiB |   3361 MiB |  28612 GiB |  28612 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  11186 KiB |   3361 MiB |  28612 GiB |  28612 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  11183 KiB |   3359 MiB |  28600 GiB |  28600 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5226 MiB |   5226 MiB |   5226 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37966 KiB |   1749 MiB |  15705 GiB |  15705 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      12    |      45    |    2100 K  |    2100 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      12    |      45    |    2100 K  |    2100 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |      18    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      24    |     885 K  |     885 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


