2025-05-15 05:35:22,776 kilosort.run_kilosort INFO     Kilosort version 4.0.25
2025-05-15 05:35:22,777 kilosort.run_kilosort INFO     Python version 3.9.21
2025-05-15 05:35:22,777 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-15 05:35:22,777 kilosort.run_kilosort INFO     System information:
2025-05-15 05:35:22,778 kilosort.run_kilosort INFO     Linux-4.18.0-477.74.1.el8_8.x86_64-x86_64-with-glibc2.28 x86_64
2025-05-15 05:35:22,778 kilosort.run_kilosort INFO     x86_64
2025-05-15 05:35:22,833 kilosort.run_kilosort INFO     Using GPU for PyTorch computations. Specify `device` to change this.
2025-05-15 05:35:22,868 kilosort.run_kilosort INFO     Using CUDA device: NVIDIA A100-PCIE-40GB 39.50GB
2025-05-15 05:35:22,868 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-15 05:35:22,869 kilosort.run_kilosort INFO     Sorting /home/lss72/palmer_scratch/spike_sort/c42/c42_npx_raw.bin
2025-05-15 05:35:22,869 kilosort.run_kilosort INFO     Interpreting binary file as default dtype='int16'. If data was saved in a different format, specify `data_dtype`.
2025-05-15 05:35:22,870 kilosort.run_kilosort DEBUG    Initial ops:

ops = {
    'n_chan_bin': 384,
    'fs': 30000,
    'batch_size': 60000,
    'nblocks': 1,
    'Th_universal': 9,
    'Th_learned': 8,
    'tmin': 0,
    'tmax': 300,
    'nt': 61,
    'shift': None,
    'scale': None,
    'artifact_threshold': inf,
    'nskip': 25,
    'whitening_range': 32,
    'highpass_cutoff': 300,
    'binning_depth': 5,
    'sig_interp': 20,
    'drift_smoothing': [0.5, 0.5, 0.5],
    'nt0min': 20,
    'dmin': None,
    'dminx': 32,
    'min_template_size': 10,
    'template_sizes': 5,
    'nearest_chans': 10,
    'nearest_templates': 100,
    'max_channel_distance': 32,
    'max_peels': 100,
    'templates_from_data': True,
    'n_templates': 6,
    'n_pcs': 6,
    'Th_single_ch': 6,
    'acg_threshold': 0.2,
    'ccg_threshold': 0.25,
    'cluster_downsampling': 20,
    'x_centers': None,
    'duplicate_spike_ms': 0.25,
    'position_limit': 100,
    'data_dir': PosixPath('/home/lss72/palmer_scratch/spike_sort/c42'),
    'probe_path': 'neuropixPhase3A_kilosortChanMap.mat',
    'filename': PosixPath('/home/lss72/palmer_scratch/spike_sort/c42/c42_npx_raw.bin'),
    'data_dtype': 'int16',
    'do_CAR': True,
    'invert_sign': False,
    'NTbuff': 60122,
    'Nchan': 374,
    'duplicate_spike_bins': 7,
    'torch_device': 'cuda',
    'save_preprocessed_copy': False
}

2025-05-15 05:35:22,880 kilosort.run_kilosort DEBUG    Probe dictionary:

probe = {
    'xc': np.array([43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11.,
       59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11.,
       59., 27., 43., 11., 59., 27., 43., 11., 59., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11.,
       59., 27., 43., 11., 59., 27., 11., 59., 27., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11.,
       59., 27., 43., 11., 59., 43., 11., 59., 27., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11.,
       59., 27., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11.,
       59., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 11., 59.,
       27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 43., 11., 59.,
       27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 27., 11., 59., 27., 43., 11., 59.,
       27., 43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27.,
       43., 11., 59., 27., 43., 11., 59., 27., 43., 11., 59., 27., 43.,
       11., 59., 27., 43., 11., 59., 43., 11., 59., 27.], dtype=np.float32),
    'yc': np.array([  20.,   20.,   40.,   40.,   60.,   60.,   80.,   80.,  100.,
        100.,  120.,  120.,  140.,  140.,  160.,  160.,  180.,  180.,
        200.,  200.,  220.,  220.,  240.,  240.,  260.,  260.,  280.,
        280.,  300.,  300.,  320.,  320.,  340.,  340.,  360.,  360.,
        380.,  400.,  400.,  420.,  420.,  440.,  440.,  460.,  460.,
        480.,  480.,  500.,  500.,  520.,  520.,  540.,  540.,  560.,
        560.,  580.,  580.,  600.,  600.,  620.,  620.,  640.,  640.,
        660.,  660.,  680.,  680.,  700.,  700.,  720.,  720.,  740.,
        740.,  760.,  780.,  780.,  800.,  800.,  820.,  820.,  840.,
        840.,  860.,  860.,  880.,  880.,  900.,  900.,  920.,  920.,
        940.,  940.,  960.,  960.,  980.,  980., 1000., 1000., 1020.,
       1020., 1040., 1040., 1060., 1060., 1080., 1080., 1100., 1100.,
       1120., 1120., 1140., 1160., 1160., 1180., 1180., 1200., 1200.,
       1220., 1220., 1240., 1240., 1260., 1260., 1280., 1280., 1300.,
       1300., 1320., 1320., 1340., 1340., 1360., 1360., 1380., 1380.,
       1400., 1400., 1420., 1420., 1440., 1440., 1460., 1460., 1480.,
       1480., 1500., 1500., 1520., 1540., 1540., 1560., 1560., 1580.,
       1580., 1600., 1600., 1620., 1620., 1640., 1640., 1660., 1660.,
       1680., 1680., 1700., 1700., 1720., 1720., 1740., 1740., 1760.,
       1760., 1780., 1780., 1800., 1800., 1820., 1820., 1840., 1840.,
       1860., 1860., 1880., 1880., 1900., 1920., 1920., 1940., 1940.,
       1960., 1960., 1980., 1980., 2000., 2000., 2020., 2020., 2040.,
       2040., 2060., 2060., 2080., 2080., 2100., 2100., 2120., 2120.,
       2140., 2140., 2160., 2160., 2180., 2180., 2200., 2200., 2220.,
       2220., 2240., 2240., 2260., 2260., 2280., 2300., 2300., 2320.,
       2320., 2340., 2340., 2360., 2360., 2380., 2380., 2400., 2400.,
       2420., 2420., 2440., 2440., 2460., 2460., 2480., 2480., 2500.,
       2500., 2520., 2520., 2540., 2540., 2560., 2560., 2580., 2580.,
       2600., 2600., 2620., 2620., 2640., 2640., 2660., 2680., 2680.,
       2700., 2700., 2720., 2720., 2740., 2740., 2760., 2760., 2780.,
       2780., 2800., 2800., 2820., 2820., 2840., 2840., 2860., 2860.,
       2880., 2880., 2900., 2900., 2920., 2920., 2940., 2940., 2960.,
       2960., 2980., 2980., 3000., 3000., 3020., 3020., 3040., 3060.,
       3060., 3080., 3080., 3100., 3100., 3120., 3120., 3140., 3140.,
       3160., 3160., 3180., 3180., 3200., 3200., 3220., 3220., 3240.,
       3240., 3260., 3260., 3280., 3280., 3300., 3300., 3320., 3320.,
       3340., 3340., 3360., 3360., 3380., 3380., 3400., 3400., 3420.,
       3440., 3440., 3460., 3460., 3480., 3480., 3500., 3500., 3520.,
       3520., 3540., 3540., 3560., 3560., 3580., 3580., 3600., 3600.,
       3620., 3620., 3640., 3640., 3660., 3660., 3680., 3680., 3700.,
       3700., 3720., 3720., 3740., 3740., 3760., 3760., 3780., 3780.,
       3800., 3820., 3820., 3840., 3840.], dtype=np.float32),
    'kcoords': np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
      dtype=np.float32),
    'chanMap': np.array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,
        13,  14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,
        26,  27,  28,  29,  30,  31,  32,  33,  34,  35,  37,  38,  39,
        40,  41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,
        53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,  65,
        66,  67,  68,  69,  70,  71,  72,  73,  74,  76,  77,  78,  79,
        80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,  92,
        93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103, 104, 105,
       106, 107, 108, 109, 110, 111, 113, 114, 115, 116, 117, 118, 119,
       120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132,
       133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145,
       146, 147, 148, 149, 150, 152, 153, 154, 155, 156, 157, 158, 159,
       160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172,
       173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185,
       186, 187, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199,
       200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212,
       213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225,
       226, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239,
       240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252,
       253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 265, 266,
       267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279,
       280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292,
       293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 304, 305, 306,
       307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319,
       320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332,
       333, 334, 335, 336, 337, 338, 339, 341, 342, 343, 344, 345, 346,
       347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359,
       360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372,
       373, 374, 375, 376, 377, 378, 380, 381, 382, 383], dtype=np.int32),
    'n_chan': 384
}

2025-05-15 05:35:22,880 kilosort.run_kilosort INFO      
2025-05-15 05:35:22,881 kilosort.run_kilosort INFO     Computing preprocessing variables.
2025-05-15 05:35:22,881 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-15 05:35:23,134 kilosort.run_kilosort INFO     N samples: 9000000
2025-05-15 05:35:23,135 kilosort.run_kilosort INFO     N seconds: 300.0
2025-05-15 05:35:23,135 kilosort.run_kilosort INFO     N batches: 150
2025-05-15 05:35:24,218 kilosort.run_kilosort INFO     Preprocessing filters computed in  1.34s; total  1.35s
2025-05-15 05:35:24,219 kilosort.run_kilosort DEBUG    hp_filter shape: torch.Size([30122])
2025-05-15 05:35:24,219 kilosort.run_kilosort DEBUG    whiten_mat shape: torch.Size([374, 374])
2025-05-15 05:35:24,219 kilosort.run_kilosort INFO      
2025-05-15 05:35:24,220 kilosort.run_kilosort INFO     Resource usage after preprocessing
2025-05-15 05:35:24,220 kilosort.run_kilosort INFO     ********************************************************
2025-05-15 05:35:24,221 kilosort.run_kilosort INFO     CPU usage:    10.30 %
2025-05-15 05:35:24,221 kilosort.run_kilosort INFO     Memory:       17.92 %     |    135.22   /   754.60 GB
2025-05-15 05:35:24,222 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-15 05:35:24,222 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:35:24,222 kilosort.run_kilosort INFO     GPU memory:   44.70 %     |     17.66   /    39.50 GB
2025-05-15 05:35:24,223 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-15 05:35:24,224 kilosort.run_kilosort INFO     Max alloc:     3.23 %     |      1.28   /    39.50 GB
2025-05-15 05:35:24,224 kilosort.run_kilosort INFO     ********************************************************
2025-05-15 05:35:24,226 kilosort.run_kilosort INFO      
2025-05-15 05:35:24,227 kilosort.run_kilosort INFO     Computing drift correction.
2025-05-15 05:35:24,227 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-15 05:35:24,228 kilosort.spikedetect INFO     Re-computing universal templates from data.
2025-05-15 05:35:24,855 kilosort.spikedetect INFO     Number of universal templates: 1532
2025-05-15 05:35:24,979 kilosort.spikedetect INFO     Detecting spikes...
2025-05-15 05:35:24,981 kilosort.spikedetect DEBUG     
2025-05-15 05:35:24,981 kilosort.spikedetect DEBUG    Batch 0
2025-05-15 05:35:24,981 kilosort.spikedetect DEBUG    ********************************************************
2025-05-15 05:35:24,982 kilosort.spikedetect DEBUG    CPU usage:    16.60 %
2025-05-15 05:35:24,982 kilosort.spikedetect DEBUG    Memory:       17.94 %     |    135.38   /   754.60 GB
2025-05-15 05:35:24,982 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-15 05:35:24,982 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:35:24,982 kilosort.spikedetect DEBUG    GPU memory:   44.70 %     |     17.66   /    39.50 GB
2025-05-15 05:35:24,982 kilosort.spikedetect DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:35:24,982 kilosort.spikedetect DEBUG    Max alloc:     3.23 %     |      1.28   /    39.50 GB
2025-05-15 05:35:24,982 kilosort.spikedetect DEBUG    ********************************************************
2025-05-15 05:36:10,751 kilosort.spikedetect DEBUG     
2025-05-15 05:36:10,751 kilosort.spikedetect DEBUG    Batch 149
2025-05-15 05:36:10,751 kilosort.spikedetect DEBUG    ********************************************************
2025-05-15 05:36:10,751 kilosort.spikedetect DEBUG    CPU usage:    10.80 %
2025-05-15 05:36:10,751 kilosort.spikedetect DEBUG    Memory:       17.95 %     |    135.49   /   754.60 GB
2025-05-15 05:36:10,751 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-15 05:36:10,751 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:36:10,752 kilosort.spikedetect DEBUG    GPU memory:   53.63 %     |     21.18   /    39.50 GB
2025-05-15 05:36:10,752 kilosort.spikedetect DEBUG    Allocated:     0.25 %     |      0.10   /    39.50 GB
2025-05-15 05:36:10,752 kilosort.spikedetect DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:36:10,752 kilosort.spikedetect DEBUG    ********************************************************
2025-05-15 05:36:11,083 kilosort.run_kilosort INFO     drift computed in  46.86s; total  48.21s
2025-05-15 05:36:11,084 kilosort.run_kilosort DEBUG    st shape: (166326, 6)
2025-05-15 05:36:11,084 kilosort.run_kilosort DEBUG    yblk shape: (1,)
2025-05-15 05:36:11,084 kilosort.run_kilosort DEBUG    dshift shape: (150, 1)
2025-05-15 05:36:11,084 kilosort.run_kilosort DEBUG    iKxx shape: torch.Size([374, 374])
2025-05-15 05:36:11,085 kilosort.run_kilosort INFO      
2025-05-15 05:36:11,085 kilosort.run_kilosort INFO     Resource usage after drift correction
2025-05-15 05:36:11,086 kilosort.run_kilosort INFO     ********************************************************
2025-05-15 05:36:11,086 kilosort.run_kilosort INFO     CPU usage:    11.90 %
2025-05-15 05:36:11,087 kilosort.run_kilosort INFO     Memory:       17.95 %     |    135.47   /   754.60 GB
2025-05-15 05:36:11,087 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-15 05:36:11,087 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:36:11,088 kilosort.run_kilosort INFO     GPU memory:   53.64 %     |     21.19   /    39.50 GB
2025-05-15 05:36:11,088 kilosort.run_kilosort INFO     Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:36:11,089 kilosort.run_kilosort INFO     Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:36:11,089 kilosort.run_kilosort INFO     ********************************************************
2025-05-15 05:36:11,090 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  11150 KiB |   3359 MiB |  12961 GiB |  12961 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  11150 KiB |   3359 MiB |  12961 GiB |  12961 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  11149 KiB |   3358 MiB |  12958 GiB |  12958 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5222 MiB |   5222 MiB |   5222 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38001 KiB |   1749 MiB |   6275 GiB |   6275 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       9    |      37    |  110577    |  110568    |
|---------------------------------------------------------------------------|
| Active allocs         |       9    |      37    |  110577    |  110568    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      16    |      16    |      16    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      22    |   40121    |   40113    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-15 05:36:11,161 kilosort.run_kilosort DEBUG    First batch min, max: (-18.656937, 9.586864)
2025-05-15 05:36:11,161 kilosort.run_kilosort INFO      
2025-05-15 05:36:11,161 kilosort.run_kilosort INFO     Extracting spikes using templates
2025-05-15 05:36:11,162 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-15 05:36:11,162 kilosort.spikedetect INFO     Re-computing universal templates from data.
2025-05-15 05:36:11,531 kilosort.spikedetect INFO     Number of universal templates: 1532
2025-05-15 05:36:11,633 kilosort.spikedetect INFO     Detecting spikes...
2025-05-15 05:36:11,635 kilosort.spikedetect DEBUG     
2025-05-15 05:36:11,635 kilosort.spikedetect DEBUG    Batch 0
2025-05-15 05:36:11,635 kilosort.spikedetect DEBUG    ********************************************************
2025-05-15 05:36:11,635 kilosort.spikedetect DEBUG    CPU usage:    17.70 %
2025-05-15 05:36:11,636 kilosort.spikedetect DEBUG    Memory:       17.97 %     |    135.59   /   754.60 GB
2025-05-15 05:36:11,636 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-15 05:36:11,636 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:36:11,636 kilosort.spikedetect DEBUG    GPU memory:   53.64 %     |     21.19   /    39.50 GB
2025-05-15 05:36:11,636 kilosort.spikedetect DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:36:11,636 kilosort.spikedetect DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:36:11,636 kilosort.spikedetect DEBUG    ********************************************************
2025-05-15 05:36:54,435 kilosort.spikedetect DEBUG     
2025-05-15 05:36:54,435 kilosort.spikedetect DEBUG    Batch 149
2025-05-15 05:36:54,435 kilosort.spikedetect DEBUG    ********************************************************
2025-05-15 05:36:54,436 kilosort.spikedetect DEBUG    CPU usage:    11.20 %
2025-05-15 05:36:54,436 kilosort.spikedetect DEBUG    Memory:       17.98 %     |    135.71   /   754.60 GB
2025-05-15 05:36:54,436 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-15 05:36:54,436 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:36:54,436 kilosort.spikedetect DEBUG    GPU memory:   53.64 %     |     21.19   /    39.50 GB
2025-05-15 05:36:54,436 kilosort.spikedetect DEBUG    Allocated:     0.25 %     |      0.10   /    39.50 GB
2025-05-15 05:36:54,437 kilosort.spikedetect DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:36:54,437 kilosort.spikedetect DEBUG    ********************************************************
2025-05-15 05:36:54,437 kilosort.run_kilosort INFO     158080 spikes extracted in  43.28s; total  91.57s
2025-05-15 05:36:54,437 kilosort.run_kilosort DEBUG    st0 shape: (158080, 6)
2025-05-15 05:36:54,437 kilosort.run_kilosort DEBUG    tF shape: torch.Size([158080, 10, 6])
2025-05-15 05:36:54,437 kilosort.run_kilosort INFO      
2025-05-15 05:36:54,438 kilosort.run_kilosort INFO     First clustering
2025-05-15 05:36:54,438 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-15 05:36:54,452 kilosort.clustering_qr DEBUG     
2025-05-15 05:36:54,452 kilosort.clustering_qr DEBUG    Cluster center: 0 of 96
2025-05-15 05:36:54,452 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:36:54,452 kilosort.clustering_qr DEBUG    CPU usage:    20.00 %
2025-05-15 05:36:54,452 kilosort.clustering_qr DEBUG    Memory:       17.98 %     |    135.67   /   754.60 GB
2025-05-15 05:36:54,452 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:36:54,453 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:36:54,453 kilosort.clustering_qr DEBUG    GPU memory:   53.64 %     |     21.19   /    39.50 GB
2025-05-15 05:36:54,453 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:36:54,453 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:36:54,453 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:36:54,504 kilosort.clustering_qr DEBUG    Center 0 | nsp: 8074 | ntemp: 16
2025-05-15 05:36:55,144 kilosort.clustering_qr DEBUG    Center 1 | nsp: 656 | ntemp: 16
2025-05-15 05:36:55,147 kilosort.clustering_qr DEBUG    Center 2 | nsp: 1211 | ntemp: 16
2025-05-15 05:36:55,497 kilosort.clustering_qr DEBUG    Center 3 | nsp: 1496 | ntemp: 16
2025-05-15 05:36:55,752 kilosort.clustering_qr DEBUG    Center 4 | nsp: 2465 | ntemp: 16
2025-05-15 05:36:56,102 kilosort.clustering_qr DEBUG    Center 5 | nsp: 1849 | ntemp: 16
2025-05-15 05:36:56,478 kilosort.clustering_qr DEBUG    Center 6 | nsp: 1809 | ntemp: 16
2025-05-15 05:36:56,835 kilosort.clustering_qr DEBUG    Center 7 | nsp: 1917 | ntemp: 16
2025-05-15 05:36:57,242 kilosort.clustering_qr DEBUG    Center 8 | nsp: 1579 | ntemp: 16
2025-05-15 05:36:57,608 kilosort.clustering_qr DEBUG    Center 9 | nsp: 2035 | ntemp: 16
2025-05-15 05:36:58,003 kilosort.clustering_qr DEBUG     
2025-05-15 05:36:58,003 kilosort.clustering_qr DEBUG    Cluster center: 10 of 96
2025-05-15 05:36:58,004 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:36:58,004 kilosort.clustering_qr DEBUG    CPU usage:    19.10 %
2025-05-15 05:36:58,004 kilosort.clustering_qr DEBUG    Memory:       18.01 %     |    135.89   /   754.60 GB
2025-05-15 05:36:58,004 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:36:58,004 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:36:58,004 kilosort.clustering_qr DEBUG    GPU memory:   53.64 %     |     21.19   /    39.50 GB
2025-05-15 05:36:58,004 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:36:58,004 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:36:58,004 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:36:58,008 kilosort.clustering_qr DEBUG    Center 10 | nsp: 2306 | ntemp: 16
2025-05-15 05:36:58,298 kilosort.clustering_qr DEBUG    Center 11 | nsp: 1956 | ntemp: 16
2025-05-15 05:36:58,550 kilosort.clustering_qr DEBUG    Center 12 | nsp: 3697 | ntemp: 16
2025-05-15 05:36:58,913 kilosort.clustering_qr DEBUG    Center 13 | nsp: 2712 | ntemp: 16
2025-05-15 05:36:59,325 kilosort.clustering_qr DEBUG    Center 14 | nsp: 1971 | ntemp: 16
2025-05-15 05:36:59,721 kilosort.clustering_qr DEBUG    Center 15 | nsp: 3104 | ntemp: 16
2025-05-15 05:37:00,005 kilosort.clustering_qr DEBUG    Center 16 | nsp: 1799 | ntemp: 16
2025-05-15 05:37:00,266 kilosort.clustering_qr DEBUG    Center 17 | nsp: 2583 | ntemp: 16
2025-05-15 05:37:00,528 kilosort.clustering_qr DEBUG    Center 18 | nsp: 1933 | ntemp: 16
2025-05-15 05:37:00,885 kilosort.clustering_qr DEBUG    Center 19 | nsp: 2614 | ntemp: 16
2025-05-15 05:37:01,253 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:01,253 kilosort.clustering_qr DEBUG    Cluster center: 20 of 96
2025-05-15 05:37:01,253 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:01,254 kilosort.clustering_qr DEBUG    CPU usage:    20.50 %
2025-05-15 05:37:01,254 kilosort.clustering_qr DEBUG    Memory:       18.01 %     |    135.89   /   754.60 GB
2025-05-15 05:37:01,254 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:01,254 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:01,254 kilosort.clustering_qr DEBUG    GPU memory:   53.64 %     |     21.19   /    39.50 GB
2025-05-15 05:37:01,254 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:01,254 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:01,254 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:01,258 kilosort.clustering_qr DEBUG    Center 20 | nsp: 2937 | ntemp: 16
2025-05-15 05:37:01,519 kilosort.clustering_qr DEBUG    Center 21 | nsp: 3870 | ntemp: 16
2025-05-15 05:37:01,779 kilosort.clustering_qr DEBUG    Center 22 | nsp: 3227 | ntemp: 16
2025-05-15 05:37:02,039 kilosort.clustering_qr DEBUG    Center 23 | nsp: 2407 | ntemp: 16
2025-05-15 05:37:02,296 kilosort.clustering_qr DEBUG    Center 24 | nsp: 2616 | ntemp: 16
2025-05-15 05:37:02,655 kilosort.clustering_qr DEBUG    Center 25 | nsp: 2841 | ntemp: 16
2025-05-15 05:37:03,026 kilosort.clustering_qr DEBUG    Center 26 | nsp: 3276 | ntemp: 16
2025-05-15 05:37:03,402 kilosort.clustering_qr DEBUG    Center 27 | nsp: 2137 | ntemp: 16
2025-05-15 05:37:03,783 kilosort.clustering_qr DEBUG    Center 28 | nsp: 2413 | ntemp: 16
2025-05-15 05:37:04,183 kilosort.clustering_qr DEBUG    Center 29 | nsp: 2568 | ntemp: 16
2025-05-15 05:37:04,563 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:04,563 kilosort.clustering_qr DEBUG    Cluster center: 30 of 96
2025-05-15 05:37:04,563 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:04,563 kilosort.clustering_qr DEBUG    CPU usage:    20.40 %
2025-05-15 05:37:04,563 kilosort.clustering_qr DEBUG    Memory:       18.01 %     |    135.89   /   754.60 GB
2025-05-15 05:37:04,563 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:04,564 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:04,564 kilosort.clustering_qr DEBUG    GPU memory:   53.64 %     |     21.19   /    39.50 GB
2025-05-15 05:37:04,564 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:04,564 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:04,564 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:04,567 kilosort.clustering_qr DEBUG    Center 30 | nsp: 1715 | ntemp: 16
2025-05-15 05:37:04,927 kilosort.clustering_qr DEBUG    Center 31 | nsp: 2686 | ntemp: 16
2025-05-15 05:37:05,296 kilosort.clustering_qr DEBUG    Center 32 | nsp: 3263 | ntemp: 16
2025-05-15 05:37:05,663 kilosort.clustering_qr DEBUG    Center 33 | nsp: 3828 | ntemp: 16
2025-05-15 05:37:06,031 kilosort.clustering_qr DEBUG    Center 34 | nsp: 2131 | ntemp: 16
2025-05-15 05:37:06,428 kilosort.clustering_qr DEBUG    Center 35 | nsp: 2192 | ntemp: 16
2025-05-15 05:37:06,798 kilosort.clustering_qr DEBUG    Center 36 | nsp: 1426 | ntemp: 16
2025-05-15 05:37:07,166 kilosort.clustering_qr DEBUG    Center 37 | nsp: 1715 | ntemp: 16
2025-05-15 05:37:07,548 kilosort.clustering_qr DEBUG    Center 38 | nsp: 1387 | ntemp: 16
2025-05-15 05:37:07,899 kilosort.clustering_qr DEBUG    Center 39 | nsp: 1843 | ntemp: 16
2025-05-15 05:37:08,255 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:08,255 kilosort.clustering_qr DEBUG    Cluster center: 40 of 96
2025-05-15 05:37:08,255 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:08,256 kilosort.clustering_qr DEBUG    CPU usage:    19.70 %
2025-05-15 05:37:08,256 kilosort.clustering_qr DEBUG    Memory:       18.01 %     |    135.90   /   754.60 GB
2025-05-15 05:37:08,256 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:08,256 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:08,256 kilosort.clustering_qr DEBUG    GPU memory:   53.64 %     |     21.19   /    39.50 GB
2025-05-15 05:37:08,256 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:08,256 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:08,256 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:08,267 kilosort.clustering_qr DEBUG    Center 40 | nsp: 1296 | ntemp: 16
2025-05-15 05:37:08,655 kilosort.clustering_qr DEBUG    Center 41 | nsp: 1318 | ntemp: 16
2025-05-15 05:37:09,020 kilosort.clustering_qr DEBUG    Center 42 | nsp: 1194 | ntemp: 16
2025-05-15 05:37:09,408 kilosort.clustering_qr DEBUG    Center 43 | nsp: 1349 | ntemp: 16
2025-05-15 05:37:09,789 kilosort.clustering_qr DEBUG    Center 44 | nsp: 2191 | ntemp: 16
2025-05-15 05:37:10,159 kilosort.clustering_qr DEBUG    Center 45 | nsp: 815 | ntemp: 16
2025-05-15 05:37:10,162 kilosort.clustering_qr DEBUG    Center 46 | nsp: 907 | ntemp: 16
2025-05-15 05:37:10,165 kilosort.clustering_qr DEBUG    Center 47 | nsp: 812 | ntemp: 16
2025-05-15 05:37:10,169 kilosort.clustering_qr DEBUG    Center 48 | nsp: 989 | ntemp: 16
2025-05-15 05:37:10,172 kilosort.clustering_qr DEBUG    Center 49 | nsp: 448 | ntemp: 16
2025-05-15 05:37:10,172 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:10,172 kilosort.clustering_qr DEBUG    Cluster center: 50 of 96
2025-05-15 05:37:10,172 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:10,172 kilosort.clustering_qr DEBUG    CPU usage:    20.10 %
2025-05-15 05:37:10,172 kilosort.clustering_qr DEBUG    Memory:       18.01 %     |    135.90   /   754.60 GB
2025-05-15 05:37:10,172 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:10,173 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:10,173 kilosort.clustering_qr DEBUG    GPU memory:   53.64 %     |     21.19   /    39.50 GB
2025-05-15 05:37:10,173 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:10,173 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:10,173 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:10,176 kilosort.clustering_qr DEBUG    Center 50 | nsp: 272 | ntemp: 16
2025-05-15 05:37:10,179 kilosort.clustering_qr DEBUG    Center 51 | nsp: 316 | ntemp: 16
2025-05-15 05:37:10,182 kilosort.clustering_qr DEBUG    Center 52 | nsp: 521 | ntemp: 16
2025-05-15 05:37:10,185 kilosort.clustering_qr DEBUG    Center 53 | nsp: 636 | ntemp: 16
2025-05-15 05:37:10,188 kilosort.clustering_qr DEBUG    Center 54 | nsp: 822 | ntemp: 16
2025-05-15 05:37:10,191 kilosort.clustering_qr DEBUG    Center 55 | nsp: 796 | ntemp: 16
2025-05-15 05:37:10,194 kilosort.clustering_qr DEBUG    Center 56 | nsp: 451 | ntemp: 16
2025-05-15 05:37:10,197 kilosort.clustering_qr DEBUG    Center 57 | nsp: 330 | ntemp: 16
2025-05-15 05:37:10,200 kilosort.clustering_qr DEBUG    Center 58 | nsp: 253 | ntemp: 16
2025-05-15 05:37:10,203 kilosort.clustering_qr DEBUG    Center 59 | nsp: 565 | ntemp: 16
2025-05-15 05:37:10,203 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:10,203 kilosort.clustering_qr DEBUG    Cluster center: 60 of 96
2025-05-15 05:37:10,203 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:10,203 kilosort.clustering_qr DEBUG    CPU usage:    35.70 %
2025-05-15 05:37:10,203 kilosort.clustering_qr DEBUG    Memory:       18.01 %     |    135.90   /   754.60 GB
2025-05-15 05:37:10,204 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:10,204 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:10,204 kilosort.clustering_qr DEBUG    GPU memory:   53.64 %     |     21.19   /    39.50 GB
2025-05-15 05:37:10,204 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:10,204 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:10,204 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:10,207 kilosort.clustering_qr DEBUG    Center 60 | nsp: 1220 | ntemp: 16
2025-05-15 05:37:10,454 kilosort.clustering_qr DEBUG    Center 61 | nsp: 1582 | ntemp: 16
2025-05-15 05:37:10,703 kilosort.clustering_qr DEBUG    Center 62 | nsp: 1781 | ntemp: 16
2025-05-15 05:37:10,951 kilosort.clustering_qr DEBUG    Center 63 | nsp: 1537 | ntemp: 16
2025-05-15 05:37:11,200 kilosort.clustering_qr DEBUG    Center 64 | nsp: 1281 | ntemp: 16
2025-05-15 05:37:11,445 kilosort.clustering_qr DEBUG    Center 65 | nsp: 682 | ntemp: 16
2025-05-15 05:37:11,448 kilosort.clustering_qr DEBUG    Center 66 | nsp: 613 | ntemp: 16
2025-05-15 05:37:11,452 kilosort.clustering_qr DEBUG    Center 67 | nsp: 1010 | ntemp: 16
2025-05-15 05:37:11,697 kilosort.clustering_qr DEBUG    Center 68 | nsp: 1015 | ntemp: 16
2025-05-15 05:37:11,942 kilosort.clustering_qr DEBUG    Center 69 | nsp: 1131 | ntemp: 16
2025-05-15 05:37:12,185 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:12,185 kilosort.clustering_qr DEBUG    Cluster center: 70 of 96
2025-05-15 05:37:12,185 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:12,185 kilosort.clustering_qr DEBUG    CPU usage:    12.10 %
2025-05-15 05:37:12,186 kilosort.clustering_qr DEBUG    Memory:       18.01 %     |    135.90   /   754.60 GB
2025-05-15 05:37:12,186 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:12,186 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:12,186 kilosort.clustering_qr DEBUG    GPU memory:   53.64 %     |     21.19   /    39.50 GB
2025-05-15 05:37:12,186 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:12,186 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:12,186 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:12,189 kilosort.clustering_qr DEBUG    Center 70 | nsp: 1344 | ntemp: 16
2025-05-15 05:37:12,435 kilosort.clustering_qr DEBUG    Center 71 | nsp: 1134 | ntemp: 16
2025-05-15 05:37:12,680 kilosort.clustering_qr DEBUG    Center 72 | nsp: 1222 | ntemp: 16
2025-05-15 05:37:12,925 kilosort.clustering_qr DEBUG    Center 73 | nsp: 1755 | ntemp: 16
2025-05-15 05:37:13,174 kilosort.clustering_qr DEBUG    Center 74 | nsp: 3026 | ntemp: 16
2025-05-15 05:37:13,423 kilosort.clustering_qr DEBUG    Center 75 | nsp: 2582 | ntemp: 16
2025-05-15 05:37:13,673 kilosort.clustering_qr DEBUG    Center 76 | nsp: 1838 | ntemp: 16
2025-05-15 05:37:13,922 kilosort.clustering_qr DEBUG    Center 77 | nsp: 1579 | ntemp: 16
2025-05-15 05:37:14,169 kilosort.clustering_qr DEBUG    Center 78 | nsp: 1666 | ntemp: 16
2025-05-15 05:37:14,417 kilosort.clustering_qr DEBUG    Center 79 | nsp: 1240 | ntemp: 16
2025-05-15 05:37:14,660 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:14,660 kilosort.clustering_qr DEBUG    Cluster center: 80 of 96
2025-05-15 05:37:14,660 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:14,660 kilosort.clustering_qr DEBUG    CPU usage:    12.00 %
2025-05-15 05:37:14,660 kilosort.clustering_qr DEBUG    Memory:       18.01 %     |    135.90   /   754.60 GB
2025-05-15 05:37:14,660 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:14,660 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:14,660 kilosort.clustering_qr DEBUG    GPU memory:   53.64 %     |     21.19   /    39.50 GB
2025-05-15 05:37:14,661 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:14,661 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:14,661 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:14,664 kilosort.clustering_qr DEBUG    Center 80 | nsp: 962 | ntemp: 16
2025-05-15 05:37:14,667 kilosort.clustering_qr DEBUG    Center 81 | nsp: 826 | ntemp: 16
2025-05-15 05:37:14,670 kilosort.clustering_qr DEBUG    Center 82 | nsp: 1108 | ntemp: 16
2025-05-15 05:37:14,916 kilosort.clustering_qr DEBUG    Center 83 | nsp: 882 | ntemp: 16
2025-05-15 05:37:14,919 kilosort.clustering_qr DEBUG    Center 84 | nsp: 511 | ntemp: 16
2025-05-15 05:37:14,922 kilosort.clustering_qr DEBUG    Center 85 | nsp: 677 | ntemp: 16
2025-05-15 05:37:14,925 kilosort.clustering_qr DEBUG    Center 86 | nsp: 1180 | ntemp: 16
2025-05-15 05:37:15,171 kilosort.clustering_qr DEBUG    Center 87 | nsp: 1482 | ntemp: 16
2025-05-15 05:37:15,418 kilosort.clustering_qr DEBUG    Center 88 | nsp: 1437 | ntemp: 16
2025-05-15 05:37:15,666 kilosort.clustering_qr DEBUG    Center 89 | nsp: 1167 | ntemp: 16
2025-05-15 05:37:15,908 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:15,908 kilosort.clustering_qr DEBUG    Cluster center: 90 of 96
2025-05-15 05:37:15,908 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:15,908 kilosort.clustering_qr DEBUG    CPU usage:    12.30 %
2025-05-15 05:37:15,908 kilosort.clustering_qr DEBUG    Memory:       18.01 %     |    135.90   /   754.60 GB
2025-05-15 05:37:15,908 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:15,908 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:15,908 kilosort.clustering_qr DEBUG    GPU memory:   53.64 %     |     21.19   /    39.50 GB
2025-05-15 05:37:15,908 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:15,908 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:15,908 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:15,911 kilosort.clustering_qr DEBUG    Center 90 | nsp: 1103 | ntemp: 16
2025-05-15 05:37:16,157 kilosort.clustering_qr DEBUG    Center 91 | nsp: 823 | ntemp: 16
2025-05-15 05:37:16,160 kilosort.clustering_qr DEBUG    Center 92 | nsp: 887 | ntemp: 16
2025-05-15 05:37:16,163 kilosort.clustering_qr DEBUG    Center 93 | nsp: 525 | ntemp: 16
2025-05-15 05:37:16,166 kilosort.clustering_qr DEBUG    Center 94 | nsp: 423 | ntemp: 16
2025-05-15 05:37:16,168 kilosort.clustering_qr DEBUG    Center 95 | nsp: 324 | ntemp: 12
2025-05-15 05:37:16,335 kilosort.run_kilosort INFO     279 clusters found, in  21.90s; total  113.47s
2025-05-15 05:37:16,335 kilosort.run_kilosort DEBUG    clu shape: (158080,)
2025-05-15 05:37:16,336 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([279, 374, 6])
2025-05-15 05:37:16,336 kilosort.run_kilosort INFO      
2025-05-15 05:37:16,336 kilosort.run_kilosort INFO     Extracting spikes using cluster waveforms
2025-05-15 05:37:16,336 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-15 05:37:16,357 kilosort.template_matching DEBUG     
2025-05-15 05:37:16,358 kilosort.template_matching DEBUG    Batch 0
2025-05-15 05:37:16,358 kilosort.template_matching DEBUG    ********************************************************
2025-05-15 05:37:16,358 kilosort.template_matching DEBUG    CPU usage:    13.80 %
2025-05-15 05:37:16,358 kilosort.template_matching DEBUG    Memory:       18.04 %     |    136.12   /   754.60 GB
2025-05-15 05:37:16,358 kilosort.template_matching DEBUG    ------------------------------------------------------
2025-05-15 05:37:16,358 kilosort.template_matching DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:16,358 kilosort.template_matching DEBUG    GPU memory:   53.64 %     |     21.19   /    39.50 GB
2025-05-15 05:37:16,358 kilosort.template_matching DEBUG    Allocated:     0.11 %     |      0.04   /    39.50 GB
2025-05-15 05:37:16,358 kilosort.template_matching DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:16,358 kilosort.template_matching DEBUG    ********************************************************
2025-05-15 05:37:26,173 kilosort.template_matching DEBUG     
2025-05-15 05:37:26,174 kilosort.template_matching DEBUG    Batch 100
2025-05-15 05:37:26,174 kilosort.template_matching DEBUG    ********************************************************
2025-05-15 05:37:26,174 kilosort.template_matching DEBUG    CPU usage:    12.20 %
2025-05-15 05:37:26,174 kilosort.template_matching DEBUG    Memory:       18.04 %     |    136.13   /   754.60 GB
2025-05-15 05:37:26,174 kilosort.template_matching DEBUG    ------------------------------------------------------
2025-05-15 05:37:26,174 kilosort.template_matching DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:26,174 kilosort.template_matching DEBUG    GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:26,175 kilosort.template_matching DEBUG    Allocated:     0.54 %     |      0.21   /    39.50 GB
2025-05-15 05:37:26,175 kilosort.template_matching DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:26,175 kilosort.template_matching DEBUG    ********************************************************
2025-05-15 05:37:31,034 kilosort.template_matching DEBUG     
2025-05-15 05:37:31,034 kilosort.template_matching DEBUG    Batch 149
2025-05-15 05:37:31,034 kilosort.template_matching DEBUG    ********************************************************
2025-05-15 05:37:31,034 kilosort.template_matching DEBUG    CPU usage:    12.20 %
2025-05-15 05:37:31,034 kilosort.template_matching DEBUG    Memory:       18.04 %     |    136.13   /   754.60 GB
2025-05-15 05:37:31,034 kilosort.template_matching DEBUG    ------------------------------------------------------
2025-05-15 05:37:31,034 kilosort.template_matching DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:31,034 kilosort.template_matching DEBUG    GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:31,035 kilosort.template_matching DEBUG    Allocated:     0.54 %     |      0.21   /    39.50 GB
2025-05-15 05:37:31,035 kilosort.template_matching DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:31,035 kilosort.template_matching DEBUG    ********************************************************
2025-05-15 05:37:31,057 kilosort.run_kilosort INFO     351411 spikes extracted in  14.72s; total  128.19s
2025-05-15 05:37:31,058 kilosort.run_kilosort DEBUG    st shape: (351411, 3)
2025-05-15 05:37:31,058 kilosort.run_kilosort DEBUG    tF shape: torch.Size([351411, 10, 6])
2025-05-15 05:37:31,058 kilosort.run_kilosort DEBUG    iCC shape: torch.Size([10, 374])
2025-05-15 05:37:31,058 kilosort.run_kilosort DEBUG    iU shape: torch.Size([257])
2025-05-15 05:37:31,058 kilosort.run_kilosort INFO      
2025-05-15 05:37:31,061 kilosort.run_kilosort INFO     Resource usage after spike detection
2025-05-15 05:37:31,062 kilosort.run_kilosort INFO     ********************************************************
2025-05-15 05:37:31,062 kilosort.run_kilosort INFO     CPU usage:    19.60 %
2025-05-15 05:37:31,063 kilosort.run_kilosort INFO     Memory:       18.02 %     |    135.95   /   754.60 GB
2025-05-15 05:37:31,063 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-15 05:37:31,064 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:31,064 kilosort.run_kilosort INFO     GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:31,065 kilosort.run_kilosort INFO     Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:31,065 kilosort.run_kilosort INFO     Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:31,065 kilosort.run_kilosort INFO     ********************************************************
2025-05-15 05:37:31,066 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  13439 KiB |   3361 MiB |  27918 GiB |  27918 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  13439 KiB |   3361 MiB |  27918 GiB |  27918 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  13436 KiB |   3359 MiB |  27907 GiB |  27907 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5226 MiB |   5226 MiB |   5226 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  35712 KiB |   1749 MiB |  14319 GiB |  14319 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      13    |      45    |    1327 K  |    1327 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      13    |      45    |    1327 K  |    1327 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |      18    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      25    |  549827    |  549818    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-15 05:37:31,066 kilosort.run_kilosort INFO      
2025-05-15 05:37:31,067 kilosort.run_kilosort INFO     Final clustering
2025-05-15 05:37:31,067 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-15 05:37:31,079 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:31,079 kilosort.clustering_qr DEBUG    Cluster center: 0 of 96
2025-05-15 05:37:31,079 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:31,079 kilosort.clustering_qr DEBUG    CPU usage:    17.70 %
2025-05-15 05:37:31,080 kilosort.clustering_qr DEBUG    Memory:       18.02 %     |    135.94   /   754.60 GB
2025-05-15 05:37:31,080 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:31,080 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:31,080 kilosort.clustering_qr DEBUG    GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:31,080 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:31,080 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:31,080 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:31,085 kilosort.clustering_qr DEBUG    Center 0 | nsp: 15623 | ntemp: 5
2025-05-15 05:37:33,939 kilosort.clustering_qr DEBUG    Center 1 | nsp: 0 | ntemp: 0
2025-05-15 05:37:33,964 kilosort.clustering_qr DEBUG    Center 2 | nsp: 2233 | ntemp: 4
2025-05-15 05:37:34,326 kilosort.clustering_qr DEBUG    Center 3 | nsp: 3118 | ntemp: 4
2025-05-15 05:37:34,688 kilosort.clustering_qr DEBUG    Center 4 | nsp: 4194 | ntemp: 5
2025-05-15 05:37:35,050 kilosort.clustering_qr DEBUG    Center 5 | nsp: 4214 | ntemp: 4
2025-05-15 05:37:35,305 kilosort.clustering_qr DEBUG    Center 6 | nsp: 3186 | ntemp: 2
2025-05-15 05:37:35,553 kilosort.clustering_qr DEBUG    Center 7 | nsp: 10634 | ntemp: 5
2025-05-15 05:37:35,928 kilosort.clustering_qr DEBUG    Center 8 | nsp: 1927 | ntemp: 3
2025-05-15 05:37:36,279 kilosort.clustering_qr DEBUG    Center 9 | nsp: 2412 | ntemp: 3
2025-05-15 05:37:36,524 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:36,524 kilosort.clustering_qr DEBUG    Cluster center: 10 of 96
2025-05-15 05:37:36,524 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:36,524 kilosort.clustering_qr DEBUG    CPU usage:    14.30 %
2025-05-15 05:37:36,524 kilosort.clustering_qr DEBUG    Memory:       18.02 %     |    136.00   /   754.60 GB
2025-05-15 05:37:36,524 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:36,524 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:36,525 kilosort.clustering_qr DEBUG    GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:36,525 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:36,525 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:36,525 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:36,528 kilosort.clustering_qr DEBUG    Center 10 | nsp: 5349 | ntemp: 8
2025-05-15 05:37:36,915 kilosort.clustering_qr DEBUG    Center 11 | nsp: 3650 | ntemp: 4
2025-05-15 05:37:37,163 kilosort.clustering_qr DEBUG    Center 12 | nsp: 6530 | ntemp: 4
2025-05-15 05:37:37,420 kilosort.clustering_qr DEBUG    Center 13 | nsp: 6035 | ntemp: 7
2025-05-15 05:37:37,794 kilosort.clustering_qr DEBUG    Center 14 | nsp: 3335 | ntemp: 5
2025-05-15 05:37:38,042 kilosort.clustering_qr DEBUG    Center 15 | nsp: 6391 | ntemp: 6
2025-05-15 05:37:38,406 kilosort.clustering_qr DEBUG    Center 16 | nsp: 2784 | ntemp: 3
2025-05-15 05:37:38,774 kilosort.clustering_qr DEBUG    Center 17 | nsp: 5434 | ntemp: 4
2025-05-15 05:37:39,155 kilosort.clustering_qr DEBUG    Center 18 | nsp: 4854 | ntemp: 4
2025-05-15 05:37:39,527 kilosort.clustering_qr DEBUG    Center 19 | nsp: 5402 | ntemp: 5
2025-05-15 05:37:39,893 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:39,893 kilosort.clustering_qr DEBUG    Cluster center: 20 of 96
2025-05-15 05:37:39,893 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:39,893 kilosort.clustering_qr DEBUG    CPU usage:    17.90 %
2025-05-15 05:37:39,893 kilosort.clustering_qr DEBUG    Memory:       18.02 %     |    136.00   /   754.60 GB
2025-05-15 05:37:39,893 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:39,893 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:39,893 kilosort.clustering_qr DEBUG    GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:39,894 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:39,894 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:39,894 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:39,896 kilosort.clustering_qr DEBUG    Center 20 | nsp: 5258 | ntemp: 5
2025-05-15 05:37:40,266 kilosort.clustering_qr DEBUG    Center 21 | nsp: 6553 | ntemp: 5
2025-05-15 05:37:40,635 kilosort.clustering_qr DEBUG    Center 22 | nsp: 8470 | ntemp: 5
2025-05-15 05:37:41,005 kilosort.clustering_qr DEBUG    Center 23 | nsp: 6256 | ntemp: 3
2025-05-15 05:37:41,370 kilosort.clustering_qr DEBUG    Center 24 | nsp: 2276 | ntemp: 2
2025-05-15 05:37:41,622 kilosort.clustering_qr DEBUG    Center 25 | nsp: 8590 | ntemp: 5
2025-05-15 05:37:42,003 kilosort.clustering_qr DEBUG    Center 26 | nsp: 7094 | ntemp: 5
2025-05-15 05:37:42,375 kilosort.clustering_qr DEBUG    Center 27 | nsp: 3621 | ntemp: 5
2025-05-15 05:37:42,763 kilosort.clustering_qr DEBUG    Center 28 | nsp: 6289 | ntemp: 6
2025-05-15 05:37:43,133 kilosort.clustering_qr DEBUG    Center 29 | nsp: 4382 | ntemp: 3
2025-05-15 05:37:43,505 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:43,505 kilosort.clustering_qr DEBUG    Cluster center: 30 of 96
2025-05-15 05:37:43,505 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:43,505 kilosort.clustering_qr DEBUG    CPU usage:    18.60 %
2025-05-15 05:37:43,506 kilosort.clustering_qr DEBUG    Memory:       18.02 %     |    136.00   /   754.60 GB
2025-05-15 05:37:43,506 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:43,506 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:43,506 kilosort.clustering_qr DEBUG    GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:43,506 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:43,506 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:43,506 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:43,509 kilosort.clustering_qr DEBUG    Center 30 | nsp: 8366 | ntemp: 5
2025-05-15 05:37:43,887 kilosort.clustering_qr DEBUG    Center 31 | nsp: 6748 | ntemp: 4
2025-05-15 05:37:44,259 kilosort.clustering_qr DEBUG    Center 32 | nsp: 5557 | ntemp: 4
2025-05-15 05:37:44,624 kilosort.clustering_qr DEBUG    Center 33 | nsp: 6787 | ntemp: 4
2025-05-15 05:37:44,992 kilosort.clustering_qr DEBUG    Center 34 | nsp: 6110 | ntemp: 4
2025-05-15 05:37:45,370 kilosort.clustering_qr DEBUG    Center 35 | nsp: 5706 | ntemp: 4
2025-05-15 05:37:45,737 kilosort.clustering_qr DEBUG    Center 36 | nsp: 6804 | ntemp: 4
2025-05-15 05:37:46,099 kilosort.clustering_qr DEBUG    Center 37 | nsp: 3320 | ntemp: 2
2025-05-15 05:37:46,454 kilosort.clustering_qr DEBUG    Center 38 | nsp: 3885 | ntemp: 3
2025-05-15 05:37:46,811 kilosort.clustering_qr DEBUG    Center 39 | nsp: 4652 | ntemp: 4
2025-05-15 05:37:47,124 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:47,124 kilosort.clustering_qr DEBUG    Cluster center: 40 of 96
2025-05-15 05:37:47,124 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:47,125 kilosort.clustering_qr DEBUG    CPU usage:    18.80 %
2025-05-15 05:37:47,125 kilosort.clustering_qr DEBUG    Memory:       18.02 %     |    136.00   /   754.60 GB
2025-05-15 05:37:47,125 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:47,125 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:47,125 kilosort.clustering_qr DEBUG    GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:47,125 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:47,125 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:47,125 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:47,169 kilosort.clustering_qr DEBUG    Center 40 | nsp: 3901 | ntemp: 3
2025-05-15 05:37:47,525 kilosort.clustering_qr DEBUG    Center 41 | nsp: 4039 | ntemp: 2
2025-05-15 05:37:47,880 kilosort.clustering_qr DEBUG    Center 42 | nsp: 6528 | ntemp: 4
2025-05-15 05:37:48,246 kilosort.clustering_qr DEBUG    Center 43 | nsp: 3721 | ntemp: 3
2025-05-15 05:37:48,492 kilosort.clustering_qr DEBUG    Center 44 | nsp: 5013 | ntemp: 3
2025-05-15 05:37:48,742 kilosort.clustering_qr DEBUG    Center 45 | nsp: 0 | ntemp: 0
2025-05-15 05:37:48,743 kilosort.clustering_qr DEBUG    Center 46 | nsp: 632 | ntemp: 2
2025-05-15 05:37:48,744 kilosort.clustering_qr DEBUG    Center 47 | nsp: 0 | ntemp: 0
2025-05-15 05:37:48,746 kilosort.clustering_qr DEBUG    Center 48 | nsp: 5328 | ntemp: 2
2025-05-15 05:37:48,997 kilosort.clustering_qr DEBUG    Center 49 | nsp: 3696 | ntemp: 1
2025-05-15 05:37:49,239 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:49,240 kilosort.clustering_qr DEBUG    Cluster center: 50 of 96
2025-05-15 05:37:49,240 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:49,240 kilosort.clustering_qr DEBUG    CPU usage:    16.10 %
2025-05-15 05:37:49,240 kilosort.clustering_qr DEBUG    Memory:       18.02 %     |    136.00   /   754.60 GB
2025-05-15 05:37:49,240 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:49,240 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:49,240 kilosort.clustering_qr DEBUG    GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:49,240 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:49,240 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:49,240 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:49,241 kilosort.clustering_qr DEBUG    Center 50 | nsp: 380 | ntemp: 1
2025-05-15 05:37:49,242 kilosort.clustering_qr DEBUG    Center 51 | nsp: 0 | ntemp: 0
2025-05-15 05:37:49,244 kilosort.clustering_qr DEBUG    Center 52 | nsp: 8211 | ntemp: 2
2025-05-15 05:37:49,500 kilosort.clustering_qr DEBUG    Center 53 | nsp: 918 | ntemp: 1
2025-05-15 05:37:49,502 kilosort.clustering_qr DEBUG    Center 54 | nsp: 4280 | ntemp: 1
2025-05-15 05:37:49,751 kilosort.clustering_qr DEBUG    Center 55 | nsp: 12587 | ntemp: 1
2025-05-15 05:37:50,021 kilosort.clustering_qr DEBUG    Center 56 | nsp: 0 | ntemp: 0
2025-05-15 05:37:50,023 kilosort.clustering_qr DEBUG    Center 57 | nsp: 6176 | ntemp: 2
2025-05-15 05:37:50,277 kilosort.clustering_qr DEBUG    Center 58 | nsp: 1348 | ntemp: 1
2025-05-15 05:37:50,516 kilosort.clustering_qr DEBUG    Center 59 | nsp: 0 | ntemp: 0
2025-05-15 05:37:50,516 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:50,516 kilosort.clustering_qr DEBUG    Cluster center: 60 of 96
2025-05-15 05:37:50,516 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:50,517 kilosort.clustering_qr DEBUG    CPU usage:    13.10 %
2025-05-15 05:37:50,517 kilosort.clustering_qr DEBUG    Memory:       18.03 %     |    136.02   /   754.60 GB
2025-05-15 05:37:50,517 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:50,517 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:50,517 kilosort.clustering_qr DEBUG    GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:50,517 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:50,517 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:50,517 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:50,519 kilosort.clustering_qr DEBUG    Center 60 | nsp: 1630 | ntemp: 3
2025-05-15 05:37:50,760 kilosort.clustering_qr DEBUG    Center 61 | nsp: 2299 | ntemp: 2
2025-05-15 05:37:51,003 kilosort.clustering_qr DEBUG    Center 62 | nsp: 2966 | ntemp: 2
2025-05-15 05:37:51,247 kilosort.clustering_qr DEBUG    Center 63 | nsp: 3057 | ntemp: 2
2025-05-15 05:37:51,491 kilosort.clustering_qr DEBUG    Center 64 | nsp: 3074 | ntemp: 2
2025-05-15 05:37:51,734 kilosort.clustering_qr DEBUG    Center 65 | nsp: 1182 | ntemp: 1
2025-05-15 05:37:51,983 kilosort.clustering_qr DEBUG    Center 66 | nsp: 1048 | ntemp: 1
2025-05-15 05:37:52,225 kilosort.clustering_qr DEBUG    Center 67 | nsp: 2509 | ntemp: 2
2025-05-15 05:37:52,470 kilosort.clustering_qr DEBUG    Center 68 | nsp: 2504 | ntemp: 2
2025-05-15 05:37:52,714 kilosort.clustering_qr DEBUG    Center 69 | nsp: 2744 | ntemp: 2
2025-05-15 05:37:52,956 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:52,956 kilosort.clustering_qr DEBUG    Cluster center: 70 of 96
2025-05-15 05:37:52,956 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:52,957 kilosort.clustering_qr DEBUG    CPU usage:    12.00 %
2025-05-15 05:37:52,957 kilosort.clustering_qr DEBUG    Memory:       18.03 %     |    136.02   /   754.60 GB
2025-05-15 05:37:52,957 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:52,957 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:52,957 kilosort.clustering_qr DEBUG    GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:52,957 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:52,957 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:52,957 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:52,959 kilosort.clustering_qr DEBUG    Center 70 | nsp: 2534 | ntemp: 2
2025-05-15 05:37:53,203 kilosort.clustering_qr DEBUG    Center 71 | nsp: 2270 | ntemp: 2
2025-05-15 05:37:53,446 kilosort.clustering_qr DEBUG    Center 72 | nsp: 2683 | ntemp: 2
2025-05-15 05:37:53,690 kilosort.clustering_qr DEBUG    Center 73 | nsp: 3521 | ntemp: 2
2025-05-15 05:37:53,936 kilosort.clustering_qr DEBUG    Center 74 | nsp: 3471 | ntemp: 2
2025-05-15 05:37:54,182 kilosort.clustering_qr DEBUG    Center 75 | nsp: 2541 | ntemp: 2
2025-05-15 05:37:54,425 kilosort.clustering_qr DEBUG    Center 76 | nsp: 3123 | ntemp: 2
2025-05-15 05:37:54,672 kilosort.clustering_qr DEBUG    Center 77 | nsp: 2866 | ntemp: 2
2025-05-15 05:37:54,923 kilosort.clustering_qr DEBUG    Center 78 | nsp: 2447 | ntemp: 2
2025-05-15 05:37:55,168 kilosort.clustering_qr DEBUG    Center 79 | nsp: 2188 | ntemp: 2
2025-05-15 05:37:55,410 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:55,410 kilosort.clustering_qr DEBUG    Cluster center: 80 of 96
2025-05-15 05:37:55,410 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:55,410 kilosort.clustering_qr DEBUG    CPU usage:    11.90 %
2025-05-15 05:37:55,410 kilosort.clustering_qr DEBUG    Memory:       18.03 %     |    136.02   /   754.60 GB
2025-05-15 05:37:55,410 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:55,410 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:55,410 kilosort.clustering_qr DEBUG    GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:55,411 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:55,411 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:55,411 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:55,412 kilosort.clustering_qr DEBUG    Center 80 | nsp: 1585 | ntemp: 1
2025-05-15 05:37:55,654 kilosort.clustering_qr DEBUG    Center 81 | nsp: 1150 | ntemp: 1
2025-05-15 05:37:55,894 kilosort.clustering_qr DEBUG    Center 82 | nsp: 1890 | ntemp: 2
2025-05-15 05:37:56,137 kilosort.clustering_qr DEBUG    Center 83 | nsp: 914 | ntemp: 1
2025-05-15 05:37:56,138 kilosort.clustering_qr DEBUG    Center 84 | nsp: 520 | ntemp: 1
2025-05-15 05:37:56,138 kilosort.clustering_qr DEBUG    Center 85 | nsp: 0 | ntemp: 0
2025-05-15 05:37:56,140 kilosort.clustering_qr DEBUG    Center 86 | nsp: 2139 | ntemp: 3
2025-05-15 05:37:56,383 kilosort.clustering_qr DEBUG    Center 87 | nsp: 2026 | ntemp: 2
2025-05-15 05:37:56,628 kilosort.clustering_qr DEBUG    Center 88 | nsp: 1921 | ntemp: 2
2025-05-15 05:37:56,872 kilosort.clustering_qr DEBUG    Center 89 | nsp: 1738 | ntemp: 2
2025-05-15 05:37:57,113 kilosort.clustering_qr DEBUG     
2025-05-15 05:37:57,113 kilosort.clustering_qr DEBUG    Cluster center: 90 of 96
2025-05-15 05:37:57,114 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:57,114 kilosort.clustering_qr DEBUG    CPU usage:    11.90 %
2025-05-15 05:37:57,114 kilosort.clustering_qr DEBUG    Memory:       18.03 %     |    136.02   /   754.60 GB
2025-05-15 05:37:57,114 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-15 05:37:57,114 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:57,114 kilosort.clustering_qr DEBUG    GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:57,114 kilosort.clustering_qr DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:57,114 kilosort.clustering_qr DEBUG    Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:57,114 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-15 05:37:57,116 kilosort.clustering_qr DEBUG    Center 90 | nsp: 1843 | ntemp: 2
2025-05-15 05:37:57,359 kilosort.clustering_qr DEBUG    Center 91 | nsp: 1188 | ntemp: 1
2025-05-15 05:37:57,600 kilosort.clustering_qr DEBUG    Center 92 | nsp: 1214 | ntemp: 1
2025-05-15 05:37:57,840 kilosort.clustering_qr DEBUG    Center 93 | nsp: 718 | ntemp: 1
2025-05-15 05:37:57,842 kilosort.clustering_qr DEBUG    Center 94 | nsp: 625 | ntemp: 1
2025-05-15 05:37:57,843 kilosort.clustering_qr DEBUG    Center 95 | nsp: 496 | ntemp: 1
2025-05-15 05:37:57,854 kilosort.run_kilosort INFO     268 clusters found, in  26.79s; total  154.98s
2025-05-15 05:37:57,858 kilosort.run_kilosort DEBUG    clu shape: (351411,)
2025-05-15 05:37:57,858 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([268, 374, 6])
2025-05-15 05:37:57,858 kilosort.run_kilosort INFO      
2025-05-15 05:37:57,859 kilosort.run_kilosort INFO     Merging clusters
2025-05-15 05:37:57,859 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-15 05:37:58,207 kilosort.run_kilosort INFO     257 units found, in  0.35s; total  155.34s
2025-05-15 05:37:58,208 kilosort.run_kilosort DEBUG    clu shape: (351411,)
2025-05-15 05:37:58,208 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([257, 374, 6])
2025-05-15 05:37:58,347 kilosort.run_kilosort INFO      
2025-05-15 05:37:58,348 kilosort.run_kilosort INFO     Resource usage after clustering
2025-05-15 05:37:58,348 kilosort.run_kilosort INFO     ********************************************************
2025-05-15 05:37:58,349 kilosort.run_kilosort INFO     CPU usage:    11.80 %
2025-05-15 05:37:58,349 kilosort.run_kilosort INFO     Memory:       18.02 %     |    136.00   /   754.60 GB
2025-05-15 05:37:58,350 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-15 05:37:58,350 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:58,351 kilosort.run_kilosort INFO     GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:58,351 kilosort.run_kilosort INFO     Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:58,352 kilosort.run_kilosort INFO     Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:58,352 kilosort.run_kilosort INFO     ********************************************************
2025-05-15 05:37:58,352 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  11186 KiB |   3361 MiB |  28316 GiB |  28316 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  11186 KiB |   3361 MiB |  28316 GiB |  28316 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  11183 KiB |   3359 MiB |  28304 GiB |  28304 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5226 MiB |   5226 MiB |   5226 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37965 KiB |   1749 MiB |  14766 GiB |  14766 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      12    |      45    |    2348 K  |    2348 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      12    |      45    |    2348 K  |    2348 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |      18    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      25    |     991 K  |     991 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-15 05:37:58,353 kilosort.run_kilosort INFO      
2025-05-15 05:37:58,353 kilosort.run_kilosort INFO     Saving to phy and computing refractory periods
2025-05-15 05:37:58,353 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-15 05:37:59,955 kilosort.run_kilosort INFO     89 units found with good refractory periods
2025-05-15 05:37:59,956 kilosort.run_kilosort INFO     Total runtime: 157.09s = 00:02:37 h:m:s
2025-05-15 05:37:59,969 kilosort.run_kilosort INFO     Sorting output saved in: /home/lss72/palmer_scratch/spike_sort/c42/kilosort4.
2025-05-15 05:37:59,970 kilosort.run_kilosort INFO      
2025-05-15 05:37:59,970 kilosort.run_kilosort INFO     Resource usage after saving
2025-05-15 05:37:59,970 kilosort.run_kilosort INFO     ********************************************************
2025-05-15 05:37:59,971 kilosort.run_kilosort INFO     CPU usage:    19.30 %
2025-05-15 05:37:59,971 kilosort.run_kilosort INFO     Memory:       18.03 %     |    136.08   /   754.60 GB
2025-05-15 05:37:59,972 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-15 05:37:59,972 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-15 05:37:59,973 kilosort.run_kilosort INFO     GPU memory:   53.65 %     |     21.19   /    39.50 GB
2025-05-15 05:37:59,973 kilosort.run_kilosort INFO     Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-15 05:37:59,974 kilosort.run_kilosort INFO     Max alloc:     8.31 %     |      3.28   /    39.50 GB
2025-05-15 05:37:59,974 kilosort.run_kilosort INFO     ********************************************************
2025-05-15 05:37:59,974 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  11186 KiB |   3361 MiB |  28316 GiB |  28316 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  11186 KiB |   3361 MiB |  28316 GiB |  28316 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  11183 KiB |   3359 MiB |  28304 GiB |  28304 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5226 MiB |   5226 MiB |   5226 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37965 KiB |   1749 MiB |  14766 GiB |  14766 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      12    |      45    |    2352 K  |    2352 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      12    |      45    |    2352 K  |    2352 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |      18    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      25    |     993 K  |     993 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


