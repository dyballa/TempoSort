2025-05-08 19:52:12,002 kilosort.run_kilosort INFO     Kilosort version 4.0.25
2025-05-08 19:52:12,028 kilosort.run_kilosort INFO     Python version 3.9.21
2025-05-08 19:52:12,029 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:52:12,029 kilosort.run_kilosort INFO     System information:
2025-05-08 19:52:12,029 kilosort.run_kilosort INFO     Linux-4.18.0-477.74.1.el8_8.x86_64-x86_64-with-glibc2.28 x86_64
2025-05-08 19:52:12,029 kilosort.run_kilosort INFO     x86_64
2025-05-08 19:52:12,030 kilosort.run_kilosort INFO     Using GPU for PyTorch computations. Specify `device` to change this.
2025-05-08 19:52:12,031 kilosort.run_kilosort INFO     Using CUDA device: NVIDIA A100-PCIE-40GB 39.50GB
2025-05-08 19:52:12,031 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:52:12,031 kilosort.run_kilosort INFO     Sorting /home/lss72/palmer_scratch/spike_sort/2014_11_13_Pair_3_0
2025-05-08 19:52:12,032 kilosort.run_kilosort DEBUG    Initial ops:

ops = {
    'n_chan_bin': 32,
    'fs': 30000,
    'batch_size': 60000,
    'nblocks': 1,
    'Th_universal': 9,
    'Th_learned': 8,
    'tmin': 0,
    'tmax': 30,
    'nt': 61,
    'shift': None,
    'scale': None,
    'artifact_threshold': inf,
    'nskip': 25,
    'whitening_range': 32,
    'highpass_cutoff': 300,
    'binning_depth': 5,
    'sig_interp': 20,
    'drift_smoothing': [0.5, 0.5, 0.5],
    'nt0min': 20,
    'dmin': None,
    'dminx': 32,
    'min_template_size': 10,
    'template_sizes': 5,
    'nearest_chans': 10,
    'nearest_templates': 100,
    'max_channel_distance': 32,
    'max_peels': 100,
    'templates_from_data': True,
    'n_templates': 6,
    'n_pcs': 6,
    'Th_single_ch': 6,
    'acg_threshold': 0.2,
    'ccg_threshold': 0.25,
    'cluster_downsampling': 20,
    'x_centers': None,
    'duplicate_spike_ms': 0.25,
    'position_limit': 100,
    'data_dir': PosixPath('/home/lss72/palmer_scratch/spike_sort'),
    'filename': PosixPath('/home/lss72/palmer_scratch/spike_sort/2014_11_13_Pair_3_0'),
    'data_dtype': dtype('uint16'),
    'do_CAR': True,
    'invert_sign': False,
    'NTbuff': 60122,
    'Nchan': 32,
    'duplicate_spike_bins': 7,
    'torch_device': 'cuda',
    'save_preprocessed_copy': False
}

2025-05-08 19:52:12,034 kilosort.run_kilosort DEBUG    Probe dictionary:

probe = {
    'chanMap': np.array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]),
    'xc': np.array([25.5, 25.5, 43.5, 43.5, 43.5, 43.5, 43.5, 43.5, 25.5, 25.5, 43.5,
       43.5, 43.5, 43.5, 25.5, 25.5, 25.5, 25.5,  7.5,  7.5,  7.5,  7.5,
       25.5, 25.5,  7.5,  7.5,  7.5,  7.5,  7.5,  7.5, 25.5, 25.5],
      dtype=np.float32),
    'yc': np.array([282.5, 232.5,  20. ,  45. ,  95. , 145. , 195. , 245. ,  82.5,
        32.5, 220. , 170. , 120. ,  70. , 132.5, 182.5, 157.5, 107.5,
        70. , 120. , 170. , 220. ,   7.5,  57.5, 245. , 195. , 145. ,
        95. ,  45. ,  20. , 207.5, 257.5], dtype=np.float32),
    'kcoords': np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]),
    'n_chan': 32
}

2025-05-08 19:52:12,034 kilosort.run_kilosort INFO      
2025-05-08 19:52:12,034 kilosort.run_kilosort INFO     Computing preprocessing variables.
2025-05-08 19:52:12,035 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:52:12,036 kilosort.run_kilosort INFO     N samples: 900000
2025-05-08 19:52:12,037 kilosort.run_kilosort INFO     N seconds: 30.0
2025-05-08 19:52:12,037 kilosort.run_kilosort INFO     N batches: 15
2025-05-08 19:52:12,074 kilosort.run_kilosort INFO     Preprocessing filters computed in  0.04s; total  0.04s
2025-05-08 19:52:12,075 kilosort.run_kilosort DEBUG    hp_filter shape: torch.Size([30122])
2025-05-08 19:52:12,075 kilosort.run_kilosort DEBUG    whiten_mat shape: torch.Size([32, 32])
2025-05-08 19:52:12,075 kilosort.run_kilosort INFO      
2025-05-08 19:52:12,075 kilosort.run_kilosort INFO     Resource usage after preprocessing
2025-05-08 19:52:12,075 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:52:12,076 kilosort.run_kilosort INFO     CPU usage:    10.30 %
2025-05-08 19:52:12,076 kilosort.run_kilosort INFO     Memory:       19.71 %     |    148.77   /   754.60 GB
2025-05-08 19:52:12,077 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 19:52:12,077 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:12,077 kilosort.run_kilosort INFO     GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:12,078 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:52:12,078 kilosort.run_kilosort INFO     Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:12,079 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:52:12,080 kilosort.run_kilosort INFO      
2025-05-08 19:52:12,080 kilosort.run_kilosort INFO     Computing drift correction.
2025-05-08 19:52:12,080 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:52:12,081 kilosort.spikedetect INFO     Re-computing universal templates from data.
2025-05-08 19:52:12,120 kilosort.spikedetect INFO     Number of universal templates: 135
2025-05-08 19:52:12,123 kilosort.spikedetect INFO     Detecting spikes...
2025-05-08 19:52:12,124 kilosort.spikedetect DEBUG     
2025-05-08 19:52:12,125 kilosort.spikedetect DEBUG    Batch 0
2025-05-08 19:52:12,125 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:52:12,125 kilosort.spikedetect DEBUG    CPU usage:    26.10 %
2025-05-08 19:52:12,125 kilosort.spikedetect DEBUG    Memory:       19.72 %     |    148.84   /   754.60 GB
2025-05-08 19:52:12,125 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-08 19:52:12,125 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:12,125 kilosort.spikedetect DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:12,126 kilosort.spikedetect DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:52:12,126 kilosort.spikedetect DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:12,126 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:52:12,623 kilosort.spikedetect DEBUG     
2025-05-08 19:52:12,623 kilosort.spikedetect DEBUG    Batch 14
2025-05-08 19:52:12,623 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:52:12,624 kilosort.spikedetect DEBUG    CPU usage:    13.00 %
2025-05-08 19:52:12,624 kilosort.spikedetect DEBUG    Memory:       19.83 %     |    149.63   /   754.60 GB
2025-05-08 19:52:12,624 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-08 19:52:12,624 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:12,624 kilosort.spikedetect DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:12,624 kilosort.spikedetect DEBUG    Allocated:     0.04 %     |      0.02   /    39.50 GB
2025-05-08 19:52:12,624 kilosort.spikedetect DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:12,624 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:52:12,695 kilosort.run_kilosort INFO     drift computed in  0.61s; total  0.66s
2025-05-08 19:52:12,698 kilosort.run_kilosort DEBUG    st shape: (5679, 6)
2025-05-08 19:52:12,698 kilosort.run_kilosort DEBUG    yblk shape: (1,)
2025-05-08 19:52:12,698 kilosort.run_kilosort DEBUG    dshift shape: (15, 1)
2025-05-08 19:52:12,698 kilosort.run_kilosort DEBUG    iKxx shape: torch.Size([32, 32])
2025-05-08 19:52:12,698 kilosort.run_kilosort INFO      
2025-05-08 19:52:12,699 kilosort.run_kilosort INFO     Resource usage after drift correction
2025-05-08 19:52:12,699 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:52:12,700 kilosort.run_kilosort INFO     CPU usage:    14.30 %
2025-05-08 19:52:12,700 kilosort.run_kilosort INFO     Memory:       19.84 %     |    149.75   /   754.60 GB
2025-05-08 19:52:12,701 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 19:52:12,701 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:12,701 kilosort.run_kilosort INFO     GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:12,702 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:52:12,702 kilosort.run_kilosort INFO     Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:12,703 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:52:12,703 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   8867 KiB | 310536 KiB | 379827 MiB | 379818 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   8867 KiB | 310536 KiB | 379827 MiB | 379818 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   8864 KiB | 310296 KiB | 375739 MiB | 375730 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 479232 KiB | 479232 KiB | 479232 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  13660 KiB | 184425 KiB | 202897 MiB | 202883 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      20    |      56    |   61569    |   61549    |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |      56    |   61569    |   61549    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      11    |      25    |   21984    |   21973    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-08 19:52:12,711 kilosort.run_kilosort DEBUG    First batch min, max: (-20.231596, 13.883576)
2025-05-08 19:52:12,711 kilosort.run_kilosort INFO      
2025-05-08 19:52:12,712 kilosort.run_kilosort INFO     Extracting spikes using templates
2025-05-08 19:52:12,712 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:52:12,712 kilosort.spikedetect INFO     Re-computing universal templates from data.
2025-05-08 19:52:12,756 kilosort.spikedetect INFO     Number of universal templates: 135
2025-05-08 19:52:12,758 kilosort.spikedetect INFO     Detecting spikes...
2025-05-08 19:52:12,760 kilosort.spikedetect DEBUG     
2025-05-08 19:52:12,760 kilosort.spikedetect DEBUG    Batch 0
2025-05-08 19:52:12,760 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:52:12,760 kilosort.spikedetect DEBUG    CPU usage:    25.90 %
2025-05-08 19:52:12,760 kilosort.spikedetect DEBUG    Memory:       19.86 %     |    149.85   /   754.60 GB
2025-05-08 19:52:12,760 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-08 19:52:12,761 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:12,761 kilosort.spikedetect DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:12,761 kilosort.spikedetect DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:52:12,761 kilosort.spikedetect DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:12,761 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:52:13,200 kilosort.spikedetect DEBUG     
2025-05-08 19:52:13,200 kilosort.spikedetect DEBUG    Batch 14
2025-05-08 19:52:13,200 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:52:13,200 kilosort.spikedetect DEBUG    CPU usage:    13.20 %
2025-05-08 19:52:13,200 kilosort.spikedetect DEBUG    Memory:       19.38 %     |    146.26   /   754.60 GB
2025-05-08 19:52:13,200 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-08 19:52:13,200 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:13,200 kilosort.spikedetect DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:13,201 kilosort.spikedetect DEBUG    Allocated:     0.04 %     |      0.02   /    39.50 GB
2025-05-08 19:52:13,201 kilosort.spikedetect DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:13,201 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:52:13,201 kilosort.run_kilosort INFO     5562 spikes extracted in  0.49s; total  1.17s
2025-05-08 19:52:13,201 kilosort.run_kilosort DEBUG    st0 shape: (5562, 6)
2025-05-08 19:52:13,201 kilosort.run_kilosort DEBUG    tF shape: torch.Size([5562, 10, 6])
2025-05-08 19:52:13,201 kilosort.run_kilosort INFO      
2025-05-08 19:52:13,201 kilosort.run_kilosort INFO     First clustering
2025-05-08 19:52:13,202 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:52:13,208 kilosort.clustering_qr DEBUG     
2025-05-08 19:52:13,208 kilosort.clustering_qr DEBUG    Cluster center: 0 of 12
2025-05-08 19:52:13,208 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:52:13,208 kilosort.clustering_qr DEBUG    CPU usage:    13.80 %
2025-05-08 19:52:13,208 kilosort.clustering_qr DEBUG    Memory:       19.38 %     |    146.26   /   754.60 GB
2025-05-08 19:52:13,208 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-08 19:52:13,208 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:13,208 kilosort.clustering_qr DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:13,208 kilosort.clustering_qr DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:52:13,209 kilosort.clustering_qr DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:13,209 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:52:13,211 kilosort.clustering_qr DEBUG    Center 0 | nsp: 685 | ntemp: 12
2025-05-08 19:52:13,213 kilosort.clustering_qr DEBUG    Center 1 | nsp: 755 | ntemp: 12
2025-05-08 19:52:13,216 kilosort.clustering_qr DEBUG    Center 2 | nsp: 490 | ntemp: 12
2025-05-08 19:52:13,219 kilosort.clustering_qr DEBUG    Center 3 | nsp: 795 | ntemp: 12
2025-05-08 19:52:13,222 kilosort.clustering_qr DEBUG    Center 4 | nsp: 178 | ntemp: 12
2025-05-08 19:52:13,224 kilosort.clustering_qr DEBUG    Center 5 | nsp: 359 | ntemp: 12
2025-05-08 19:52:13,226 kilosort.clustering_qr DEBUG    Center 6 | nsp: 169 | ntemp: 12
2025-05-08 19:52:13,228 kilosort.clustering_qr DEBUG    Center 7 | nsp: 559 | ntemp: 12
2025-05-08 19:52:13,231 kilosort.clustering_qr DEBUG    Center 8 | nsp: 441 | ntemp: 12
2025-05-08 19:52:13,233 kilosort.clustering_qr DEBUG    Center 9 | nsp: 430 | ntemp: 12
2025-05-08 19:52:13,233 kilosort.clustering_qr DEBUG     
2025-05-08 19:52:13,233 kilosort.clustering_qr DEBUG    Cluster center: 10 of 12
2025-05-08 19:52:13,234 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:52:13,234 kilosort.clustering_qr DEBUG    CPU usage:    34.80 %
2025-05-08 19:52:13,234 kilosort.clustering_qr DEBUG    Memory:       19.38 %     |    146.26   /   754.60 GB
2025-05-08 19:52:13,234 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-08 19:52:13,234 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:13,234 kilosort.clustering_qr DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:13,234 kilosort.clustering_qr DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:52:13,234 kilosort.clustering_qr DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:13,234 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:52:13,236 kilosort.clustering_qr DEBUG    Center 10 | nsp: 409 | ntemp: 12
2025-05-08 19:52:13,238 kilosort.clustering_qr DEBUG    Center 11 | nsp: 292 | ntemp: 3
2025-05-08 19:52:13,251 kilosort.run_kilosort INFO     12 clusters found, in  0.05s; total  1.22s
2025-05-08 19:52:13,252 kilosort.run_kilosort DEBUG    clu shape: (5562,)
2025-05-08 19:52:13,252 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([12, 32, 6])
2025-05-08 19:52:13,252 kilosort.run_kilosort INFO      
2025-05-08 19:52:13,252 kilosort.run_kilosort INFO     Extracting spikes using cluster waveforms
2025-05-08 19:52:13,252 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:52:13,269 kilosort.template_matching DEBUG     
2025-05-08 19:52:13,269 kilosort.template_matching DEBUG    Batch 0
2025-05-08 19:52:13,269 kilosort.template_matching DEBUG    ********************************************************
2025-05-08 19:52:13,269 kilosort.template_matching DEBUG    CPU usage:    27.30 %
2025-05-08 19:52:13,269 kilosort.template_matching DEBUG    Memory:       19.41 %     |    146.49   /   754.60 GB
2025-05-08 19:52:13,269 kilosort.template_matching DEBUG    ------------------------------------------------------
2025-05-08 19:52:13,269 kilosort.template_matching DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:13,269 kilosort.template_matching DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:13,269 kilosort.template_matching DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:52:13,270 kilosort.template_matching DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:13,270 kilosort.template_matching DEBUG    ********************************************************
2025-05-08 19:52:13,556 kilosort.template_matching DEBUG     
2025-05-08 19:52:13,557 kilosort.template_matching DEBUG    Batch 14
2025-05-08 19:52:13,557 kilosort.template_matching DEBUG    ********************************************************
2025-05-08 19:52:13,557 kilosort.template_matching DEBUG    CPU usage:    14.90 %
2025-05-08 19:52:13,557 kilosort.template_matching DEBUG    Memory:       19.41 %     |    146.49   /   754.60 GB
2025-05-08 19:52:13,557 kilosort.template_matching DEBUG    ------------------------------------------------------
2025-05-08 19:52:13,557 kilosort.template_matching DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:13,557 kilosort.template_matching DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:13,557 kilosort.template_matching DEBUG    Allocated:     0.06 %     |      0.02   /    39.50 GB
2025-05-08 19:52:13,557 kilosort.template_matching DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:13,557 kilosort.template_matching DEBUG    ********************************************************
2025-05-08 19:52:13,559 kilosort.run_kilosort INFO     7155 spikes extracted in  0.31s; total  1.53s
2025-05-08 19:52:13,563 kilosort.run_kilosort DEBUG    st shape: (7155, 3)
2025-05-08 19:52:13,563 kilosort.run_kilosort DEBUG    tF shape: torch.Size([7155, 10, 6])
2025-05-08 19:52:13,563 kilosort.run_kilosort DEBUG    iCC shape: torch.Size([10, 32])
2025-05-08 19:52:13,563 kilosort.run_kilosort DEBUG    iU shape: torch.Size([12])
2025-05-08 19:52:13,563 kilosort.run_kilosort INFO      
2025-05-08 19:52:13,563 kilosort.run_kilosort INFO     Resource usage after spike detection
2025-05-08 19:52:13,563 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:52:13,564 kilosort.run_kilosort INFO     CPU usage:    26.90 %
2025-05-08 19:52:13,564 kilosort.run_kilosort INFO     Memory:       19.38 %     |    146.26   /   754.60 GB
2025-05-08 19:52:13,565 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 19:52:13,565 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:13,565 kilosort.run_kilosort INFO     GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:13,566 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:52:13,566 kilosort.run_kilosort INFO     Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:13,567 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:52:13,568 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   8880 KiB | 310536 KiB | 505097 MiB | 505089 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   8880 KiB | 310536 KiB | 505097 MiB | 505089 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   8876 KiB | 310296 KiB | 499601 MiB | 499593 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 479232 KiB | 479232 KiB | 479232 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  13648 KiB | 184425 KiB | 266133 MiB | 266120 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      24    |      56    |   80938    |   80914    |
|---------------------------------------------------------------------------|
| Active allocs         |      24    |      56    |   80938    |   80914    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      12    |      25    |   29044    |   29032    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-08 19:52:13,568 kilosort.run_kilosort INFO      
2025-05-08 19:52:13,568 kilosort.run_kilosort INFO     Final clustering
2025-05-08 19:52:13,569 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:52:13,578 kilosort.clustering_qr DEBUG     
2025-05-08 19:52:13,578 kilosort.clustering_qr DEBUG    Cluster center: 0 of 12
2025-05-08 19:52:13,578 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:52:13,579 kilosort.clustering_qr DEBUG    CPU usage:    22.60 %
2025-05-08 19:52:13,579 kilosort.clustering_qr DEBUG    Memory:       19.38 %     |    146.26   /   754.60 GB
2025-05-08 19:52:13,579 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-08 19:52:13,579 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:13,579 kilosort.clustering_qr DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:13,579 kilosort.clustering_qr DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:52:13,579 kilosort.clustering_qr DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:13,579 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:52:13,580 kilosort.clustering_qr DEBUG    Center 0 | nsp: 1036 | ntemp: 1
2025-05-08 19:52:14,199 kilosort.clustering_qr DEBUG    Center 1 | nsp: 839 | ntemp: 1
2025-05-08 19:52:14,200 kilosort.clustering_qr DEBUG    Center 2 | nsp: 860 | ntemp: 1
2025-05-08 19:52:14,200 kilosort.clustering_qr DEBUG    Center 3 | nsp: 0 | ntemp: 0
2025-05-08 19:52:14,201 kilosort.clustering_qr DEBUG    Center 4 | nsp: 1002 | ntemp: 2
2025-05-08 19:52:14,548 kilosort.clustering_qr DEBUG    Center 5 | nsp: 538 | ntemp: 1
2025-05-08 19:52:14,549 kilosort.clustering_qr DEBUG    Center 6 | nsp: 227 | ntemp: 1
2025-05-08 19:52:14,549 kilosort.clustering_qr DEBUG    Center 7 | nsp: 0 | ntemp: 0
2025-05-08 19:52:14,550 kilosort.clustering_qr DEBUG    Center 8 | nsp: 1118 | ntemp: 2
2025-05-08 19:52:14,913 kilosort.clustering_qr DEBUG    Center 9 | nsp: 650 | ntemp: 1
2025-05-08 19:52:14,914 kilosort.clustering_qr DEBUG     
2025-05-08 19:52:14,914 kilosort.clustering_qr DEBUG    Cluster center: 10 of 12
2025-05-08 19:52:14,914 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:52:14,914 kilosort.clustering_qr DEBUG    CPU usage:    19.50 %
2025-05-08 19:52:14,914 kilosort.clustering_qr DEBUG    Memory:       19.56 %     |    147.59   /   754.60 GB
2025-05-08 19:52:14,914 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-08 19:52:14,914 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:14,914 kilosort.clustering_qr DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:14,915 kilosort.clustering_qr DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:52:14,915 kilosort.clustering_qr DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:14,915 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:52:14,916 kilosort.clustering_qr DEBUG    Center 10 | nsp: 264 | ntemp: 1
2025-05-08 19:52:14,916 kilosort.clustering_qr DEBUG    Center 11 | nsp: 621 | ntemp: 1
2025-05-08 19:52:14,918 kilosort.run_kilosort INFO     18 clusters found, in  1.35s; total  2.89s
2025-05-08 19:52:14,919 kilosort.run_kilosort DEBUG    clu shape: (7155,)
2025-05-08 19:52:14,919 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([18, 32, 6])
2025-05-08 19:52:14,919 kilosort.run_kilosort INFO      
2025-05-08 19:52:14,919 kilosort.run_kilosort INFO     Merging clusters
2025-05-08 19:52:14,920 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:52:14,929 kilosort.run_kilosort INFO     18 units found, in  0.01s; total  2.90s
2025-05-08 19:52:14,929 kilosort.run_kilosort DEBUG    clu shape: (7155,)
2025-05-08 19:52:14,930 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([18, 32, 6])
2025-05-08 19:52:14,930 kilosort.run_kilosort INFO      
2025-05-08 19:52:14,930 kilosort.run_kilosort INFO     Resource usage after clustering
2025-05-08 19:52:14,930 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:52:14,931 kilosort.run_kilosort INFO     CPU usage:    23.70 %
2025-05-08 19:52:14,931 kilosort.run_kilosort INFO     Memory:       19.56 %     |    147.61   /   754.60 GB
2025-05-08 19:52:14,932 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 19:52:14,932 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:14,933 kilosort.run_kilosort INFO     GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:14,933 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:52:14,933 kilosort.run_kilosort INFO     Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:14,934 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:52:14,934 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   8871 KiB | 310536 KiB | 508999 MiB | 508991 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   8871 KiB | 310536 KiB | 508999 MiB | 508991 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   8867 KiB | 310296 KiB | 503493 MiB | 503484 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 479232 KiB | 479232 KiB | 479232 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  13657 KiB | 184425 KiB | 272119 MiB | 272106 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      23    |      56    |  117857    |  117834    |
|---------------------------------------------------------------------------|
| Active allocs         |      23    |      56    |  117857    |  117834    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      12    |      25    |   50116    |   50104    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-08 19:52:14,935 kilosort.run_kilosort INFO      
2025-05-08 19:52:14,935 kilosort.run_kilosort INFO     Saving to phy and computing refractory periods
2025-05-08 19:52:14,935 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:52:15,295 kilosort.run_kilosort INFO     4 units found with good refractory periods
2025-05-08 19:52:15,296 kilosort.run_kilosort INFO     Total runtime: 3.26s = 00:00:3 h:m:s
2025-05-08 19:52:15,310 kilosort.run_kilosort INFO     Sorting output saved in: /home/lss72/palmer_scratch/spike_sort/kilosort4.
2025-05-08 19:52:15,310 kilosort.run_kilosort INFO      
2025-05-08 19:52:15,311 kilosort.run_kilosort INFO     Resource usage after saving
2025-05-08 19:52:15,311 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:52:15,312 kilosort.run_kilosort INFO     CPU usage:    13.20 %
2025-05-08 19:52:15,312 kilosort.run_kilosort INFO     Memory:       19.62 %     |    148.03   /   754.60 GB
2025-05-08 19:52:15,312 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 19:52:15,313 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:52:15,313 kilosort.run_kilosort INFO     GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 19:52:15,314 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:52:15,314 kilosort.run_kilosort INFO     Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:52:15,314 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:52:15,315 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   8871 KiB | 310536 KiB | 509001 MiB | 508993 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   8871 KiB | 310536 KiB | 509001 MiB | 508993 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   8867 KiB | 310296 KiB | 503495 MiB | 503486 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 479232 KiB | 479232 KiB | 479232 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  13657 KiB | 184425 KiB | 272121 MiB | 272108 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      23    |      56    |  118128    |  118105    |
|---------------------------------------------------------------------------|
| Active allocs         |      23    |      56    |  118128    |  118105    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      12    |      25    |   50285    |   50273    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


