2025-05-08 20:59:26,631 kilosort.run_kilosort INFO     Kilosort version 4.0.25
2025-05-08 20:59:26,640 kilosort.run_kilosort INFO     Python version 3.9.21
2025-05-08 20:59:26,640 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 20:59:26,640 kilosort.run_kilosort INFO     System information:
2025-05-08 20:59:26,641 kilosort.run_kilosort INFO     Linux-4.18.0-477.74.1.el8_8.x86_64-x86_64-with-glibc2.28 x86_64
2025-05-08 20:59:26,641 kilosort.run_kilosort INFO     x86_64
2025-05-08 20:59:26,642 kilosort.run_kilosort INFO     Using GPU for PyTorch computations. Specify `device` to change this.
2025-05-08 20:59:26,642 kilosort.run_kilosort INFO     Using CUDA device: NVIDIA A100-PCIE-40GB 39.50GB
2025-05-08 20:59:26,642 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 20:59:26,643 kilosort.run_kilosort INFO     Sorting /home/lss72/palmer_scratch/spike_sort/2014_11_13_Pair_3_0
2025-05-08 20:59:26,643 kilosort.run_kilosort DEBUG    Initial ops:

ops = {
    'n_chan_bin': 32,
    'fs': 30000,
    'batch_size': 60000,
    'nblocks': 1,
    'Th_universal': 9,
    'Th_learned': 8,
    'tmin': 0,
    'tmax': 600,
    'nt': 61,
    'shift': None,
    'scale': None,
    'artifact_threshold': inf,
    'nskip': 25,
    'whitening_range': 32,
    'highpass_cutoff': 300,
    'binning_depth': 5,
    'sig_interp': 20,
    'drift_smoothing': [0.5, 0.5, 0.5],
    'nt0min': 20,
    'dmin': None,
    'dminx': 32,
    'min_template_size': 10,
    'template_sizes': 5,
    'nearest_chans': 10,
    'nearest_templates': 100,
    'max_channel_distance': 32,
    'max_peels': 100,
    'templates_from_data': True,
    'n_templates': 6,
    'n_pcs': 6,
    'Th_single_ch': 6,
    'acg_threshold': 0.2,
    'ccg_threshold': 0.25,
    'cluster_downsampling': 20,
    'x_centers': None,
    'duplicate_spike_ms': 0.25,
    'position_limit': 100,
    'data_dir': PosixPath('/home/lss72/palmer_scratch/spike_sort'),
    'filename': PosixPath('/home/lss72/palmer_scratch/spike_sort/2014_11_13_Pair_3_0'),
    'data_dtype': dtype('uint16'),
    'do_CAR': True,
    'invert_sign': False,
    'NTbuff': 60122,
    'Nchan': 32,
    'duplicate_spike_bins': 7,
    'torch_device': 'cuda',
    'save_preprocessed_copy': False
}

2025-05-08 20:59:26,645 kilosort.run_kilosort DEBUG    Probe dictionary:

probe = {
    'chanMap': np.array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]),
    'xc': np.array([25.5, 25.5, 43.5, 43.5, 43.5, 43.5, 43.5, 43.5, 25.5, 25.5, 43.5,
       43.5, 43.5, 43.5, 25.5, 25.5, 25.5, 25.5,  7.5,  7.5,  7.5,  7.5,
       25.5, 25.5,  7.5,  7.5,  7.5,  7.5,  7.5,  7.5, 25.5, 25.5],
      dtype=np.float32),
    'yc': np.array([282.5, 232.5,  20. ,  45. ,  95. , 145. , 195. , 245. ,  82.5,
        32.5, 220. , 170. , 120. ,  70. , 132.5, 182.5, 157.5, 107.5,
        70. , 120. , 170. , 220. ,   7.5,  57.5, 245. , 195. , 145. ,
        95. ,  45. ,  20. , 207.5, 257.5], dtype=np.float32),
    'kcoords': np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]),
    'n_chan': 32
}

2025-05-08 20:59:26,645 kilosort.run_kilosort INFO      
2025-05-08 20:59:26,646 kilosort.run_kilosort INFO     Computing preprocessing variables.
2025-05-08 20:59:26,646 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 20:59:26,648 kilosort.run_kilosort INFO     N samples: 7842600
2025-05-08 20:59:26,648 kilosort.run_kilosort INFO     N seconds: 261.42
2025-05-08 20:59:26,649 kilosort.run_kilosort INFO     N batches: 131
2025-05-08 20:59:26,705 kilosort.run_kilosort INFO     Preprocessing filters computed in  0.06s; total  0.06s
2025-05-08 20:59:26,706 kilosort.run_kilosort DEBUG    hp_filter shape: torch.Size([30122])
2025-05-08 20:59:26,706 kilosort.run_kilosort DEBUG    whiten_mat shape: torch.Size([32, 32])
2025-05-08 20:59:26,706 kilosort.run_kilosort INFO      
2025-05-08 20:59:26,706 kilosort.run_kilosort INFO     Resource usage after preprocessing
2025-05-08 20:59:26,707 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 20:59:26,707 kilosort.run_kilosort INFO     CPU usage:    12.10 %
2025-05-08 20:59:26,708 kilosort.run_kilosort INFO     Memory:       28.05 %     |    211.69   /   754.60 GB
2025-05-08 20:59:26,708 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 20:59:26,708 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:26,709 kilosort.run_kilosort INFO     GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:26,709 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 20:59:26,710 kilosort.run_kilosort INFO     Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:26,710 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 20:59:26,730 kilosort.run_kilosort INFO      
2025-05-08 20:59:26,731 kilosort.run_kilosort INFO     Computing drift correction.
2025-05-08 20:59:26,731 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 20:59:26,731 kilosort.spikedetect INFO     Re-computing universal templates from data.
2025-05-08 20:59:26,985 kilosort.spikedetect INFO     Number of universal templates: 135
2025-05-08 20:59:26,997 kilosort.spikedetect INFO     Detecting spikes...
2025-05-08 20:59:26,998 kilosort.spikedetect DEBUG     
2025-05-08 20:59:26,998 kilosort.spikedetect DEBUG    Batch 0
2025-05-08 20:59:26,998 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 20:59:26,998 kilosort.spikedetect DEBUG    CPU usage:    29.20 %
2025-05-08 20:59:26,999 kilosort.spikedetect DEBUG    Memory:       28.10 %     |    212.01   /   754.60 GB
2025-05-08 20:59:26,999 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-08 20:59:26,999 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:26,999 kilosort.spikedetect DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:26,999 kilosort.spikedetect DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 20:59:26,999 kilosort.spikedetect DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:26,999 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 20:59:30,851 kilosort.spikedetect DEBUG     
2025-05-08 20:59:30,851 kilosort.spikedetect DEBUG    Batch 130
2025-05-08 20:59:30,851 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 20:59:30,851 kilosort.spikedetect DEBUG    CPU usage:    16.00 %
2025-05-08 20:59:30,851 kilosort.spikedetect DEBUG    Memory:       22.02 %     |    166.16   /   754.60 GB
2025-05-08 20:59:30,851 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-08 20:59:30,851 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:30,851 kilosort.spikedetect DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:30,852 kilosort.spikedetect DEBUG    Allocated:     0.04 %     |      0.02   /    39.50 GB
2025-05-08 20:59:30,852 kilosort.spikedetect DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:30,852 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 20:59:30,944 kilosort.run_kilosort INFO     drift computed in  4.21s; total  4.30s
2025-05-08 20:59:30,945 kilosort.run_kilosort DEBUG    st shape: (50072, 6)
2025-05-08 20:59:30,945 kilosort.run_kilosort DEBUG    yblk shape: (1,)
2025-05-08 20:59:30,946 kilosort.run_kilosort DEBUG    dshift shape: (131, 1)
2025-05-08 20:59:30,946 kilosort.run_kilosort DEBUG    iKxx shape: torch.Size([32, 32])
2025-05-08 20:59:30,946 kilosort.run_kilosort INFO      
2025-05-08 20:59:30,946 kilosort.run_kilosort INFO     Resource usage after drift correction
2025-05-08 20:59:30,946 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 20:59:30,947 kilosort.run_kilosort INFO     CPU usage:    18.30 %
2025-05-08 20:59:30,948 kilosort.run_kilosort INFO     Memory:       22.05 %     |    166.38   /   754.60 GB
2025-05-08 20:59:30,948 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 20:59:30,948 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:30,949 kilosort.run_kilosort INFO     GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:30,949 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 20:59:30,950 kilosort.run_kilosort INFO     Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:30,951 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 20:59:30,951 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   8868 KiB | 311375 KiB |   4785 GiB |   4785 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   8868 KiB | 311375 KiB |   4785 GiB |   4785 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   8865 KiB | 310444 KiB |   4734 GiB |   4734 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 479232 KiB | 479232 KiB | 479232 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  13660 KiB | 184425 KiB |   2786 GiB |   2786 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      20    |      56    |    1178 K  |    1178 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |      56    |    1178 K  |    1178 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      12    |      27    |  509747    |  509735    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-08 20:59:30,959 kilosort.run_kilosort DEBUG    First batch min, max: (-20.590961, 13.992555)
2025-05-08 20:59:30,959 kilosort.run_kilosort INFO      
2025-05-08 20:59:30,959 kilosort.run_kilosort INFO     Extracting spikes using templates
2025-05-08 20:59:30,959 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 20:59:30,960 kilosort.spikedetect INFO     Re-computing universal templates from data.
2025-05-08 20:59:31,179 kilosort.spikedetect INFO     Number of universal templates: 135
2025-05-08 20:59:31,181 kilosort.spikedetect INFO     Detecting spikes...
2025-05-08 20:59:31,182 kilosort.spikedetect DEBUG     
2025-05-08 20:59:31,183 kilosort.spikedetect DEBUG    Batch 0
2025-05-08 20:59:31,183 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 20:59:31,183 kilosort.spikedetect DEBUG    CPU usage:    33.50 %
2025-05-08 20:59:31,183 kilosort.spikedetect DEBUG    Memory:       22.13 %     |    166.98   /   754.60 GB
2025-05-08 20:59:31,183 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-08 20:59:31,183 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:31,183 kilosort.spikedetect DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:31,183 kilosort.spikedetect DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 20:59:31,183 kilosort.spikedetect DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:31,183 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 20:59:34,983 kilosort.spikedetect DEBUG     
2025-05-08 20:59:34,984 kilosort.spikedetect DEBUG    Batch 130
2025-05-08 20:59:34,984 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 20:59:34,984 kilosort.spikedetect DEBUG    CPU usage:    15.90 %
2025-05-08 20:59:34,984 kilosort.spikedetect DEBUG    Memory:       22.15 %     |    167.11   /   754.60 GB
2025-05-08 20:59:34,984 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-08 20:59:34,984 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:34,984 kilosort.spikedetect DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:34,984 kilosort.spikedetect DEBUG    Allocated:     0.04 %     |      0.02   /    39.50 GB
2025-05-08 20:59:34,985 kilosort.spikedetect DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:34,985 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 20:59:34,985 kilosort.run_kilosort INFO     50117 spikes extracted in  4.03s; total  8.34s
2025-05-08 20:59:34,985 kilosort.run_kilosort DEBUG    st0 shape: (50117, 6)
2025-05-08 20:59:34,985 kilosort.run_kilosort DEBUG    tF shape: torch.Size([50117, 10, 6])
2025-05-08 20:59:34,985 kilosort.run_kilosort INFO      
2025-05-08 20:59:34,985 kilosort.run_kilosort INFO     First clustering
2025-05-08 20:59:34,986 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 20:59:34,995 kilosort.clustering_qr DEBUG     
2025-05-08 20:59:34,995 kilosort.clustering_qr DEBUG    Cluster center: 0 of 12
2025-05-08 20:59:34,995 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 20:59:34,996 kilosort.clustering_qr DEBUG    CPU usage:    24.40 %
2025-05-08 20:59:34,996 kilosort.clustering_qr DEBUG    Memory:       22.15 %     |    167.13   /   754.60 GB
2025-05-08 20:59:34,996 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-08 20:59:34,996 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:34,996 kilosort.clustering_qr DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:34,996 kilosort.clustering_qr DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 20:59:34,996 kilosort.clustering_qr DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:34,996 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 20:59:34,999 kilosort.clustering_qr DEBUG    Center 0 | nsp: 6236 | ntemp: 12
2025-05-08 20:59:35,278 kilosort.clustering_qr DEBUG    Center 1 | nsp: 6460 | ntemp: 12
2025-05-08 20:59:35,704 kilosort.clustering_qr DEBUG    Center 2 | nsp: 3959 | ntemp: 12
2025-05-08 20:59:36,066 kilosort.clustering_qr DEBUG    Center 3 | nsp: 6605 | ntemp: 12
2025-05-08 20:59:36,372 kilosort.clustering_qr DEBUG    Center 4 | nsp: 2042 | ntemp: 12
2025-05-08 20:59:36,624 kilosort.clustering_qr DEBUG    Center 5 | nsp: 3124 | ntemp: 12
2025-05-08 20:59:36,987 kilosort.clustering_qr DEBUG    Center 6 | nsp: 1646 | ntemp: 12
2025-05-08 20:59:37,358 kilosort.clustering_qr DEBUG    Center 7 | nsp: 5196 | ntemp: 12
2025-05-08 20:59:37,666 kilosort.clustering_qr DEBUG    Center 8 | nsp: 4570 | ntemp: 12
2025-05-08 20:59:37,928 kilosort.clustering_qr DEBUG    Center 9 | nsp: 3499 | ntemp: 12
2025-05-08 20:59:38,276 kilosort.clustering_qr DEBUG     
2025-05-08 20:59:38,276 kilosort.clustering_qr DEBUG    Cluster center: 10 of 12
2025-05-08 20:59:38,276 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 20:59:38,277 kilosort.clustering_qr DEBUG    CPU usage:    25.50 %
2025-05-08 20:59:38,277 kilosort.clustering_qr DEBUG    Memory:       21.37 %     |    161.28   /   754.60 GB
2025-05-08 20:59:38,277 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-08 20:59:38,277 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:38,277 kilosort.clustering_qr DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:38,278 kilosort.clustering_qr DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 20:59:38,278 kilosort.clustering_qr DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:38,278 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 20:59:38,280 kilosort.clustering_qr DEBUG    Center 10 | nsp: 4083 | ntemp: 12
2025-05-08 20:59:38,670 kilosort.clustering_qr DEBUG    Center 11 | nsp: 2697 | ntemp: 3
2025-05-08 20:59:39,114 kilosort.run_kilosort INFO     87 clusters found, in  4.13s; total  12.47s
2025-05-08 20:59:39,114 kilosort.run_kilosort DEBUG    clu shape: (50117,)
2025-05-08 20:59:39,114 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([87, 32, 6])
2025-05-08 20:59:39,114 kilosort.run_kilosort INFO      
2025-05-08 20:59:39,115 kilosort.run_kilosort INFO     Extracting spikes using cluster waveforms
2025-05-08 20:59:39,115 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 20:59:39,131 kilosort.template_matching DEBUG     
2025-05-08 20:59:39,131 kilosort.template_matching DEBUG    Batch 0
2025-05-08 20:59:39,131 kilosort.template_matching DEBUG    ********************************************************
2025-05-08 20:59:39,131 kilosort.template_matching DEBUG    CPU usage:    25.50 %
2025-05-08 20:59:39,131 kilosort.template_matching DEBUG    Memory:       21.62 %     |    163.16   /   754.60 GB
2025-05-08 20:59:39,131 kilosort.template_matching DEBUG    ------------------------------------------------------
2025-05-08 20:59:39,132 kilosort.template_matching DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:39,132 kilosort.template_matching DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:39,132 kilosort.template_matching DEBUG    Allocated:     0.03 %     |      0.01   /    39.50 GB
2025-05-08 20:59:39,132 kilosort.template_matching DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:39,132 kilosort.template_matching DEBUG    ********************************************************
2025-05-08 20:59:41,800 kilosort.template_matching DEBUG     
2025-05-08 20:59:41,800 kilosort.template_matching DEBUG    Batch 100
2025-05-08 20:59:41,800 kilosort.template_matching DEBUG    ********************************************************
2025-05-08 20:59:41,800 kilosort.template_matching DEBUG    CPU usage:    20.00 %
2025-05-08 20:59:41,800 kilosort.template_matching DEBUG    Memory:       21.65 %     |    163.37   /   754.60 GB
2025-05-08 20:59:41,800 kilosort.template_matching DEBUG    ------------------------------------------------------
2025-05-08 20:59:41,800 kilosort.template_matching DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:41,800 kilosort.template_matching DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:41,800 kilosort.template_matching DEBUG    Allocated:     0.07 %     |      0.03   /    39.50 GB
2025-05-08 20:59:41,801 kilosort.template_matching DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:41,801 kilosort.template_matching DEBUG    ********************************************************
2025-05-08 20:59:42,604 kilosort.template_matching DEBUG     
2025-05-08 20:59:42,605 kilosort.template_matching DEBUG    Batch 130
2025-05-08 20:59:42,605 kilosort.template_matching DEBUG    ********************************************************
2025-05-08 20:59:42,605 kilosort.template_matching DEBUG    CPU usage:    20.00 %
2025-05-08 20:59:42,605 kilosort.template_matching DEBUG    Memory:       21.85 %     |    164.90   /   754.60 GB
2025-05-08 20:59:42,605 kilosort.template_matching DEBUG    ------------------------------------------------------
2025-05-08 20:59:42,605 kilosort.template_matching DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:42,605 kilosort.template_matching DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:42,605 kilosort.template_matching DEBUG    Allocated:     0.07 %     |      0.03   /    39.50 GB
2025-05-08 20:59:42,606 kilosort.template_matching DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:42,606 kilosort.template_matching DEBUG    ********************************************************
2025-05-08 20:59:42,613 kilosort.run_kilosort INFO     109655 spikes extracted in  3.50s; total  15.97s
2025-05-08 20:59:42,617 kilosort.run_kilosort DEBUG    st shape: (109655, 3)
2025-05-08 20:59:42,617 kilosort.run_kilosort DEBUG    tF shape: torch.Size([109655, 10, 6])
2025-05-08 20:59:42,617 kilosort.run_kilosort DEBUG    iCC shape: torch.Size([10, 32])
2025-05-08 20:59:42,617 kilosort.run_kilosort DEBUG    iU shape: torch.Size([70])
2025-05-08 20:59:42,617 kilosort.run_kilosort INFO      
2025-05-08 20:59:42,617 kilosort.run_kilosort INFO     Resource usage after spike detection
2025-05-08 20:59:42,618 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 20:59:42,618 kilosort.run_kilosort INFO     CPU usage:    27.10 %
2025-05-08 20:59:42,619 kilosort.run_kilosort INFO     Memory:       21.83 %     |    164.70   /   754.60 GB
2025-05-08 20:59:42,619 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 20:59:42,619 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:42,620 kilosort.run_kilosort INFO     GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:42,620 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 20:59:42,621 kilosort.run_kilosort INFO     Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:42,621 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 20:59:42,622 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   8924 KiB | 311376 KiB |   6029 GiB |   6029 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   8924 KiB | 311376 KiB |   6029 GiB |   6029 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   8921 KiB | 310444 KiB |   5966 GiB |   5966 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 479232 KiB | 479232 KiB | 479232 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  13603 KiB | 184425 KiB |   3536 GiB |   3536 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      24    |      56    |    1524 K  |    1524 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      24    |      56    |    1524 K  |    1524 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      27    |  661790    |  661780    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-08 20:59:42,622 kilosort.run_kilosort INFO      
2025-05-08 20:59:42,623 kilosort.run_kilosort INFO     Final clustering
2025-05-08 20:59:42,623 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 20:59:42,633 kilosort.clustering_qr DEBUG     
2025-05-08 20:59:42,633 kilosort.clustering_qr DEBUG    Cluster center: 0 of 12
2025-05-08 20:59:42,633 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 20:59:42,633 kilosort.clustering_qr DEBUG    CPU usage:    21.80 %
2025-05-08 20:59:42,633 kilosort.clustering_qr DEBUG    Memory:       21.83 %     |    164.72   /   754.60 GB
2025-05-08 20:59:42,633 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-08 20:59:42,633 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:42,634 kilosort.clustering_qr DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:42,634 kilosort.clustering_qr DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 20:59:42,634 kilosort.clustering_qr DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:42,634 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 20:59:42,638 kilosort.clustering_qr DEBUG    Center 0 | nsp: 11064 | ntemp: 9
2025-05-08 20:59:43,048 kilosort.clustering_qr DEBUG    Center 1 | nsp: 10320 | ntemp: 7
2025-05-08 20:59:43,352 kilosort.clustering_qr DEBUG    Center 2 | nsp: 17538 | ntemp: 13
2025-05-08 20:59:43,855 kilosort.clustering_qr DEBUG    Center 3 | nsp: 9176 | ntemp: 7
2025-05-08 20:59:44,282 kilosort.clustering_qr DEBUG    Center 4 | nsp: 4667 | ntemp: 3
2025-05-08 20:59:44,550 kilosort.clustering_qr DEBUG    Center 5 | nsp: 6202 | ntemp: 6
2025-05-08 20:59:44,834 kilosort.clustering_qr DEBUG    Center 6 | nsp: 7967 | ntemp: 5
2025-05-08 20:59:45,266 kilosort.clustering_qr DEBUG    Center 7 | nsp: 6560 | ntemp: 5
2025-05-08 20:59:45,657 kilosort.clustering_qr DEBUG    Center 8 | nsp: 9284 | ntemp: 5
2025-05-08 20:59:46,087 kilosort.clustering_qr DEBUG    Center 9 | nsp: 10382 | ntemp: 4
2025-05-08 20:59:46,503 kilosort.clustering_qr DEBUG     
2025-05-08 20:59:46,503 kilosort.clustering_qr DEBUG    Cluster center: 10 of 12
2025-05-08 20:59:46,503 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 20:59:46,503 kilosort.clustering_qr DEBUG    CPU usage:    23.60 %
2025-05-08 20:59:46,503 kilosort.clustering_qr DEBUG    Memory:       14.76 %     |    111.38   /   754.60 GB
2025-05-08 20:59:46,503 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-08 20:59:46,503 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:46,504 kilosort.clustering_qr DEBUG    GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:46,504 kilosort.clustering_qr DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 20:59:46,504 kilosort.clustering_qr DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:46,504 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 20:59:46,505 kilosort.clustering_qr DEBUG    Center 10 | nsp: 1617 | ntemp: 1
2025-05-08 20:59:46,750 kilosort.clustering_qr DEBUG    Center 11 | nsp: 14878 | ntemp: 5
2025-05-08 20:59:47,240 kilosort.run_kilosort INFO     77 clusters found, in  4.62s; total  20.60s
2025-05-08 20:59:47,240 kilosort.run_kilosort DEBUG    clu shape: (109655,)
2025-05-08 20:59:47,241 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([77, 32, 6])
2025-05-08 20:59:47,241 kilosort.run_kilosort INFO      
2025-05-08 20:59:47,241 kilosort.run_kilosort INFO     Merging clusters
2025-05-08 20:59:47,241 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 20:59:47,369 kilosort.run_kilosort INFO     76 units found, in  0.13s; total  20.73s
2025-05-08 20:59:47,369 kilosort.run_kilosort DEBUG    clu shape: (109655,)
2025-05-08 20:59:47,369 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([76, 32, 6])
2025-05-08 20:59:47,369 kilosort.run_kilosort INFO      
2025-05-08 20:59:47,370 kilosort.run_kilosort INFO     Resource usage after clustering
2025-05-08 20:59:47,370 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 20:59:47,371 kilosort.run_kilosort INFO     CPU usage:    19.20 %
2025-05-08 20:59:47,371 kilosort.run_kilosort INFO     Memory:       14.17 %     |    106.95   /   754.60 GB
2025-05-08 20:59:47,371 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 20:59:47,372 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:47,372 kilosort.run_kilosort INFO     GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:47,373 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 20:59:47,373 kilosort.run_kilosort INFO     Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:47,374 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 20:59:47,374 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   8872 KiB | 311376 KiB |   6165 GiB |   6165 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   8872 KiB | 311376 KiB |   6165 GiB |   6165 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   8868 KiB | 310444 KiB |   6100 GiB |   6100 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 479232 KiB | 479232 KiB | 479232 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  13656 KiB | 184425 KiB |   3727 GiB |   3727 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      23    |      56    |    1676 K  |    1676 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      23    |      56    |    1676 K  |    1676 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      27    |  738048    |  738038    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-08 20:59:47,374 kilosort.run_kilosort INFO      
2025-05-08 20:59:47,375 kilosort.run_kilosort INFO     Saving to phy and computing refractory periods
2025-05-08 20:59:47,375 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 20:59:48,111 kilosort.run_kilosort INFO     29 units found with good refractory periods
2025-05-08 20:59:48,112 kilosort.run_kilosort INFO     Total runtime: 21.47s = 00:00:21 h:m:s
2025-05-08 20:59:48,133 kilosort.run_kilosort INFO     Sorting output saved in: /home/lss72/palmer_scratch/spike_sort/kilosort4.
2025-05-08 20:59:48,134 kilosort.run_kilosort INFO      
2025-05-08 20:59:48,134 kilosort.run_kilosort INFO     Resource usage after saving
2025-05-08 20:59:48,134 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 20:59:48,135 kilosort.run_kilosort INFO     CPU usage:    21.40 %
2025-05-08 20:59:48,135 kilosort.run_kilosort INFO     Memory:       14.29 %     |    107.81   /   754.60 GB
2025-05-08 20:59:48,136 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 20:59:48,136 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 20:59:48,136 kilosort.run_kilosort INFO     GPU memory:    2.56 %     |      1.01   /    39.50 GB
2025-05-08 20:59:48,137 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 20:59:48,137 kilosort.run_kilosort INFO     Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 20:59:48,138 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 20:59:48,138 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   8872 KiB | 311376 KiB |   6165 GiB |   6165 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   8872 KiB | 311376 KiB |   6165 GiB |   6165 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   8868 KiB | 310444 KiB |   6100 GiB |   6100 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 479232 KiB | 479232 KiB | 479232 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  13656 KiB | 184425 KiB |   3727 GiB |   3727 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      23    |      56    |    1677 K  |    1677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      23    |      56    |    1677 K  |    1677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      27    |  738675    |  738665    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


