2025-05-08 19:05:27,341 kilosort.run_kilosort INFO     Kilosort version 4.0.25
2025-05-08 19:05:27,342 kilosort.run_kilosort INFO     Python version 3.9.21
2025-05-08 19:05:27,342 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:05:27,343 kilosort.run_kilosort INFO     System information:
2025-05-08 19:05:27,343 kilosort.run_kilosort INFO     Linux-4.18.0-477.74.1.el8_8.x86_64-x86_64-with-glibc2.28 x86_64
2025-05-08 19:05:27,343 kilosort.run_kilosort INFO     x86_64
2025-05-08 19:05:27,488 kilosort.run_kilosort INFO     Using GPU for PyTorch computations. Specify `device` to change this.
2025-05-08 19:05:27,544 kilosort.run_kilosort INFO     Using CUDA device: NVIDIA A100-PCIE-40GB 39.50GB
2025-05-08 19:05:27,545 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:05:27,545 kilosort.run_kilosort INFO     Sorting /home/lss72/palmer_scratch/spike_sort/2014_11_13_Pair_3_0
2025-05-08 19:05:27,546 kilosort.run_kilosort DEBUG    Initial ops:

ops = {
    'n_chan_bin': 32,
    'fs': 30000,
    'batch_size': 60000,
    'nblocks': 1,
    'Th_universal': 9,
    'Th_learned': 8,
    'tmin': 0,
    'tmax': 5,
    'nt': 61,
    'shift': None,
    'scale': None,
    'artifact_threshold': inf,
    'nskip': 25,
    'whitening_range': 32,
    'highpass_cutoff': 300,
    'binning_depth': 5,
    'sig_interp': 20,
    'drift_smoothing': [0.5, 0.5, 0.5],
    'nt0min': 20,
    'dmin': None,
    'dminx': 32,
    'min_template_size': 10,
    'template_sizes': 5,
    'nearest_chans': 10,
    'nearest_templates': 100,
    'max_channel_distance': 32,
    'max_peels': 100,
    'templates_from_data': True,
    'n_templates': 6,
    'n_pcs': 6,
    'Th_single_ch': 6,
    'acg_threshold': 0.2,
    'ccg_threshold': 0.25,
    'cluster_downsampling': 20,
    'x_centers': None,
    'duplicate_spike_ms': 0.25,
    'position_limit': 100,
    'data_dir': PosixPath('/home/lss72/palmer_scratch/spike_sort'),
    'filename': PosixPath('/home/lss72/palmer_scratch/spike_sort/2014_11_13_Pair_3_0'),
    'data_dtype': dtype('uint16'),
    'do_CAR': True,
    'invert_sign': False,
    'NTbuff': 60122,
    'Nchan': 32,
    'duplicate_spike_bins': 7,
    'torch_device': 'cuda',
    'save_preprocessed_copy': False
}

2025-05-08 19:05:27,548 kilosort.run_kilosort DEBUG    Probe dictionary:

probe = {
    'chanMap': np.array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]),
    'xc': np.array([25.5, 25.5, 43.5, 43.5, 43.5, 43.5, 43.5, 43.5, 25.5, 25.5, 43.5,
       43.5, 43.5, 43.5, 25.5, 25.5, 25.5, 25.5,  7.5,  7.5,  7.5,  7.5,
       25.5, 25.5,  7.5,  7.5,  7.5,  7.5,  7.5,  7.5, 25.5, 25.5],
      dtype=np.float32),
    'yc': np.array([282.5, 232.5,  20. ,  45. ,  95. , 145. , 195. , 245. ,  82.5,
        32.5, 220. , 170. , 120. ,  70. , 132.5, 182.5, 157.5, 107.5,
        70. , 120. , 170. , 220. ,   7.5,  57.5, 245. , 195. , 145. ,
        95. ,  45. ,  20. , 207.5, 257.5], dtype=np.float32),
    'kcoords': np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]),
    'n_chan': 32
}

2025-05-08 19:05:27,548 kilosort.run_kilosort INFO      
2025-05-08 19:05:27,548 kilosort.run_kilosort INFO     Computing preprocessing variables.
2025-05-08 19:05:27,548 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:05:27,829 kilosort.run_kilosort INFO     N samples: 150000
2025-05-08 19:05:27,830 kilosort.run_kilosort INFO     N seconds: 5.0
2025-05-08 19:05:27,830 kilosort.run_kilosort INFO     N batches: 3
2025-05-08 19:05:28,721 kilosort.run_kilosort INFO     Preprocessing filters computed in  1.17s; total  1.18s
2025-05-08 19:05:28,723 kilosort.run_kilosort DEBUG    hp_filter shape: torch.Size([30122])
2025-05-08 19:05:28,723 kilosort.run_kilosort DEBUG    whiten_mat shape: torch.Size([32, 32])
2025-05-08 19:05:28,723 kilosort.run_kilosort INFO      
2025-05-08 19:05:28,723 kilosort.run_kilosort INFO     Resource usage after preprocessing
2025-05-08 19:05:28,724 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:05:28,724 kilosort.run_kilosort INFO     CPU usage:    10.30 %
2025-05-08 19:05:28,725 kilosort.run_kilosort INFO     Memory:       10.98 %     |     82.86   /   754.60 GB
2025-05-08 19:05:28,725 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 19:05:28,725 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:28,726 kilosort.run_kilosort INFO     GPU memory:    1.74 %     |      0.69   /    39.50 GB
2025-05-08 19:05:28,727 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:05:28,727 kilosort.run_kilosort INFO     Max alloc:     0.26 %     |      0.10   /    39.50 GB
2025-05-08 19:05:28,727 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:05:28,759 kilosort.run_kilosort INFO      
2025-05-08 19:05:28,759 kilosort.run_kilosort INFO     Computing drift correction.
2025-05-08 19:05:28,760 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:05:28,760 kilosort.spikedetect INFO     Re-computing universal templates from data.
2025-05-08 19:05:29,459 kilosort.spikedetect INFO     Number of universal templates: 135
2025-05-08 19:05:29,481 kilosort.spikedetect INFO     Detecting spikes...
2025-05-08 19:05:29,483 kilosort.spikedetect DEBUG     
2025-05-08 19:05:29,483 kilosort.spikedetect DEBUG    Batch 0
2025-05-08 19:05:29,483 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:05:29,483 kilosort.spikedetect DEBUG    CPU usage:    12.30 %
2025-05-08 19:05:29,484 kilosort.spikedetect DEBUG    Memory:       10.76 %     |     81.22   /   754.60 GB
2025-05-08 19:05:29,484 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-08 19:05:29,484 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:29,484 kilosort.spikedetect DEBUG    GPU memory:    1.74 %     |      0.69   /    39.50 GB
2025-05-08 19:05:29,484 kilosort.spikedetect DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:05:29,484 kilosort.spikedetect DEBUG    Max alloc:     0.28 %     |      0.11   /    39.50 GB
2025-05-08 19:05:29,484 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:05:30,135 kilosort.spikedetect DEBUG     
2025-05-08 19:05:30,135 kilosort.spikedetect DEBUG    Batch 2
2025-05-08 19:05:30,135 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:05:30,135 kilosort.spikedetect DEBUG    CPU usage:     9.20 %
2025-05-08 19:05:30,135 kilosort.spikedetect DEBUG    Memory:       11.00 %     |     83.02   /   754.60 GB
2025-05-08 19:05:30,135 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-08 19:05:30,135 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:30,135 kilosort.spikedetect DEBUG    GPU memory:    2.55 %     |      1.01   /    39.50 GB
2025-05-08 19:05:30,136 kilosort.spikedetect DEBUG    Allocated:     0.04 %     |      0.02   /    39.50 GB
2025-05-08 19:05:30,136 kilosort.spikedetect DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:05:30,136 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:05:30,332 kilosort.run_kilosort INFO     drift computed in  1.57s; total  2.79s
2025-05-08 19:05:30,333 kilosort.run_kilosort DEBUG    st shape: (1033, 6)
2025-05-08 19:05:30,333 kilosort.run_kilosort DEBUG    yblk shape: (1,)
2025-05-08 19:05:30,333 kilosort.run_kilosort DEBUG    dshift shape: (3, 1)
2025-05-08 19:05:30,333 kilosort.run_kilosort DEBUG    iKxx shape: torch.Size([32, 32])
2025-05-08 19:05:30,333 kilosort.run_kilosort INFO      
2025-05-08 19:05:30,333 kilosort.run_kilosort INFO     Resource usage after drift correction
2025-05-08 19:05:30,334 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:05:30,334 kilosort.run_kilosort INFO     CPU usage:     9.90 %
2025-05-08 19:05:30,335 kilosort.run_kilosort INFO     Memory:       10.58 %     |     79.84   /   754.60 GB
2025-05-08 19:05:30,335 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 19:05:30,335 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:30,336 kilosort.run_kilosort INFO     GPU memory:    2.55 %     |      1.01   /    39.50 GB
2025-05-08 19:05:30,336 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:05:30,337 kilosort.run_kilosort INFO     Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:05:30,337 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:05:30,338 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   8592 KiB | 309969 KiB |  24018 MiB |  24009 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   8592 KiB | 309969 KiB |  24018 MiB |  24009 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   8590 KiB | 309884 KiB |  23772 MiB |  23764 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 477184 KiB | 477184 KiB | 477184 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  13936 KiB | 184425 KiB |  12726 MiB |  12713 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       9    |      37    |    6279    |    6270    |
|---------------------------------------------------------------------------|
| Active allocs         |       9    |      37    |    6279    |    6270    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      13    |      13    |      13    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      20    |    1766    |    1760    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-08 19:05:30,350 kilosort.run_kilosort DEBUG    First batch min, max: (-20.231596, 13.883576)
2025-05-08 19:05:30,350 kilosort.run_kilosort INFO      
2025-05-08 19:05:30,350 kilosort.run_kilosort INFO     Extracting spikes using templates
2025-05-08 19:05:30,350 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:05:30,351 kilosort.spikedetect INFO     Re-computing universal templates from data.
2025-05-08 19:05:30,394 kilosort.spikedetect INFO     Number of universal templates: 135
2025-05-08 19:05:30,397 kilosort.spikedetect INFO     Detecting spikes...
2025-05-08 19:05:30,399 kilosort.spikedetect DEBUG     
2025-05-08 19:05:30,399 kilosort.spikedetect DEBUG    Batch 0
2025-05-08 19:05:30,399 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:05:30,399 kilosort.spikedetect DEBUG    CPU usage:    19.20 %
2025-05-08 19:05:30,399 kilosort.spikedetect DEBUG    Memory:       10.60 %     |     80.02   /   754.60 GB
2025-05-08 19:05:30,399 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-08 19:05:30,399 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:30,400 kilosort.spikedetect DEBUG    GPU memory:    2.55 %     |      1.01   /    39.50 GB
2025-05-08 19:05:30,400 kilosort.spikedetect DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:05:30,400 kilosort.spikedetect DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:05:30,400 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:05:30,524 kilosort.spikedetect DEBUG     
2025-05-08 19:05:30,524 kilosort.spikedetect DEBUG    Batch 2
2025-05-08 19:05:30,524 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:05:30,525 kilosort.spikedetect DEBUG    CPU usage:    10.40 %
2025-05-08 19:05:30,525 kilosort.spikedetect DEBUG    Memory:       10.65 %     |     80.37   /   754.60 GB
2025-05-08 19:05:30,525 kilosort.spikedetect DEBUG    ------------------------------------------------------
2025-05-08 19:05:30,525 kilosort.spikedetect DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:30,525 kilosort.spikedetect DEBUG    GPU memory:    2.55 %     |      1.01   /    39.50 GB
2025-05-08 19:05:30,525 kilosort.spikedetect DEBUG    Allocated:     0.04 %     |      0.02   /    39.50 GB
2025-05-08 19:05:30,525 kilosort.spikedetect DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:05:30,525 kilosort.spikedetect DEBUG    ********************************************************
2025-05-08 19:05:30,525 kilosort.run_kilosort INFO     1005 spikes extracted in  0.18s; total  2.98s
2025-05-08 19:05:30,526 kilosort.run_kilosort DEBUG    st0 shape: (1005, 6)
2025-05-08 19:05:30,526 kilosort.run_kilosort DEBUG    tF shape: torch.Size([1005, 10, 6])
2025-05-08 19:05:30,526 kilosort.run_kilosort INFO      
2025-05-08 19:05:30,526 kilosort.run_kilosort INFO     First clustering
2025-05-08 19:05:30,526 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:05:30,541 kilosort.clustering_qr DEBUG     
2025-05-08 19:05:30,541 kilosort.clustering_qr DEBUG    Cluster center: 0 of 12
2025-05-08 19:05:30,541 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:05:30,541 kilosort.clustering_qr DEBUG    CPU usage:    11.70 %
2025-05-08 19:05:30,541 kilosort.clustering_qr DEBUG    Memory:       10.66 %     |     80.41   /   754.60 GB
2025-05-08 19:05:30,541 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-08 19:05:30,541 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:30,541 kilosort.clustering_qr DEBUG    GPU memory:    2.55 %     |      1.01   /    39.50 GB
2025-05-08 19:05:30,542 kilosort.clustering_qr DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:05:30,542 kilosort.clustering_qr DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:05:30,542 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:05:30,580 kilosort.clustering_qr DEBUG    Center 0 | nsp: 126 | ntemp: 12
2025-05-08 19:05:30,582 kilosort.clustering_qr DEBUG    Center 1 | nsp: 128 | ntemp: 12
2025-05-08 19:05:30,584 kilosort.clustering_qr DEBUG    Center 2 | nsp: 82 | ntemp: 12
2025-05-08 19:05:30,586 kilosort.clustering_qr DEBUG    Center 3 | nsp: 140 | ntemp: 12
2025-05-08 19:05:30,588 kilosort.clustering_qr DEBUG    Center 4 | nsp: 36 | ntemp: 12
2025-05-08 19:05:30,590 kilosort.clustering_qr DEBUG    Center 5 | nsp: 61 | ntemp: 12
2025-05-08 19:05:30,592 kilosort.clustering_qr DEBUG    Center 6 | nsp: 27 | ntemp: 12
2025-05-08 19:05:30,594 kilosort.clustering_qr DEBUG    Center 7 | nsp: 109 | ntemp: 12
2025-05-08 19:05:30,596 kilosort.clustering_qr DEBUG    Center 8 | nsp: 84 | ntemp: 12
2025-05-08 19:05:30,598 kilosort.clustering_qr DEBUG    Center 9 | nsp: 78 | ntemp: 12
2025-05-08 19:05:30,598 kilosort.clustering_qr DEBUG     
2025-05-08 19:05:30,598 kilosort.clustering_qr DEBUG    Cluster center: 10 of 12
2025-05-08 19:05:30,598 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:05:30,599 kilosort.clustering_qr DEBUG    CPU usage:    20.00 %
2025-05-08 19:05:30,599 kilosort.clustering_qr DEBUG    Memory:       10.68 %     |     80.58   /   754.60 GB
2025-05-08 19:05:30,599 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-08 19:05:30,599 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:30,599 kilosort.clustering_qr DEBUG    GPU memory:    2.55 %     |      1.01   /    39.50 GB
2025-05-08 19:05:30,599 kilosort.clustering_qr DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:05:30,599 kilosort.clustering_qr DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:05:30,599 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:05:30,601 kilosort.clustering_qr DEBUG    Center 10 | nsp: 86 | ntemp: 12
2025-05-08 19:05:30,602 kilosort.clustering_qr DEBUG    Center 11 | nsp: 48 | ntemp: 3
2025-05-08 19:05:30,669 kilosort.run_kilosort INFO     12 clusters found, in  0.14s; total  3.12s
2025-05-08 19:05:30,670 kilosort.run_kilosort DEBUG    clu shape: (1005,)
2025-05-08 19:05:30,670 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([12, 32, 6])
2025-05-08 19:05:30,670 kilosort.run_kilosort INFO      
2025-05-08 19:05:30,670 kilosort.run_kilosort INFO     Extracting spikes using cluster waveforms
2025-05-08 19:05:30,671 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:05:30,680 kilosort.template_matching DEBUG     
2025-05-08 19:05:30,680 kilosort.template_matching DEBUG    Batch 0
2025-05-08 19:05:30,680 kilosort.template_matching DEBUG    ********************************************************
2025-05-08 19:05:30,680 kilosort.template_matching DEBUG    CPU usage:    14.30 %
2025-05-08 19:05:30,680 kilosort.template_matching DEBUG    Memory:       10.74 %     |     81.04   /   754.60 GB
2025-05-08 19:05:30,680 kilosort.template_matching DEBUG    ------------------------------------------------------
2025-05-08 19:05:30,680 kilosort.template_matching DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:30,681 kilosort.template_matching DEBUG    GPU memory:    2.55 %     |      1.01   /    39.50 GB
2025-05-08 19:05:30,681 kilosort.template_matching DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:05:30,681 kilosort.template_matching DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:05:30,681 kilosort.template_matching DEBUG    ********************************************************
2025-05-08 19:05:30,746 kilosort.template_matching DEBUG     
2025-05-08 19:05:30,746 kilosort.template_matching DEBUG    Batch 2
2025-05-08 19:05:30,746 kilosort.template_matching DEBUG    ********************************************************
2025-05-08 19:05:30,746 kilosort.template_matching DEBUG    CPU usage:    11.00 %
2025-05-08 19:05:30,746 kilosort.template_matching DEBUG    Memory:       10.76 %     |     81.22   /   754.60 GB
2025-05-08 19:05:30,746 kilosort.template_matching DEBUG    ------------------------------------------------------
2025-05-08 19:05:30,746 kilosort.template_matching DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:30,746 kilosort.template_matching DEBUG    GPU memory:    2.55 %     |      1.01   /    39.50 GB
2025-05-08 19:05:30,747 kilosort.template_matching DEBUG    Allocated:     0.06 %     |      0.02   /    39.50 GB
2025-05-08 19:05:30,747 kilosort.template_matching DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:05:30,747 kilosort.template_matching DEBUG    ********************************************************
2025-05-08 19:05:30,748 kilosort.run_kilosort INFO     1253 spikes extracted in  0.08s; total  3.20s
2025-05-08 19:05:30,752 kilosort.run_kilosort DEBUG    st shape: (1253, 3)
2025-05-08 19:05:30,752 kilosort.run_kilosort DEBUG    tF shape: torch.Size([1253, 10, 6])
2025-05-08 19:05:30,752 kilosort.run_kilosort DEBUG    iCC shape: torch.Size([10, 32])
2025-05-08 19:05:30,752 kilosort.run_kilosort DEBUG    iU shape: torch.Size([12])
2025-05-08 19:05:30,752 kilosort.run_kilosort INFO      
2025-05-08 19:05:30,752 kilosort.run_kilosort INFO     Resource usage after spike detection
2025-05-08 19:05:30,752 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:05:30,753 kilosort.run_kilosort INFO     CPU usage:    20.80 %
2025-05-08 19:05:30,754 kilosort.run_kilosort INFO     Memory:       10.74 %     |     81.02   /   754.60 GB
2025-05-08 19:05:30,754 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 19:05:30,754 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:30,755 kilosort.run_kilosort INFO     GPU memory:    2.55 %     |      1.01   /    39.50 GB
2025-05-08 19:05:30,755 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:05:30,756 kilosort.run_kilosort INFO     Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:05:30,756 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:05:30,756 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   8604 KiB | 310260 KiB |  49399 MiB |  49391 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   8604 KiB | 310260 KiB |  49399 MiB |  49391 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   8602 KiB | 309993 KiB |  48870 MiB |  48861 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 477184 KiB | 477184 KiB | 477184 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  13923 KiB | 184425 KiB |  25556 MiB |  25542 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      13    |      45    |   10933    |   10920    |
|---------------------------------------------------------------------------|
| Active allocs         |      13    |      45    |   10933    |   10920    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      13    |      13    |      13    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      21    |    3418    |    3411    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-08 19:05:30,757 kilosort.run_kilosort INFO      
2025-05-08 19:05:30,757 kilosort.run_kilosort INFO     Final clustering
2025-05-08 19:05:30,757 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:05:30,766 kilosort.clustering_qr DEBUG     
2025-05-08 19:05:30,766 kilosort.clustering_qr DEBUG    Cluster center: 0 of 12
2025-05-08 19:05:30,766 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:05:30,766 kilosort.clustering_qr DEBUG    CPU usage:    17.00 %
2025-05-08 19:05:30,766 kilosort.clustering_qr DEBUG    Memory:       10.74 %     |     81.05   /   754.60 GB
2025-05-08 19:05:30,766 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-08 19:05:30,766 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:30,766 kilosort.clustering_qr DEBUG    GPU memory:    2.55 %     |      1.01   /    39.50 GB
2025-05-08 19:05:30,766 kilosort.clustering_qr DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:05:30,767 kilosort.clustering_qr DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:05:30,767 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:05:30,772 kilosort.clustering_qr DEBUG    Center 0 | nsp: 184 | ntemp: 1
2025-05-08 19:05:30,773 kilosort.clustering_qr DEBUG    Center 1 | nsp: 154 | ntemp: 1
2025-05-08 19:05:30,774 kilosort.clustering_qr DEBUG    Center 2 | nsp: 129 | ntemp: 1
2025-05-08 19:05:30,774 kilosort.clustering_qr DEBUG    Center 3 | nsp: 129 | ntemp: 1
2025-05-08 19:05:30,775 kilosort.clustering_qr DEBUG    Center 4 | nsp: 65 | ntemp: 1
2025-05-08 19:05:30,776 kilosort.clustering_qr DEBUG    Center 5 | nsp: 81 | ntemp: 1
2025-05-08 19:05:30,777 kilosort.clustering_qr DEBUG    Center 6 | nsp: 35 | ntemp: 1
2025-05-08 19:05:30,777 kilosort.clustering_qr DEBUG    Center 7 | nsp: 0 | ntemp: 0
2025-05-08 19:05:30,778 kilosort.clustering_qr DEBUG    Center 8 | nsp: 203 | ntemp: 2
2025-05-08 19:05:30,779 kilosort.clustering_qr DEBUG    Center 9 | nsp: 124 | ntemp: 1
2025-05-08 19:05:30,779 kilosort.clustering_qr DEBUG     
2025-05-08 19:05:30,779 kilosort.clustering_qr DEBUG    Cluster center: 10 of 12
2025-05-08 19:05:30,779 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:05:30,780 kilosort.clustering_qr DEBUG    CPU usage:    32.70 %
2025-05-08 19:05:30,780 kilosort.clustering_qr DEBUG    Memory:       10.75 %     |     81.09   /   754.60 GB
2025-05-08 19:05:30,780 kilosort.clustering_qr DEBUG    ------------------------------------------------------
2025-05-08 19:05:30,780 kilosort.clustering_qr DEBUG    GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:30,780 kilosort.clustering_qr DEBUG    GPU memory:    2.55 %     |      1.01   /    39.50 GB
2025-05-08 19:05:30,780 kilosort.clustering_qr DEBUG    Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:05:30,781 kilosort.clustering_qr DEBUG    Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:05:30,781 kilosort.clustering_qr DEBUG    ********************************************************
2025-05-08 19:05:30,781 kilosort.clustering_qr DEBUG    Center 10 | nsp: 38 | ntemp: 1
2025-05-08 19:05:30,782 kilosort.clustering_qr DEBUG    Center 11 | nsp: 111 | ntemp: 1
2025-05-08 19:05:30,784 kilosort.run_kilosort INFO     11 clusters found, in  0.03s; total  3.24s
2025-05-08 19:05:30,784 kilosort.run_kilosort DEBUG    clu shape: (1253,)
2025-05-08 19:05:30,784 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([11, 32, 6])
2025-05-08 19:05:30,784 kilosort.run_kilosort INFO      
2025-05-08 19:05:30,785 kilosort.run_kilosort INFO     Merging clusters
2025-05-08 19:05:30,785 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:05:33,245 kilosort.run_kilosort INFO     11 units found, in  2.46s; total  5.70s
2025-05-08 19:05:33,246 kilosort.run_kilosort DEBUG    clu shape: (1253,)
2025-05-08 19:05:33,246 kilosort.run_kilosort DEBUG    Wall shape: torch.Size([11, 32, 6])
2025-05-08 19:05:33,246 kilosort.run_kilosort INFO      
2025-05-08 19:05:33,246 kilosort.run_kilosort INFO     Resource usage after clustering
2025-05-08 19:05:33,247 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:05:33,248 kilosort.run_kilosort INFO     CPU usage:    13.40 %
2025-05-08 19:05:33,248 kilosort.run_kilosort INFO     Memory:       10.67 %     |     80.51   /   754.60 GB
2025-05-08 19:05:33,248 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 19:05:33,249 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:33,249 kilosort.run_kilosort INFO     GPU memory:    2.55 %     |      1.01   /    39.50 GB
2025-05-08 19:05:33,250 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:05:33,250 kilosort.run_kilosort INFO     Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:05:33,250 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:05:33,251 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   8595 KiB | 310260 KiB |  49400 MiB |  49391 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   8595 KiB | 310260 KiB |  49400 MiB |  49391 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   8593 KiB | 309993 KiB |  48870 MiB |  48861 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 477184 KiB | 477184 KiB | 477184 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  13932 KiB | 184425 KiB |  25556 MiB |  25542 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      12    |      45    |   11102    |   11090    |
|---------------------------------------------------------------------------|
| Active allocs         |      12    |      45    |   11102    |   11090    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      13    |      13    |      13    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      21    |    3502    |    3495    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


2025-05-08 19:05:33,251 kilosort.run_kilosort INFO      
2025-05-08 19:05:33,252 kilosort.run_kilosort INFO     Saving to phy and computing refractory periods
2025-05-08 19:05:33,252 kilosort.run_kilosort INFO     ----------------------------------------
2025-05-08 19:05:33,577 kilosort.run_kilosort INFO     1 units found with good refractory periods
2025-05-08 19:05:33,578 kilosort.run_kilosort INFO     Total runtime: 6.03s = 00:00:6 h:m:s
2025-05-08 19:05:33,592 kilosort.run_kilosort INFO     Sorting output saved in: /home/lss72/palmer_scratch/spike_sort/kilosort4.
2025-05-08 19:05:33,593 kilosort.run_kilosort INFO      
2025-05-08 19:05:33,593 kilosort.run_kilosort INFO     Resource usage after saving
2025-05-08 19:05:33,593 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:05:33,594 kilosort.run_kilosort INFO     CPU usage:    12.70 %
2025-05-08 19:05:33,594 kilosort.run_kilosort INFO     Memory:       10.79 %     |     81.44   /   754.60 GB
2025-05-08 19:05:33,595 kilosort.run_kilosort INFO     ------------------------------------------------------
2025-05-08 19:05:33,595 kilosort.run_kilosort INFO     GPU usage:    `conda install pynvml` for GPU usage
2025-05-08 19:05:33,595 kilosort.run_kilosort INFO     GPU memory:    2.55 %     |      1.01   /    39.50 GB
2025-05-08 19:05:33,596 kilosort.run_kilosort INFO     Allocated:     0.02 %     |      0.01   /    39.50 GB
2025-05-08 19:05:33,596 kilosort.run_kilosort INFO     Max alloc:     0.75 %     |      0.30   /    39.50 GB
2025-05-08 19:05:33,597 kilosort.run_kilosort INFO     ********************************************************
2025-05-08 19:05:33,598 kilosort.run_kilosort DEBUG    

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   8595 KiB | 310260 KiB |  49400 MiB |  49392 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   8595 KiB | 310260 KiB |  49400 MiB |  49392 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   8593 KiB | 309993 KiB |  48870 MiB |  48862 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 477184 KiB | 477184 KiB | 477184 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  13932 KiB | 184425 KiB |  25556 MiB |  25543 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      12    |      45    |   11274    |   11262    |
|---------------------------------------------------------------------------|
| Active allocs         |      12    |      45    |   11274    |   11262    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      13    |      13    |      13    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      21    |    3584    |    3577    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


